(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{"2H64":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("atOx"),a=n("DfQ9"),o=n("q1tI"),l=n("T1Xd"),i=n("FtsS"),d=n("VyIk"),u=n("nDxm"),c=n("P+jG"),s=n("fiWp"),f=n("T45d"),p=n("rreO"),m=n("hUol"),v=n("Texg"),g=n("UmuB"),h=n("Z+l2");n("ls82");var b=n("A0iE"),y=n("9R94"),E=n("RXNQ"),x=n("QRri"),C=n("yDJ3"),S=n("mYdW"),I=n("1iKp"),k=n("fSFK"),_=n("ylna"),A=n("vgxB"),T=n("AI/8"),w=n("kajd"),D=n("YdEV"),j=n("iSYi"),R=n("DxqV"),P=n("cqHN"),F=n("HbXt"),N=n("HhgX"),O=n("jlMd"),L=n("e45s"),M=n("frSy");n("P65A");var z=n("ktc5"),B=n("UiDi"),H=n("kOQt"),U=n("9M0U"),W=n("M4sF"),G=n("BvTd"),V=n("cjet"),q=n("iuhU"),Y=n("alx4"),J=n("St+u"),Q=n("nhr6"),X=n("s9fV"),K=n("RSps"),Z=n("IaVD"),$=n("CTdY"),ee=n("SMbg"),te=n("DHJd"),ne=n("Ei1D"),re=n("WrWS"),ae=n("fSKF"),oe=n("IMHz"),le=n("Ng2W"),ie=n("EbvH"),de=n("CRf/"),ue=n("9mbF"),ce=n("uJQG"),se=n("CXIY"),fe=n("44IB"),pe=n("SsPs"),me=n("Sd3K"),ve=n("3QMS"),ge=n("2Nlx"),he=n("FFA3"),be=n("8Koj"),ye=n("ppdS"),Ee=n("+Wak"),xe=n("E39E"),Ce=n("kpSO"),Se=n("pH/O"),Ie=n("rXAq"),ke=n("wQcc"),_e=n("tA9I"),Ae=n("SlCr"),Te=n("WElE"),we=n("jOUs"),De=n("anHE"),je=n("wG+f"),Re=n("gtMi"),Pe=n("Mewm"),Fe=n("NaKU"),Ne=n("PTt+"),Oe=n("ZPUd"),Le=n("1waj"),Me=n("rg6X"),ze=n("cnJa"),Be=n("TTf+"),He=n("DGHE"),Ue=n("hB7a"),We=n("5rCv"),Ge=n("pfKX"),Ve=n("qIiH"),qe=n("7FDG"),Ye=n("Uys+"),Je=n("ti9b"),Qe=n("ax+9"),Xe=n("22ne"),Ke=n("GMI5"),Ze=n("QXbl"),$e=n("K/mb"),et=n("w4+p"),tt=n("QAiN"),nt=n("wzGd"),rt=n("E2gh"),at=n("MPUk"),ot=n("tbux"),lt=n("qpA4"),it=n("3hiT"),dt=n("/2G1"),ut=n("8Gle"),ct=n("uniG"),st=n("B2Qq"),ft=n("y9Rt"),pt=n("2j8M"),mt=n("8zEF"),vt=n("XbjY"),gt=n("43qE"),ht=n("ekgS"),bt=n("KjAD"),yt=n("41DL"),Et=n("eNfT"),xt=n("GayG"),Ct=n("7frF"),St=n("uoyk"),It=n("7n/6"),kt=n("o6Jd"),_t=n("QQdn"),At=n("AGSh"),Tt=n("0sa1"),wt=n("+tGX"),Dt=n("jaE6"),jt=n("DihP"),Rt=n("XPiS"),Pt=n("HBGY"),Ft=n("sxP3"),Nt=n("E3hX"),Ot=n("SqIn"),Lt=n("x+dz"),Mt=n("B6OW"),zt=n("2bb+"),Bt=n("Y0qX"),Ht=n("UOzE");function Ut(e){return e&&e.__esModule?e:{default:e}}n("2qj+");var Wt=Ut(o),Gt=Ut(i),Vt=Ut(d),qt=Ut(u),Yt=Ut(f),Jt=Ut(m),Qt=Ut(v),Xt=Ut(y),Kt=Ut(E),Zt=Ut(x),$t=Ut(C),en=Ut(S),tn=Ut(I),nn=Ut(k),rn=Ut(_),an=Ut(A),on=Ut(T),ln=Ut(w),dn=Ut(D),un=Ut(j),cn=Ut(R),sn=Ut(P),fn=Ut(F),pn=Ut(N),mn=Ut(O),vn=Ut(L),gn=Ut(M),hn=Ut(B),bn=Ut(H),yn=Ut(U),En=Ut(W),xn=Ut(G),Cn=Ut(V),Sn=Ut(q),In=Ut(Y),kn=Ut(J),_n=Ut(Q),An=Ut(X),Tn=Ut(K),wn=Ut(Z),Dn=Ut($),jn=Ut(ee),Rn=Ut(te),Pn=Ut(ne),Fn=Ut(re),Nn=Ut(ae),On=Ut(oe),Ln=Ut(le),Mn=Ut(ie),zn=Ut(de),Bn=Ut(ue),Hn=Ut(ce),Un=Ut(se),Wn=Ut(fe),Gn=Ut(pe),Vn=Ut(me),qn=Ut(ve),Yn=Ut(ge),Jn=Ut(he),Qn=Ut(be),Xn=Ut(ye),Kn=Ut(Ee),Zn=Ut(xe),$n=Ut(Ce),er=Ut(Se),tr=Ut(Ie),nr=Ut(ke),rr=Ut(_e),ar=Ut(Ae),or=Ut(Te),lr=Ut(we),ir=Ut(De),dr=Ut(je),ur=Ut(Re),cr=Ut(Pe),sr=Ut(Fe),fr=Ut(Ne),pr=Ut(Oe),mr=Ut(Le),vr=Ut(Me),gr=Ut(ze),hr=Ut(Ue),br=Ut(We),yr=Ut(Ge),Er=Ut(Ve),xr=Ut(qe),Cr=Ut(Ye),Sr=Ut(Je),Ir=Ut(Qe),kr=Ut(Xe),_r=Ut(Ke),Ar=Ut(Ze),Tr=Ut($e),wr=Ut(et),Dr=Ut(tt),jr=Ut(nt),Rr=Ut(rt),Pr=Ut(at),Fr=Ut(ot),Nr=Ut(lt),Or=Ut(it),Lr=Ut(dt),Mr=Ut(ut),zr=Ut(ct),Br=Ut(st),Hr=Ut(pt),Ur=Ut(mt),Wr=Ut(vt),Gr=Ut(gt),Vr=Ut(ht),qr=Ut(bt),Yr=Ut(yt),Jr=Ut(Et),Qr=Ut(xt),Xr=Ut(Ct),Kr=Ut(St),Zr=Ut(It),$r=Ut(kt),ea=Ut(_t),ta=Ut(At),na=Ut(Tt),ra=Ut(wt),aa=Ut(Dt),oa=Ut(jt),la=Ut(Rt),ia=Ut(Pt),da=Ut(Ft),ua=Ut(Nt),ca=Ut(Ot),sa=Ut(Lt),fa=Ut(Mt),pa=Ut(zt),ma=Ut(Bt),va=Ut(Ht),ga=function(){var e={};return function(t,n,r){var a=n||500,o=r||"my-timeout";e[o]&&clearTimeout(e[o]),e[o]=setTimeout(t,a)}}(),ha=function(){},ba=Wt.default.createContext({tick:0,mode:"draft",setMode:ha,useDocument:ha,useSetDocument:ha,useDocumentStatus:ha,useLastCommit:ha,useChangeLog:ha,useHasUncommittedChanges:ha,usePush:ha,useResetDocument:ha,usePublishDocument:ha,useLiveEvents:ha,useDocumentJSONSize:ha}),ya=function(){return Wt.default.useContext(ba)},Ea=Wt.default.createContext(null),xa=function(){return Wt.default.useContext(Ea)};var Ca=function(e){var t=e.children,n=function(e){return function(t){e.current=t(e.current)}},a=o.useRef({}),l=o.useRef({}),i=o.useRef({}),d=o.useRef({}),u=o.useRef({}),s=o.useRef({}),f=o.useRef({}),p=o.useRef({}),m=o.useRef({}),v=o.useRef([]),g=o.useRef(null),h=n(a),b=n(l),y=n(i),E=n(d),x=n(u),C=n(s),S=n(f),I=n(p),k=n(m),_=n(v),A=xa(),T=Wt.default.useState(0),w=r._slicedToArray(T,2),D=w[0],j=w[1],R=Wt.default.useState("draft"),P=r._slicedToArray(R,2),F=P[0],N=P[1],O=Wt.default.useCallback((function(){return ga((function(){j((new Date).getTime())}),25,"setTick")}),[]),L=function(e){if("document-list"===e.docId)return"document-list";if(a.current[e.docId])return a.current[e.docId];var t=i.current[c.descriptorToId({docId:"document-list",branch:"main"})],n=Object.keys(t).find((function(n){var r;return(null===(r=t[n])||void 0===r?void 0:r.docId)===e.docId}));return h((function(t){return r._objectSpread2(r._objectSpread2({},t),{},r._defineProperty({},e.docId,n))})),n},M=function(e){var t=c.descriptorToId(e),n=A.open(e),a=n.change,o=n.push,l=n.publish,i=n.revert,d=n.getChanges;E((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,{change:a,publish:l,revert:i,push:o,getChanges:d}))})),O()},z=function(e){var t=c.descriptorToId(e),n=m.current[t];"undefined"!==typeof n&&(n(),k((function(e){var n=r._objectSpread2({},e);return delete n[t],n})));var a="draft"===e.branch?b:y,o=(0,A.open(e).subscribe)((function(n){var o=n.state,l=n.lastCommit,i=n.status;if(a((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,JSON.parse(JSON.stringify(o))))})),["document-list",g.current].includes(e.docId))O();else{C((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,l))})),x((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,i))})),O();var u=(d.current[t]||{}).getChanges;u&&ga((function(){return u(o.lastPublishedHeads).then((function(n){var a=n.hasChanges,o=n.changeLog;"draft"===e.branch?I((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,a))})):S((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,o))})),O()}))}),500,"getChanges-".concat(t))}}));k((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},t,o))}))},B=function(){A.restClient.getLiveEvents().then((function(e){_((function(){return e})),O()}))};o.useEffect((function(){return B(),A.on("live-event:change",B),function(){Object.values(m.current).forEach((function(e){return e()}))}}),[]);var H=function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o="remote"===t?"main":"draft",u=L({docId:e,branch:o}),s=U(),f={docId:e,branch:o,slug:u},p=c.descriptorToId(f),v="draft"===o?l:i;"undefined"===typeof v.current[p]&&"undefined"===typeof m.current[p]&&z(f),"undefined"===typeof d.current[p]&&M(f);var g=v.current[p]||{},h=(null===(n=d.current[p])||void 0===n?void 0:n.push)||ha,E=Wt.default.useCallback((function(e,t,n){var o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.docId,u=e.mode,f="remote"===u?"main":"draft",m={docId:i,branch:f},v=c.descriptorToId(m),g="draft"===f?b:y,h=(null===(o=d.current[v])||void 0===o?void 0:o.change)||ha;h((function(e){var t=a?e[a]:e;return n(t,s===i?null:l),g((function(t){return r._objectSpread2(r._objectSpread2({},t),{},r._defineProperty({},p,JSON.parse(JSON.stringify(e))))})),O(),t}),JSON.stringify(r._objectSpread2(r._objectSpread2({},t),{},{user:A.user})))}),[a]),x=a?g[a]:g;return[x,E,h]},U=function(){if(!g.current){var e=i.current[c.descriptorToId({docId:"document-list",branch:"main"})],t=Object.keys(e||{}).find((function(e){return"clipboard"===e})),n=t?e[t].docId:"";g.current=n}return g.current};return Wt.default.createElement(ba.Provider,{value:{tick:D,useDocument:H,useSetDocument:function(e,t){var n=H(e,t);return r._slicedToArray(n,2)[1]},useDocumentStatus:function(e,t){var n="remote"===t?"main":"draft",r={docId:e,branch:n,slug:L({docId:e,branch:n})},a=c.descriptorToId(r);return"undefined"===typeof u.current[a]&&"undefined"===typeof m.current[a]&&(M(r),z(r)),u.current[a]},useDocumentJSONSize:function(e,t){var n,r="remote"===t?"main":"draft",a={docId:e,branch:r,slug:L({docId:e,branch:r})},o=c.descriptorToId(a),l=(null===(n=A.front.docs.get(o))||void 0===n?void 0:n.state)||{};return c.getJSONSize(l)},useLastCommit:function(e,t){var n="remote"===t?"main":"draft",r={docId:e,branch:n,slug:L({docId:e,branch:n})},a=c.descriptorToId(r);return"undefined"===typeof s.current[a]&&"undefined"===typeof m.current[a]&&(M(r),z(r)),s.current[a]},useChangeLog:function(e){var t={docId:e,branch:"main",slug:L({docId:e,branch:"main"})},n=c.descriptorToId(t);return"undefined"===typeof f.current[n]&&"undefined"===typeof m.current[n]&&(M(t),z(t)),f.current[n]||[]},useHasUncommittedChanges:function(e){var t=c.descriptorToId({docId:e,branch:"draft"});return p.current[t]||!1},usePush:function(e){var t,n=c.descriptorToId({docId:e,branch:"draft"});return(null===(t=d.current[n])||void 0===t?void 0:t.push)||ha},useResetDocument:function(e){var t,n=c.descriptorToId({docId:e,branch:"draft"});return(null===(t=d.current[n])||void 0===t?void 0:t.revert)||ha},usePublishDocument:function(e){var t,n=c.descriptorToId({docId:e,branch:"main"});return(null===(t=d.current[n])||void 0===t?void 0:t.publish)||ha},useLiveEvents:function(){return v.current},setMode:N,mode:F}},t)};function Sa(){var e=(0,ya().useDocument)("document-list","remote"),t=r._slicedToArray(e,1)[0];return Object.keys(t).map((function(e){return{docId:t[e].docId,name:t[e].name,slug:t[e].slug}}))}var Ia=function(){var e=(0,ya().useDocument)("document-list","remote"),t=r._slicedToArray(e,1)[0],n=Object.keys(t).find((function(e){return"clipboard"===e}));return n?t[n].docId:""},ka=function(e){var t=e.children,n=e.repo;return Wt.default.createElement(Ea.Provider,{value:n},Wt.default.createElement(Ca,null,Wt.default.createElement(l.RecoilRoot,null,t)))},_a=function(e){p._inherits(n,e);var t=p._createSuper(n);function n(){var e;return p._classCallCheck(this,n),(e=t.call(this)).docs=new Map,e.state={},e.dateCreated=new Map,e.lastPushed=new Map,e}return p._createClass(n,[{key:"change",value:function(e,t,n){var r=this.getDoc(e),a=Yt.default.change(r,JSON.stringify(n),t);return this.setDoc(e,a),a}},{key:"getHeads",value:function(e){return Yt.default.Backend.getHeads(Yt.default.Frontend.getBackendState(this.getDoc(e)))}},{key:"removeDocument",value:function(e){this.docs.delete(e),this.state[e]={},this.emit("doc:change",e)}},{key:"getDoc",value:function(e){return this.docs.get(e)||Yt.default.init()}},{key:"getLastPushed",value:function(e){return this.lastPushed.get(e)}},{key:"setLastPushed",value:function(e,t){var n;(null===(n=this.lastPushed.get(e))||void 0===n?void 0:n.timestamp)!==t.timestamp&&(this.lastPushed.set(e,t),this.emit("doc:pushed",e))}},{key:"getDateCreated",value:function(e){return this.dateCreated.get(e)}},{key:"setDateCreated",value:function(e,t){return this.dateCreated.set(e,t)}},{key:"setState",value:function(e,t){this.state[e]=JSON.parse(JSON.stringify(t))}},{key:"getState",value:function(e){return this.state[e]?JSON.parse(JSON.stringify(this.state[e])):{}}},{key:"mergeWith",value:function(e,t){var n=this.getDoc(e),r=Yt.default.merge(n,t);return this.setDoc(e,r),r}},{key:"setDoc",value:function(e,t){this.docs.set(e,t),this.setState(e,t),this.emit("doc:change",e)}}]),n}(s.EventEmitter),Aa={root:{collection:"layouts",type:"homepage",props:{customFields:{siteServiceSection:""},collection:"layouts",type:"homepage",childProps:[{collection:"sections",id:0},{collection:"sections",id:1},{collection:"sections",id:2},{collection:"sections",id:3},{collection:"sections",id:4}]},children:[{id:"renderable-sections-0"},{id:"renderable-sections-1"},{id:"renderable-sections-2"},{id:"renderable-sections-3"},{id:"renderable-sections-4"}],id:"root"},"renderable-sections-0":{collection:"sections",props:{collection:"sections",id:0},children:[]},"renderable-sections-1":{collection:"sections",props:{collection:"sections",id:1},children:[]},"renderable-sections-2":{collection:"sections",props:{collection:"sections",id:2},children:[]},"renderable-sections-3":{collection:"sections",props:{collection:"sections",id:3},children:[]},"renderable-sections-4":{collection:"sections",props:{collection:"sections",id:4},children:[]}};Jt.default.options={positionClass:"toast-bottom-left",preventDuplicates:!0,timeOut:2500};var Ta=new(function(e){p._inherits(n,e);var t=p._createSuper(n);function n(){var e;return p._classCallCheck(this,n),(e=t.call(this,"DocDb")).version(2).stores({changes:"++id,docId,content",pushHistory:"&docId,timestamp"}).upgrade((function(){Qt.default.exists("docs")&&!Qt.default.exists("changes")&&Qt.default.delete("docs")})),e.changes=e.table("changes"),e.pushHistory=e.table("pushHistory"),e}return p._createClass(n,[{key:"removeDoc",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changes.where({docId:t}).delete();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDoc",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changes.where({docId:t}).toArray();case 2:if((n=e.sent).length){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",Yt.default.applyChanges(Yt.default.init(),n.map((function(e){return e.content}))));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setLastPush",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pushHistory.put({docId:t,timestamp:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getLastPush",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pushHistory.where({docId:t}).first();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n.timestamp);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Qt.default)),wa=function(e){p._inherits(n,e);var t=p._createSuper(n);function n(e,r,a){var o;return p._classCallCheck(this,n),(o=t.call(this)).mode=r,o.docId=e,o.parent=a,a.on(g.Events.DOC_CHANGE,(function(t,n){t===e&&n===o.mode&&o.emit(g.Events.DOC_CHANGE,o.getState())})),a.on(g.Events.DOC_PUSHED,(function(t,n){console.log("handler doc:pushed",n),t===e&&n===o.mode&&o.emit(g.Events.DOC_PUSHED,o.getLastPushed())})),o}return p._createClass(n,[{key:"setMode",value:function(e){this.mode=e,this.emit(g.Events.DOC_CHANGE)}},{key:"isDraftDirty",value:function(){return this.parent.isDraftDirty(this.docId)}},{key:"change",value:function(e,t){this.parent.change(this.docId,t,e)}},{key:"getHeads",value:function(){this.parent.getHeads(this.docId)[this.mode]}},{key:"publish",value:function(){return this.parent.publishRemote(this.docId)}},{key:"diff",value:function(){return this.parent.diff(this.docId,this.mode)}},{key:"reset",value:function(){return this.parent.reset(this.docId,this.mode)}},{key:"push",value:function(){return this.parent.pushLocalToRemote(this.docId)}},{key:"getState",value:function(){return this.parent.getState(this.docId)[this.mode]}},{key:"getLastPushed",value:function(){return this.parent.getLastPushed(this.docId,this.mode)}},{key:"close",value:function(){this.parent.close(this.docId)}}]),n}(s.EventEmitter),Da=function(e){p._inherits(n,e);var t=p._createSuper(n);function n(e){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown",l=arguments.length>2?arguments[2]:void 0;p._classCallCheck(this,n),a=t.call(this),r._defineProperty(p._assertThisInitialized(a),"add",function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,id:h.v4(),model:"document",initial_state:Aa},e.next=3,a.restClient.addDocument(n);case 3:return r=n.id,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r._defineProperty(p._assertThisInitialized(a),"refreshLocalData",function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ta.getLastPush(t);case 2:if((n=e.sent)&&a.drafts.setLastPushed(t,{user:a.user,timestamp:n}),a.heads.get(t)){e.next=7;break}return e.next=7,a.fetchPublishData(t);case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r._defineProperty(p._assertThisInitialized(a),"handleDocContentUpdates",function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.bench("handleDocContentUpdates",c._asyncToGenerator(regeneratorRuntime.mark((function e(){var o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ta.getDoc(t);case 2:o=e.sent,l=n===g.Callbacks.DOC?Yt.default.load(r):Yt.default.applyChanges(a.remotes.getDoc(t),r.map(Yt.default.encodeChange)),o&&Object.keys(o).length&&a.drafts.setDoc(t,o),a.remotes.getDoc(t)&&a.remotes.setDoc(t,l);case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),r._defineProperty(p._assertThisInitialized(a),"handleMetadataUpdates",function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.bench("HandleMeta",c._asyncToGenerator(regeneratorRuntime.mark((function e(){var o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!==g.Callbacks.PUBLISHED){e.next=7;break}return a.heads.set(t,r.heads),a.remotes.setLastPushed(t,r),r.user===a.user&&Jt.default.success("Homepage successfully published."),e.abrupt("return");case 7:if(n!==g.Callbacks.PUSHED){e.next=18;break}if(null===(o=r[r.length-1])||void 0===o||!o.hash||(null===o||void 0===o?void 0:o.hash)!==a.localCommitHash){e.next=18;break}return a.localCommitHash=void 0,Jt.default.success("Changes have been pushed to the homepage."),l=(new Date).getTime(),a.drafts.setLastPushed(t,{user:a.user,timestamp:l}),e.next=16,Ta.setLastPush(t,l);case 16:return e.next=18,Ta.removeDoc(t);case 18:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),"undefined"!==typeof window&&(window.toastr=Jt.default),a.user=o,a.restClient=new c.RestClient(e),a.subs=new Map,a.heads=new Map,a.networkClient=new c.NetworkClient(e,l),a.remotes=new _a,a.drafts=new _a,a.remotes.on(g.Events.DOC_CHANGE,function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.remotes.getHeads(t).sort(),r=a.drafts.getHeads(t).sort(),n.join("-")===r.join("-")){e.next=6;break}return e.next=5,a.mergeRemoteIntoDraft(t);case 5:a.emit(g.Events.DOC_CHANGE,t,"remote");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.drafts.on(g.Events.DOC_CHANGE,(function(e){a.emit(g.Events.DOC_CHANGE,e,"draft")}));var i=function(e){return function(t){"draft"===e&&console.log("draft pushed"),a.emit(g.Events.DOC_PUSHED,t,e)}};return a.remotes.on(g.Events.DOC_PUSHED,i("remote")),a.drafts.on(g.Events.DOC_PUSHED,i("draft")),a}return p._createClass(n,[{key:"mergeRemoteIntoDraft",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.bench("mergeRemoteIntoDraft",c._asyncToGenerator(regeneratorRuntime.mark((function e(){var r,a,o,l,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("clipboard"!==t){e.next=2;break}return e.abrupt("return");case 2:if(r=Yt.default.decodeChange(Yt.default.getAllChanges(n.remotes.getDoc(t))[0]).actor,a=Yt.default.getAllChanges(n.drafts.getDoc(t))[0],o=a?Yt.default.decodeChange(Yt.default.getAllChanges(n.drafts.getDoc(t))[0]).actor:r,r===o){e.next=11;break}return e.next=8,n.reset(t,"draft",!1);case 8:Jt.default.success("Homepage reset to last published version."),e.next=15;break;case 11:l=n.drafts.getDoc(t),n.merge(t,n.drafts,n.remotes.getDoc(t)),i=Yt.default.getChanges(l,n.drafts.getDoc(t)),Ta.changes.bulkAdd(i.map((function(e){return{docId:t,content:e}})));case 15:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"change",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bench("change",c._asyncToGenerator(regeneratorRuntime.mark((function e(){var o,l,i,d,u,c,s,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.mode,r.user=a.user,"draft"!==o){e.next=12;break}return l=a.drafts.getDoc(t),i=a.drafts.change(t,n,r),d=Yt.default.getChanges(l,i),e.next=9,Ta.changes.bulkAdd(d.map((function(e){return{content:e,docId:t}})));case 9:return e.abrupt("return",i);case 12:return u=a.remotes.getDoc(t),c=a.remotes.change(t,n,r),s=Yt.default.getChanges(u,c),f=s.map(Yt.default.decodeChange),a.networkClient.pushDocumentChanges(t,f),a.emit(g.Events.DOC_CHANGE,t),e.abrupt("return",c);case 19:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"merge",value:function(e,t,n){this.bench("docId: ".concat(e),(function(){t.mergeWith(e,n)}))}},{key:"loadDocument",value:function(e,t){return this.remotes.setDoc(e,t),this.drafts.setDoc(e,Yt.default.merge(Yt.default.init(),t)),this}},{key:"pushLocalToRemote",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.bench("publishLocalToRemote",c._asyncToGenerator(regeneratorRuntime.mark((function e(){var r,a,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Yt.default.getChanges(n.remotes.getDoc(t),n.drafts.getDoc(t)),o=Yt.default.applyChanges(n.remotes.getDoc(t),a),n.remotes.setDoc(t,o),l=a.map(Yt.default.decodeChange),n.networkClient.pushDocumentChanges(t,l),n.localCommitHash=null===(r=l[l.length-1])||void 0===r?void 0:r.hash;case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publishRemote",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"diff",value:function(e,t){var n=this;return this.bench("diff ".concat(e," ").concat(t),(function(){var a,o=n.heads.get(e);if("draft"===t||null===o||void 0===o||!o.length)return[];try{n.bench("getting changes during diff",(function(){a=Yt.default.Backend.getChanges(Yt.default.Frontend.getBackendState(n.remotes.getDoc(e)),o)}))}catch(l){return a=[],[]}return console.log("debug: changes from diff docId: ".concat(e),{mode:t,docId:e}),a.map(Yt.default.decodeChange).reduce((function(e,t){var n,a={type:"EDIT_ENTITY",mode:"draft",user:"Unknown"};if(null===a||void 0===a||!a.type)return e;var o=r._objectSpread2(r._objectSpread2({},a),{},{fieldsChanged:a.type===g.ActionTypes.EDIT_ENTITY?null===(n=t.ops[0])||void 0===n?void 0:n.key:"",timestamp:1e3*t.time});return e.push(o),e}),[])}))}},{key:"reset",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,o,l,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(i.length>2&&void 0!==i[2])||i[2],"draft"!==n){e.next=10;break}a=this.remotes.getDoc(t),o=Yt.default.merge(Yt.default.init(),a),Ta.removeDoc(t),this.drafts.setDoc(t,o),this.emit(g.Events.DOC_CHANGE,t),r&&Jt.default.success("Your draft changes have been canceled."),e.next=14;break;case 10:if(this.heads.get(t)&&null!==(l=this.diff(t,"remote"))&&void 0!==l&&l.length){e.next=12;break}return e.abrupt("return");case 12:this.heads.delete(t),this.networkClient.revertSharedDocument(t);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getState",value:function(e){return{draft:this.drafts.getState(e),remote:this.remotes.getState(e)}}},{key:"getHeads",value:function(e){return{draft:this.drafts.getHeads(e),remote:this.remotes.getHeads(e)}}},{key:"isDraftDirty",value:function(e){var t=this.getHeads(e),n=t.draft,r=t.remote,a=!1;if(0===r.length)return!1;if(n.length!==r.length)a=!0;else{var o=n.sort(),l=r.sort();o.forEach((function(e,t){e!==l[t]&&(a=!0)}))}return a}},{key:"getLastPushed",value:function(e,t){return("draft"===t?this.drafts:this.remotes).getLastPushed(e)}},{key:"close",value:function(e){var t,n,r;null===(t=this.subs.get(e))||void 0===t||t.sub.cancel(),null===(n=this.subs.get(e))||void 0===n||n.draftHandle.removeAllListeners(),null===(r=this.subs.get(e))||void 0===r||r.remoteHandle.removeAllListeners(),this.subs.delete(e),this.drafts.removeDocument(e),this.remotes.removeDocument(e)}},{key:"fetchPublishData",value:function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("clipboard"!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.restClient.getMetaData(t);case 4:(n=e.sent)&&(r=n.heads,a=n.user,o=n.timestamp,this.heads.set(t,r),this.remotes.setLastPushed(t,{user:a,timestamp:o}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bench",value:function(e,t){var n=Date.now(),r=t(),a=Date.now()-n;return console.log("task=".concat(e," time=").concat(a,"ms")),r}},{key:"open",value:function(e,t){var n=this;if(t||(t="draft"),this.subs.has(e))return this.subs.get(e)["".concat(t,"Handle")];var a={draftHandle:new wa(e,"draft",this),remoteHandle:new wa(e,"remote",this)},o=this.networkClient.subscribeToDocument(e,function(){var t=c._asyncToGenerator(regeneratorRuntime.mark((function t(r,a){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.refreshLocalData(e);case 2:if(!g.UpdateTypes.includes(r)){t.next=7;break}return t.next=5,n.handleDocContentUpdates(e,r,a);case 5:t.next=9;break;case 7:return t.next=9,n.handleMetadataUpdates(e,r,a);case 9:return t.abrupt("return");case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());return this.subs.set(e,r._objectSpread2({sub:o},a)),a["".concat(t,"Handle")]}}]),n}(s.EventEmitter),ja=["table0LeftIds","table1LeftIds","table2LeftIds","table1MainIds","table2MainIds","table1RightIds","table2RightIds","table9LeftIds","table9MainIds","table9RightIds","table3MainIds","table3LeftIds","table3RightIds","unassigned"],Ra=function(e){return"".concat(e.replace("_uniqueIds",""),"_uniqueIds")},Pa=function(e,t){var n,r,a=t||(null===e||void 0===e||null===(n=e.props)||void 0===n?void 0:n.customFields);if(!a||null===e||void 0===e||null===(r=e.children)||void 0===r||!r.length)return a;var o=((null===e||void 0===e?void 0:e.children)||[]).map((function(e){return e.id}));return Object.keys(a).forEach((function(t){var n=t.replace("_uniqueIds","");ja.includes(n)&&t.includes("_uniqueIds")&&(a[n]=(a[t]||[]).map((function(n){var r;return o.includes(n)?(o.splice(o.indexOf(n),1),(null===e||void 0===e||null===(r=e.children)||void 0===r?void 0:r.findIndex((function(e){return e.id===n})))+1):(a[t]=a[t].filter((function(e){return e!==n})),null)})).filter((function(e){return null!==e})).join(","))})),a},Fa=function(e){return"chains"===(null===e||void 0===e?void 0:e.collection)},Na=function(e){e&&("undefined"!==typeof e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded(!0):e.scrollIntoView())},Oa=a.makeStyles((function(e){return{root:{backgroundColor:e.palette.background.paper,display:"block !important"},nested1:{padding:"0 0 0 ".concat(e.spacing(2),"px"),marginBottom:"-8px"}}})),La=a.makeStyles((function(){return{entity:{padding:"4px 16px 4px 32px"},entityWithChildren:{padding:"4px 16px 4px 4px"}}})),Ma={table0LeftIds:"Top strip",table1LeftIds:"Table 1 - Column 1",table2LeftIds:"Table 2 - Column 1",table1MainIds:"Table 1 - Column 2",table2MainIds:"Table 2 - Column 2",table1RightIds:"Table 1 - Column 3",table2RightIds:"Table 2 - Column 3",table9LeftIds:"Far-right Table",table3LeftIds:"Table 3"},za=function(e){var t=JSON.parse(e),n=t.children;if(null===n||void 0===n||!n.length)return[];var r=t.props.customFields,a=["Tiling","Full span"].includes(null===r||void 0===r?void 0:r.layout)?{}:{table0LeftIds:[]};return ja.forEach((function(e){var t;null!==(t=r["".concat(e,"_uniqueIds")])&&void 0!==t&&t.length&&(a[e]=r["".concat(e,"_uniqueIds")].map((function(e){return{id:e}})))})),Object.entries(a).length?Object.entries(a):[[r.layout,n]]};function Ba(e,t,n){var r=this,a=o.useRef(null),l=o.useRef(0),i=o.useRef(null),d=o.useRef([]),u=o.useRef(),c=o.useRef(),s=o.useRef(e),f=o.useRef(!0);s.current=e;var p=!t&&0!==t&&"undefined"!==typeof window;if("function"!==typeof e)throw new TypeError("Expected a function");t=t||0;var m=!!(n=n||{}).leading,v=!("trailing"in n)||!!n.trailing,g="maxWait"in n,h=g?Math.max(n.maxWait||0,t):null,b=o.useCallback((function(e){var t=d.current,n=u.current;return d.current=u.current=null,l.current=e,c.current=s.current.apply(n,t)}),[]),y=o.useCallback((function(e,t){p&&cancelAnimationFrame(i.current),i.current=p?requestAnimationFrame(e):setTimeout(e,t)}),[p]),E=o.useCallback((function(e){if(!f.current)return!1;var n=e-a.current,r=e-l.current;return!a.current||n>=t||n<0||g&&r>=h}),[h,g,t]),x=o.useCallback((function(e){return i.current=null,v&&d.current?b(e):(d.current=u.current=null,c.current)}),[b,v]),C=o.useCallback((function(){var e=Date.now();if(E(e))return x(e);var n=e-a.current,r=e-l.current,o=t-n,i=g?Math.min(o,h-r):o;y(C,i)}),[h,g,E,y,x,t]),S=o.useCallback((function(){i.current&&(p?cancelAnimationFrame(i.current):clearTimeout(i.current)),l.current=0,d.current=a.current=u.current=i.current=null}),[p]),I=o.useCallback((function(){return i.current?x(Date.now()):c.current}),[x]);o.useEffect((function(){return f.current=!0,function(){f.current=!1}}),[]);var k=o.useCallback((function(){for(var e=Date.now(),n=E(e),o=arguments.length,s=new Array(o),p=0;p<o;p++)s[p]=arguments[p];if(d.current=s,u.current=r,a.current=e,n){if(!i.current&&f.current)return l.current=a.current,y(C,t),m?b(a.current):c.current;if(g)return y(C,t),b(a.current)}return i.current||y(C,t),c.current}),[b,m,g,E,y,C,t]),_=o.useCallback((function(){return!!i.current}),[]);return o.useMemo((function(){return{callback:k,cancel:S,flush:I,pending:_}}),[k,S,I,_])}var Ha,Ua=["onChange","label","value","style","canPasteHtml"],Wa=["general"],Ga=function(e){return e.replace(/(\w)(\w*)/g,(function(e,t,n){return t.toUpperCase()+n.toLowerCase()}))},Va=function(e){var t=e.children;return Wt.default.createElement("label",{style:{fontWeight:525,fontSize:14,opacity:"0.75",display:"block",marginBottom:"8px"}},"string"===typeof t?function(e){var t=e.replace(/([A-Z])/g," $1");return Ga(t.charAt(0).toUpperCase()+t.slice(1).trim())}(t):t)},qa=function(e){var t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)},Ya=function(e){var t=e.onChange,n=e.label,a=e.value,o=e.style,l=e.canPasteHtml,i=p._objectWithoutProperties(e,Ua),d=t?Ba((function(e){return t(e)}),500):void 0;return Wt.default.createElement("div",null,Wt.default.createElement(Va,null,n),Wt.default.createElement(rn.default,b._extends({className:l?"paste-html":"",onChange:d?function(e){return d.callback(e.nativeEvent)}:void 0,multiline:!0,variant:"outlined",defaultValue:a,style:r._objectSpread2(r._objectSpread2({},o),{},{width:"100%"})},i)))},Ja=function(e){var t=e.value,n=e.onChange,a=e.type,o=e.style,l=e.label,i=n?Ba((function(e){var t,r,o="number"===a?Number((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||0):null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value;n({target:{value:o}})}),500):void 0;return Wt.default.createElement("div",null,Wt.default.createElement(Va,null,l),Wt.default.createElement(rn.default,{defaultValue:t,onChange:i?function(e){return i.callback(e.nativeEvent)}:null,type:a,style:r._objectSpread2(r._objectSpread2({},o),{},{width:"100%"})}))},Qa=function(e){var t,n=e.type,a=e.onChange,o=e.lookup,l=e.contentService;return o[l]?Wt.default.createElement(Wt.default.Fragment,null,null===(t=Object.entries(o[l]))||void 0===t?void 0:t.map((function(e){var t=r._slicedToArray(e,2),o=t[0],l=t[1];return Wt.default.createElement(Ja,{type:n,label:o,onChange:function(e){a(o,e.target.value)},value:l})}))):Wt.default.createElement("p",{style:{margin:"24px 0px 0"}},l?"No fields found in lookup for contentService {contentService}. Available\n        services: ".concat(Object.keys(o).join(",")):"No contentService was included.")},Xa=function(e){var t=e.value,n=e.onChange,r=e.label;return Wt.default.createElement(on.default,{control:Wt.default.createElement(an.default,{defaultChecked:t,onChange:n,color:"default"}),label:r})},Ka=function(e){var t=e.onChange,n=e.labels,r=e.options,a=e.value,o=e.label;return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Va,null,o),Wt.default.createElement(Zt.default,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a,onChange:t},r.map((function(e,t){return Wt.default.createElement(Kt.default,{key:"".concat(e.value,"-").concat(t),value:e.value},n&&n[e.value]||e.name)}))))},Za=function(e){var t=e.k,n=e.label;return Wt.default.createElement("span",null,"Unimplemented: ",n," (",t,")")},$a=function(e){var t=e.value,n=e.onChange;if(!t.contentConfigValues)return null;var a=function(e){return function(t){if("contentService"===e)n({flexFeatureContentConfig:{contentService:t.target.value}});else{var a={flexFeatureContentConfig:{contentConfigValues:r._defineProperty({},e,t.target.value)}};n(a),n({blurbUrl:t.target.value})}}};return Wt.default.createElement("div",{style:{padding:"15px 0px"}},Wt.default.createElement(Ja,{type:"text",label:"Content Service",onChange:a("contentService"),value:t.contentService}),Object.keys(t.contentConfigValues).map((function(e){return Wt.default.createElement(Ya,{key:e,type:"text",label:"Content Path",onChange:a(e),value:t.contentConfigValues[e]})})))},eo={richtext:function(e){return Wt.default.createElement(Ya,b._extends({},e,{canPasteHtml:!0}))},string:Ja,url:Ya,bool:Xa,boolean:Xa,oneOf:Ka,dateTime:function(e){var t=e.value,n=e.onChange,a=e.label,l=o.useState(t),i=r._slicedToArray(l,2),d=i[0],u=i[1],c=Ba((function(e){n({target:{value:e}})}),1e3),s=function(e){u(e),c.callback(e)};return Wt.default.createElement("div",null,Wt.default.createElement(Va,null,a),Wt.default.createElement("input",{style:{border:"1px solid #c4c4c4",padding:"18.5px 14px",width:"100%",boxSizing:"border-box",borderRadius:"5px",marginBottom:"16px"},onChange:function(e){var t;s(new Date(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value).getTime())},type:"datetime-local",value:qa(d||-1)}),Wt.default.createElement(Gt.default,{className:"bg-primary",style:{width:"100%",textTransform:"initial",color:"#fff",margin:"8px 0",fontWeight:900,display:"block"},onClick:function(){return s((new Date).getTime())}},"Set to now"),Wt.default.createElement(Gt.default,{className:"bg-secondary",style:{width:"100%",textTransform:"initial",color:"#fff",fontWeight:900,margin:"8px 0",display:"block"},onClick:function(){return s(new Date(-1).getTime())}},"Reset"))},number:function(e){return Wt.default.createElement(Ja,b._extends({},e,{type:"number"}))},contentConfig:$a},to=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{displayName:{type:"string",name:"displayName"}};return Object.entries((null===e||void 0===e||null===(t=e.customFields)||void 0===t?void 0:t.args)||{}).reduce((function(e,t){var n=r._slicedToArray(t,2),a=n[0],o=n[1];o.tags&&o.tags.defaultValue;var l=o.args&&Array.isArray(o.args)?{options:o.args.map((function(e){return{value:e,name:e}}))}:{};return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},a,r._objectSpread2(r._objectSpread2(r._objectSpread2({},o),o.tags),l)))}),n)},no=function(e,t){var n=t.onFieldChange,a=t.overridesMap,o=void 0===a?{}:a,l=t.setEntity,i=t.fields;return Object.entries(e).reduce((function(e,t){var a=r._slicedToArray(t,2),d=a[0],u=a[1],s=u;if(!s){var f=Wt.default.createElement("div",{style:{color:"red"}},"WARNING: ",d);return r._objectSpread2(r._objectSpread2({},e),{},{warnings:e.warnings?[].concat(c._toConsumableArray(e.warnings),[f]):[f]})}if(s.hidden)return e;var p=o[s.type]||eo[s.type]||Za,m=("object"===b._typeof(i[d])?Object.values(i[d]).length&&i[d]:i[d])||s.defaultValue||null;if(p===Xa&&(m=!0===i[d]||"true"===i[d]),p===$a&&(!u||0===Object.keys(u).length))return r._objectSpread2({},e);var v=Wt.default.createElement("div",{key:d},Wt.default.createElement(nn.default,{fullWidth:!0,style:{padding:"15px 0"}},Wt.default.createElement(p,{label:s.name||d,setEntity:l,onChange:function(e){if(p!==Xa)if(p!==$a)n(d,$t.default(e,"target.value",e));else{if("object"===b._typeof(e)){var t=function(e){for(var t,n="";e;){var r="object"===b._typeof(e)?Object.keys(e)[0]:void 0;r?(n=n?"".concat(n,".").concat(r):r,e=e[r]):(t=e,e=void 0)}return{path:n,val:t}}(e),r=t.path,a=t.val;return void("string"===typeof a&&n(r,a))}n(d,e)}else n(d,$t.default(e,"target.checked",e))},value:m,options:s.options,labels:s.labels,k:d,canPasteHtml:null===u||void 0===u?void 0:u.canPasteHtml,Select:Ka,TextArea:Ya,QueriesForm:Qa}))),g=r._defineProperty({},s.group||"general",[].concat(c._toConsumableArray(e[s.group||"general"]||[]),[v]));return r._objectSpread2(r._objectSpread2({},e),g)}),{})},ro=function(e){var t=e.fields,n=e.onFieldChange,a=e.propTypes,o=e.setEntity,l=e.overridesMap,i=to(a),d=no(i,{onFieldChange:n,overridesMap:l,fields:t,setEntity:o}),u=d.general,s=p._objectWithoutProperties(d,Wa);return Wt.default.createElement(Wt.default.Fragment,null,u&&Wt.default.createElement(ao,{defaultOpen:!0,name:t.siteServiceSection?"Global Content":"General"},u),c._toConsumableArray(Object.entries(s)).map((function(e){var t=r._slicedToArray(e,2),n=t[0],a=t[1],o=Ga(n);return n?Wt.default.createElement(ao,{key:o,name:o},a):Wt.default.createElement("div",{key:o},o,Wt.default.createElement("div",null,a))})))},ao=function(e){var t=e.name,n=e.defaultOpen,a=void 0!==n&&n,l=e.children,i=o.useState(a),d=r._slicedToArray(i,2),u=d[0],c=d[1],s=o.useState(!1),f=r._slicedToArray(s,2),p=f[0],m=f[1],v=function(){return c(!u)};return Wt.default.createElement("div",{"data-qa":"customFieldsForm"},Wt.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",margin:"8px 0",cursor:"pointer",alignItems:"center",borderBottomWidth:"".concat(u?2:1,"px"),borderBottomStyle:"solid"},className:u||p?"bc-primary":"","data-qa":"customFieldsGroup",onClick:v,onMouseEnter:function(){return m(!0)},onMouseLeave:function(){return m(!1)}},Wt.default.createElement("h2",{style:{fontSize:"22px",fontWeight:500},className:p||u?"color-primary":"color-default"},t)," ",u?Wt.default.createElement(en.default,{style:{fontSize:"20px"},className:"color-primary",onClick:v}):Wt.default.createElement(tn.default,{style:{fontSize:"20px"},className:p?"color-primary":"color-default",onClick:v})),u&&Wt.default.createElement("div",{style:{padding:"8px",marginBottom:"24px"}},l))},oo=["id","locked","parentId","props"],lo=["variants"],io=["id"],uo=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!a)return e;if(null===e||void 0===e||null===(t=e.props)||void 0===t||null===(n=t.variants)||void 0===n||!n[a]){var o="chains"===e.collection?ja.reduce((function(t,n){var r;return t[Ra(n)]=c._toConsumableArray((null===(r=e.props.customFields)||void 0===r?void 0:r[Ra(n)])||[]),t}),{}):void 0,l=r._objectSpread2({id:e.props.id},o?{customFields:o}:{}),i=((null===e||void 0===e?void 0:e.children)||[]).map((function(e){return{id:e.id}})),d={hidden:!1,props:l,children:i,collection:e.collection,isVariant:!0};e.type&&(d.type=e.type),e.props.variants?e.props.variants[a]=d:e.props.variants=r._defineProperty({},a,d)}return e.props.variants[a]},co=function(e){var t,n;return(null===e||void 0===e||null===(t=e.props)||void 0===t?void 0:t.variants)&&Object.keys(null===e||void 0===e||null===(n=e.props)||void 0===n?void 0:n.variants).length},so=function(e,t){var n,r,a=null===e||void 0===e||null===(n=e.root)||void 0===n||null===(r=n.props)||void 0===r?void 0:r.experiments;if(!a)return e;Object.keys(a).forEach((function(n){t(e,n)}))},fo=function e(t){var n=t.featureId,a=t.parentId,o=t.insertColumn,l=t.siblingId,i=t.relativePosition,d=void 0===i?"bottom":i,u=t.insertColIndex;return function(i){var c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=o?Ra(o.replace("_uniqueIds","")):void 0,p=uo(i[a],s),m=p.props.customFields;if(!m)return console.error("No custom fields on parent found; cannot add new feature to chain",{parentId:a,featureId:n}),i;var v=u;return l&&ja.find((function(e){var t,n=Ra(e),r=m[n];return null!==(t=r)&&void 0!==t&&t.length||(m[n]=[],r=m[n]),r.find((function(e,t){return e===l&&(c=n,v="number"===typeof v?v:"top"===d?t:t+1,!0)}))})),c&&"number"===typeof v?(m[c]||(m[c]=[]),v=Math.min(v,Math.max(m[c].length,0)),m[c].splice(v,0,n)):(c=f||Ra("table1LeftIds"),m[c]||(m[c]=[]),"top"===d?m[c].unshift(n):m[c].push(n)),Pa(p),co(p)&&so(i,e(r._objectSpread2(r._objectSpread2({},t),{},{insertColIndex:u,insertColumn:c,siblingId:void 0}))),i}},po=function e(t){var n=t.entity,r=t.parentId;return function(t){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=uo(t[r],o);if(!l||"chains"!==(null===(a=t[r])||void 0===a?void 0:a.collection))return t;var i=Array.isArray(n)?n:[n];return i.forEach((function(e){var t=g.objectToId(e);ja.find((function(e){var n,r,a=Ra(e);if(null!==(n=l.props.customFields)&&void 0!==n&&null!==(r=n[a])&&void 0!==r&&r.length){var o,i=null===(o=l.props.customFields[a])||void 0===o?void 0:o.findIndex((function(e){return e===t}));if(i>-1)return l.props.customFields[a].splice(i,1),!0}return!1}))})),Pa(l,void 0),co(l)&&so(t,e({entity:n,parentId:r})),t}},mo=function(e){var t;return $t.default(e,"props.customFields.displayName",$t.default(e,"customFields.displayName",$t.default(e,"displayName",(null===e||void 0===e||null===(t=e.props)||void 0===t?void 0:t.type)||(null===e||void 0===e?void 0:e.type))))},vo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=h.v4(),o=(new Date).getTime(),l=e||{};l.id,l.locked,l.parentId;var i=l.props,d=p._objectWithoutProperties(l,oo),u=i||{},c=u.variants,s=void 0===c?{}:c,f=p._objectWithoutProperties(u,lo),m=n&&s[n]?r._objectSpread2(r._objectSpread2(r._objectSpread2({},f),s[n]),{},{customFields:r._objectSpread2(r._objectSpread2({},f.customFields),s[n].props.customFields)}):f;return JSON.parse(JSON.stringify(r._objectSpread2(r._objectSpread2({},d),t?{props:r._objectSpread2(r._objectSpread2({},m),{},{id:a,clonedOn:o})}:{props:m})))},go=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(a){var o=[],l=uo(a,n);if(null!==a&&void 0!==a&&a.type&&(l.type=a.type),null!==a&&void 0!==a&&a.collection&&(l.collection=a.collection),null!==l&&void 0!==l&&l.children){l.children.forEach((function(r){var a=r.id,l=r.props,i=r.type;l&&i?o.push(vo(r,t,n)):o.push(vo(e[a],t,n))}));var i=r._objectSpread2(r._objectSpread2({},vo(l,t)),{},{children:o});if("chains"===l.collection){var d,u=(null===i||void 0===i||null===(d=i.props)||void 0===d?void 0:d.customFields)||{};return Object.keys(u).forEach((function(e){var t=Ra(e);ja.includes(e)&&(u[t]=u[e].split(",").filter((function(e){return e})).map((function(e){var t=parseInt(e,10);return i.children[t-1]?g.objectToId(i.children[t-1]):null})).filter((function(e){return e})))})),i}return i}return vo(l,t)}},ho=function(e){return function(t){var n=!1;if("fronts/flex-feature"===t.type&&(n=!0),t.type){var r,a=e[t.type];Object.keys((null===t||void 0===t||null===(r=t.props)||void 0===r?void 0:r.customFields)||{}).forEach((function(e){var r,o,l,i,d=null===a||void 0===a||null===(r=a.customFields)||void 0===r||null===(o=r.args)||void 0===o||null===(l=o[e])||void 0===l||null===(i=l.tags)||void 0===i?void 0:i.defaultValue,u=t.props.customFields[e];if("undefined"!==typeof d&&"undefined"!==typeof u&&"object"!==b._typeof(u)&&"rowSpan"!==e){var c=function(){var t,n,r,o=function(e,t){if(e.includes("LabelType")&&"Section Small"==t)return"Package Nested"}(e,u);if(o)return o;switch(null===a||void 0===a||null===(t=a.customFields)||void 0===t||null===(n=t.args)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.type){case"number":return isNaN(Number(u))?0:Number(u);case"bool":case"boolean":return!0===u||"true"===u;case"oneOf":return""===u?d:u;default:return u}}();n&&c===d?delete t.props.customFields[e]:c!==u&&(t.props.customFields[e]=c)}}))}return t}},bo=function(e){var t=ho(e);return function(n){return e&&Object.keys(n).forEach((function(e){var r=n[e];t(r)})),n}},yo=function(e,t){return g.objectToId(e)===g.objectToId(t)},Eo=function(e){var t=[];Object.keys(e).forEach((function(n){if(!t.includes(n)){var r,a=e[n].props,o=Object.keys((null===a||void 0===a?void 0:a.variants)||{}),l=0===o.length||!o.find((function(e){return!e.hidden})),i=((null===a||void 0===a||null===(r=a.variants)||void 0===r?void 0:r[o[0]])||{children:[]}).children;l||(t.push(n),null!==i&&void 0!==i&&i.length&&i.forEach((function(e){t.push(e.id)})))}})),Object.keys(e).forEach((function(n){var r;if(!t.includes(n)&&null!==(r=e[n])&&void 0!==r&&r.hidden){var a=e[n].children;[].concat(c._toConsumableArray(a||[]),[{id:n}]).forEach((function(t){var n=t.id;return delete e[n]}))}}))},xo=function e(t){var n=t.entity,r=t.parentId;return function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=uo(t[r],a),l=Array.isArray(n)?n:[n];return l.forEach((function(e){var n=g.objectToId(e);if(o.children){var r=o.children.findIndex((function(t){return yo(t,e)}));-1===r||o.children.splice(r,1)}var l,i=t[n];null!==i&&void 0!==i&&i.children&&(null===(l=i.children)||void 0===l||l.forEach((function(e){uo(t[g.objectToId(e)],a).hidden=!0})));uo(i,a).hidden=!0,Eo(t)})),"chains"===(null===o||void 0===o?void 0:o.collection)&&Pa(o),co(o)&&so(t,e({entity:n,parentId:r})),t}},Co=function(e){var t=e.id,n=e.prevParentId,r=e.currentParentId,a=e.siblingId,o=e.relativePosition,l=e.colId;return function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=uo(e[r],i);if(n!==r){if(n){var u=uo(e[n],i);po({entity:{id:t},parentId:n})(e,i);var c=u.children.findIndex((function(e){return e.id===t}));u.children.splice(c,1),Pa(u)}d.children?d.children.push({id:t}):d.children=[{id:t}],fo({featureId:t,parentId:r,siblingId:a,relativePosition:o,insertColumn:l})(e,i)}else{var s=d.props.customFields;ja.find((function(e){var n,r=Ra(e),a=null===(n=s[r])||void 0===n?void 0:n.findIndex((function(e){return e===t}));return a>-1&&(s[r].splice(a,1),!0)})),ja.find((function(e){var n=Ra(e);if(a){var r,i=null===(r=s[n])||void 0===r?void 0:r.findIndex((function(e){return e===a}));if(i>-1){var d="top"===o?i:i+1;return s[n].splice(d,0,t),!0}}if(l){var u=s[Ra(l)];return u||(s[Ra(l)]=[],u=s[Ra(l)]),"top"===o?u.unshift(t):u.push(t),!0}return!1})),Pa(d)}return e}},So=function e(t){var n=t.id,r=t.prevParentId,a=t.currentParentId,o=t.siblingId,l=t.relativePosition,i=t.colId,d=t.isFlexFeatureSibling;return function(u){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=uo(u[r],c),f=uo(u[a],c);if(d)Co({id:n,prevParentId:r,currentParentId:a,siblingId:o,relativePosition:l,colId:i})(u,c);else{var p=s.children.findIndex((function(e){return e.id===n}));if(-1==p)return u;s.children.splice(p,1),Io({id:n,parentId:a,siblingId:o,relativePosition:l})(u,c)}return(co(s)||co(f))&&so(u,e(t)),u}},Io=function(e){var t=e.id,n=e.parentId,r=e.siblingId,a=e.relativePosition;return function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=uo(e[n],o),i=null===l||void 0===l?void 0:l.children;if(!i)return l.children=[{id:t}],e;var d="top"===a?0:i.length,u=r?i.findIndex((function(e){return e.id===r})):void 0;return u&&(d="top"===a?u:u+1),d>-1&&i.splice(d,0,{id:t}),e}},ko=["fronts/flex-feature","fronts/diversions","fronts/market-watch","fronts/most-read","fronts/newsletter-module","fronts/brights"],_o=function(e){var t=e.id,n=e.parentId,r=e.newEntity;return function(e){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=uo(e[n],o);return ko.includes(r.type)&&"chains"===(null===(a=e[n])||void 0===a?void 0:a.collection)&&!((null===l||void 0===l?void 0:l.children)||[]).find((function(e){return yo(e,r)}))&&(null!==l&&void 0!==l&&l.children?l.children.push({id:t}):l.children=[{id:t}]),e}},Ao=function(e){var t=e.entity,n=e.parentId,a=e.tidyEntity;return function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=g.objectToId(t),i=a(r._objectSpread2(r._objectSpread2({},t),{},{children:[]}));return null!==t&&void 0!==t&&t.children&&(i.children=null===t||void 0===t?void 0:t.children.map((function(t){var n=t.id;if(p._objectWithoutProperties(t,io)){var r=g.objectToId(t);return"undefined"===typeof e[r]&&(e[r]=t),{id:r}}return{id:n}}))),"undefined"===typeof e[l]&&(e[l]=i),_o({id:l,parentId:n,newEntity:i})(e,o),co(e[n])&&so(e,_o({id:l,parentId:n,newEntity:i})),e}},To=function(e){var t=e.entity,n=e.parentId,r=e.relativePosition,a=e.siblingId,o=e.insertColumn,l=e.tidyEntity;return function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=Array.isArray(t)?t:[t];return d.forEach((function(t){var d,u=g.objectToId(t);("undefined"===typeof e[u]||i)&&(Ao({entity:t,parentId:n,tidyEntity:l})(e,i),ko.includes(t.type)&&"chains"===(null===(d=e[n])||void 0===d?void 0:d.collection)?fo({featureId:u,parentId:n,insertColumn:o,relativePosition:r,siblingId:a})(e,i):Io({id:u,parentId:n,relativePosition:r,siblingId:a})(e,i))})),e}},wo=function(e,t,n,a){return function(e){var t=e.propTypes,n=e.collection,a=e.type,o=e.defaultName,l=e.children,i=Fa({collection:n}),d=to(t),u=Object.entries(d||{}),c=h.v4(),s=i?l||[]:l,f=s?{children:s}:{},p=s?{childProps:s}:{};return u.reduce((function(e,t){var l,i,d=r._slicedToArray(t,2),u=d[0],c=d[1];return r._objectSpread2(r._objectSpread2({},e),{},{props:r._objectSpread2(r._objectSpread2({},e.props),{},{collection:n,type:a,customFields:r._objectSpread2(r._objectSpread2({},(null===e||void 0===e||null===(l=e.props)||void 0===l?void 0:l.customFields)||{}),{},(i={},r._defineProperty(i,u,c.defaultValue||""),r._defineProperty(i,"displayName",o||a),i))})})}),r._objectSpread2(r._objectSpread2({props:r._objectSpread2(r._objectSpread2({},p),{},{id:c,displayProperties:{},variants:{},collection:n,customFields:{}}),collection:n},f),{},{type:a}))}({propTypes:e,type:t,collection:a||"top-table"===t?"chains":"features",defaultName:n})},Do="".concat(1400),jo=(Ha={},r._defineProperty(Ha,"".concat(1400),{name:"1400 - MX",width:1400,icon:cn.default,style:{fontSize:"1.25rem",marginRight:4}}),r._defineProperty(Ha,"".concat(1150),{name:"1150 - LG",width:1150,icon:un.default,style:{fontSize:"1.25rem",marginRight:4}}),r._defineProperty(Ha,"".concat(900),{name:"900 - MD",width:900,icon:dn.default,style:{fontSize:"1.25rem",marginRight:4,transform:"rotate(90deg)"}}),r._defineProperty(Ha,"".concat(768),{name:"768 - SM",width:768,icon:dn.default,style:{fontSize:"1.25rem",marginRight:4}}),r._defineProperty(Ha,"375",{name:"375 - XS",width:375,icon:ln.default,style:{fontSize:"1.25rem",marginRight:4}}),Ha),Ro={displayName:"New test",description:"Test description goes here",type:"Akamai",showOnMobile:!0,showOnTablet:!0,showOnDesktop:!0},Po={customFields:{args:{displayName:{type:"string",defaultValue:Ro.displayName},description:{type:"richtext",defaultValue:Ro.description},type:{type:"oneOf",args:["Akamai"],defaultValue:Ro.type},variant1Key:{type:"string",defaultValue:"",group:"Advanced"},variant2Key:{type:"string",defaultValue:"",group:"Advanced"}}}},Fo={ADD:["#1f8925","added"],SET:["#ecaf2d","changed"],DUPLICATED:["#1f8925","duplicated"],CLIPBOARD_ADD:["#1f8925","pasted from clipboard"],CLIPBOARD_CUT:["#d20102","cut to clipboard"],REMOVED:["#d20102","deleted"],MOVED:["#6814c9","moved"],DEFAULT:["#3a3a3a","modified"]},No={ADD_TO_CLIPBOARD:"ADD",ADD_ENTITY:"ADD",EDIT_ENTITY:"SET",MOBILE_REORDER:"MOVED",DRAG_AND_DROP_ENTITY:"MOVED",DELETE_ENTITY:"REMOVED",DELETE_ENTITIES:"REMOVED",DELETE_FROM_CLIPBOARD:"REMOVED",DUPLICATE_ENTITY:"DUPLICATED",CUT_TO_CLIPBOARD:"CLIPBOARD_CUT",DRAG_FROM_CLIPBOARD:"CLIPBOARD_ADD",PASTE_FROM_CLIPBOARD:"CLIPBOARD_ADD"},Oo=function(e){var t=new Date(e),n=t.getMonth()+1,r=t.getDate(),a=t.getFullYear(),o=t.getHours(),l=t.getMinutes(),i=o>11?"PM":"AM";return"".concat(n,"/").concat(r,"/").concat(a,"  ").concat(o>12?o%12:o,":").concat(l<10?"0"+l:l," ").concat(i)},Lo={roundedOutlineCard:{display:"flex",fontWeight:100,padding:"12px",border:"1px solid ".concat("#d4d4d4"),borderRadius:8},flexColumn:{display:"flex",flexDirection:"column",cursor:"pointer",color:"#3a3a3a"},label:{textTransform:"uppercase",fontWeight:900,fontSize:".8rem",color:"#bfbfbf"},bold:{fontWeight:600,marginBottom:4},subtext:{fontSize:"0.85rem",margin:"4px 0"},collapseMenu:{display:"flex",alignItems:"center",cursor:"pointer"},cardButton:{textTransform:"none",border:"2px solid"},experimentBanner:{boxSizing:"border-box",width:"100%",padding:"8px 16px",color:"#FFF",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:12,textTransform:"uppercase",letterSpacing:".1rem",fontWeight:600}},Mo=r._objectSpread2(r._objectSpread2({},Lo.roundedOutlineCard),{},{display:"block",margin:"8px 0"}),zo={fontSize:"inherit",className:"hover-blue",style:{margin:"2px 0"}},Bo=function(e){var t=e.id,n=e.isEditing,a=e.experiment,o=e.clearChanges,l=e.handleEditTest,i=e.handleDeleteTest,d=e.handleEditVariant,u=a.type,c=a.displayName,s=a.addedBy,f=a.description,p=a.dateCreated,m=a.dateUpdated;return Wt.default.createElement("div",{style:Mo},Wt.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},Wt.default.createElement("div",null,Wt.default.createElement("p",{style:Lo.label},u),Wt.default.createElement("p",{style:Lo.bold},c),Wt.default.createElement("p",{style:Lo.subtext},"Added by ",s||"Unknown"),Wt.default.createElement("p",{style:r._objectSpread2(r._objectSpread2({},Lo.subtext),{},{fontStyle:"italic"})},f),(m||p)&&Wt.default.createElement("p",{style:Lo.subtext},"Last updated: ",Oo(m||p))),Wt.default.createElement("div",{style:Lo.flexColumn},Wt.default.createElement(gr.default,b._extends({},zo,{onClick:function(){return l(t)}})),Wt.default.createElement(vr.default,b._extends({},zo,{onClick:function(){return i(t)}})))),Wt.default.createElement("div",{style:{display:"flex",justifyContent:"space-evenly",marginTop:4}},Wt.default.createElement(Be.Button,{className:"b bc-primary color-primary",onClick:d,style:Lo.cardButton},n?"Stop editing":"Edit variant"),Wt.default.createElement(Be.Button,{style:Lo.cardButton,onClick:o},"Clear changes")))},Ho=Wt.default.createContext({isParent:!0,apiUrl:"",presetOptions:{presets:[],mini:[],mobile:[]}}),Uo={setDragEntity:function(){},getDragEntity:function(){},handleDragStart:function(){return function(){}},handleDragEnd:function(){return function(){}}},Wo=Wt.default.createContext(Uo),Go=Wt.default.createContext({}),Vo=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=ya(),a=n.useDocument,o=n.useSetDocument,l=b.useComponentFields("fronts/flex-feature"),i=Ia(),d=null===(e=xa())||void 0===e?void 0:e.user,u=a(i,"remote",t?"":"renderable-sections-0"),c=r._slicedToArray(u,1),s=c[0],f=o(i,"remote"),p=ho(l),m=Wt.default.useCallback((function(e){var t=Array.isArray(e)?e:[e],n=t.map((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{clonedBy:d})}));f({docId:i,mode:"remote"},{type:g.ActionTypes.ADD_TO_CLIPBOARD,featureIds:t.map((function(e){return g.objectToId(e)})),names:t.map((function(e){return mo(e)}))},To({entity:n,parentId:"renderable-sections-0",relativePosition:"bottom",tidyEntity:p}))}),[f,i]),v=Wt.default.useCallback((function(e){return f({docId:i,mode:"remote"},{type:g.ActionTypes.DELETE_FROM_CLIPBOARD,featureIds:[g.objectToId(e)],names:[mo(e)]},xo({entity:e,parentId:"renderable-sections-0"}))}),[f,i]);return[s,m,v]},qo=function(){var e=Vo(),t=r._slicedToArray(e,3);return[t[1],t[2]]},Yo=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"renderable-sections-0",n=ya(),a=n.useDocument,o=Ia(),l=a(o,"remote"),i=r._slicedToArray(l,1),d=i[0];if(!d)return{children:[],collection:"",locked:!1};var u=t?d[t]:{children:[]};return r._objectSpread2(r._objectSpread2({},u),{},{children:null!==u&&void 0!==u&&u.children?null===u||void 0===u||null===(e=u.children)||void 0===e?void 0:e.map((function(e){var t,n=d[g.objectToId(e)]||{};return r._objectSpread2(r._objectSpread2({},n),{},{children:null===n||void 0===n||null===(t=n.children)||void 0===t?void 0:t.map((function(e){return d[g.objectToId(e)]}))})})):[]})},Jo=function(){var e=ya().useSetDocument,t=Ia(),n=e(t,"remote");return function(e){return n({docId:t,mode:"remote"},{type:g.ActionTypes.EDIT_ENTITY,featureIds:["clipboard"],names:["clipboard"]},e)}},Qo=Wt.default.createContext({setMenuProps:function(){return function(){}}}),Xo=Wt.default.createContext({setDialogProps:function(){return function(){}}}),Ko=function(){return Wt.default.useContext(Xo)},Zo=Wt.default.createContext({menuRef:null}),$o=function(e){var t=e.header,n=e.buttonClassName,r=e.buttonText,a=e.buttonHandler,o=e.buttonIcon,l=e.buttonStyles,i=e.buttonDisabled;return Wt.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",margin:"16px 0 0 16px",alignItems:"center"}},Wt.default.createElement("h3",{style:{fontWeight:400,fontSize:"1.1rem"}},t),r?Wt.default.createElement(Gt.default,{style:l,className:n,onClick:a,disabled:i},Wt.default.createElement(o,{style:{marginRight:4},fontSize:"inherit"}),r):Wt.default.createElement("span",{onClick:a,style:{cursor:"pointer"}},Wt.default.createElement(o,{style:{marginRight:4}})))},el=["props","type","collection"],tl=["props","children"],nl=["props","children"],rl=function(){var e=xa(),t=null===e||void 0===e?void 0:e.user,n=Hl(),a=r._slicedToArray(n,1)[0],o=sl(),l=Ul(),i=r._slicedToArray(l,2),d=i[0],u=i[1],c=function(e){var t,n;return(null===e||void 0===e||null===(t=e.root)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.experiments)||{}}(d),s=function(e,t,n,r){u({docId:o,mode:a},{type:e,featureIds:[t||"root"],names:[n||"Root"],mode:a},r)};return[c,function(e){var n=null!==e&&void 0!==e&&e.preventDefault?{}:e;null!==e&&void 0!==e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation());var a=h.v4();return s(g.ActionTypes.ADD_EXPERIMENT,a,Ro.displayName,(function(e){var o,l;if(null!==e&&void 0!==e&&null!==(o=e.root)&&void 0!==o&&null!==(l=o.props)&&void 0!==l&&l.experiments||(e.root.props.experiments={}),!e.root.props.experiments[a]){var i=r._objectSpread2(r._objectSpread2(r._objectSpread2({},Ro),n||{}),{},{addedBy:t,dateCreated:(new Date).getTime()});e.root.props.experiments[a]=i}return e})),a},function(e){return function(t,n){var r;s(g.ActionTypes.EDIT_EXPERIMENT,e,null===c||void 0===c||null===(r=c[e||""])||void 0===r?void 0:r.displayName,(function(r){return e&&null!==r&&void 0!==r&&r.root?(r.root.props.experiments[e][t]=n,r.root.props.experiments[e].dateUpdated=(new Date).getTime(),r):r}))}},function(e){var t;s(g.ActionTypes.DELETE_EXPERIMENT,e,null===c||void 0===c||null===(t=c[e||""])||void 0===t?void 0:t.displayName,(function(t){var n,r,a;return null!==t&&void 0!==t&&null!==(n=t.root)&&void 0!==n&&null!==(r=n.props)&&void 0!==r&&null!==(a=r.experiments)&&void 0!==a&&a[e]?(delete t.root.props.experiments[e],t):t}))}]},al=function(e){var t,n,a,o,l=(0,ya().useDocument)(sl(),e),i=r._slicedToArray(l,1)[0];return Object.keys((null===i||void 0===i||null===(t=i.root)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.experiments)||{}).length>0?Object.keys((null===i||void 0===i||null===(a=i.root)||void 0===a||null===(o=a.props)||void 0===o?void 0:o.experiments)||{})[0]:null},ol=function(e){var t=e||{props:{}},n=t.props,a=t.type,o=t.collection,l=p._objectWithoutProperties(t,el),i=function(e){var t=rl(),n=r._slicedToArray(t,1)[0];return Object.keys(n).filter((function(t){return e.includes(t)}))}(Object.keys((null===n||void 0===n?void 0:n.variants)||{}));if(null===n||void 0===n||!n.variants||!i.length)return e;var d=i.length?Object.keys(null===n||void 0===n?void 0:n.variants)[0]:"",u=He.useIsVariantB(d);if(!u)return e;var c=r._objectSpread2(r._objectSpread2({},l),{},{type:a,collection:o,props:n});if(u){var s=n.variants[d],f=s.props,m=s.children;p._objectWithoutProperties(s,tl);var v=f.customFields;c=r._objectSpread2(r._objectSpread2({},c),{},{props:r._objectSpread2(r._objectSpread2({},c.props),{},{customFields:r._objectSpread2(r._objectSpread2({},n.customFields),v)}),children:m})}return c},ll=function(){var e=(0,He.useExperimentsProvider().getAllVariantGroups)();return function(t){var n=(t||{props:{}}).props,a=function(e,t){var n,r=(null===e||void 0===e||null===(n=e.props)||void 0===n?void 0:n.variants)||{};return Object.keys(r).filter((function(e){return t.includes(e)}))}(t,Object.keys(e));if(null===n||void 0===n||!n.variants||!a.length)return t;var o=a.length?Object.keys(null===n||void 0===n?void 0:n.variants)[0]:"";if(!(1===e[o]))return t;var l=n.variants[o],i=l.props,d=l.children,u=p._objectWithoutProperties(l,nl),c=i.customFields;return r._objectSpread2(r._objectSpread2(r._objectSpread2({},t),u),{},{props:r._objectSpread2(r._objectSpread2(r._objectSpread2({},n),i),{},{customFields:r._objectSpread2(r._objectSpread2({},n.customFields),c)}),children:d})}},il=l.atom({key:"hacky_force_refresh",default:0}),dl=l.atom({key:"constants",default:null}),ul=l.atom({key:"currentDocId",default:null}),cl=l.atom({key:"editorState",default:{drawerView:"DocumentView",drawerOpen:!0,data:null}});function sl(){var e,t,n=l.useRecoilValue(ul);return null===(e=Sa().filter((function(e){return e.slug===n})))||void 0===e||null===(t=e[0])||void 0===t?void 0:t.docId}function fl(){return l.useRecoilValue(ul)}var pl=function(){var e,t,n=l.useRecoilValue(ul);return null===(e=Sa().filter((function(e){return e.slug===n})))||void 0===e||null===(t=e[0])||void 0===t?void 0:t.name},ml=l.atom({key:"showHelpers",default:!1}),vl=l.atom({key:"isBalancingRowspans",default:!1}),gl=l.atom({key:"iframeMode",default:Do}),hl=l.atom({key:"isLocked",default:!0}),bl=l.atom({key:"isAnimated",default:!1}),yl=l.atom({key:"activeExperimentEditingId",default:null}),El=function(){return l.useRecoilState(yl)},xl=l.atom({key:"collapsedItems",default:{"renderable-sections-0":!1,"renderable-sections-1":!1,"renderable-sections-2":!1,"renderable-sections-3":!1,"renderable-sections-4":!1}}),Cl=function(e){return function(t){return r._objectSpread2(r._objectSpread2({},t),{},{drawerOpen:"boolean"===typeof e?e:!t.drawerOpen})}},Sl=l.atomFamily({key:"entityInteractions",default:{hovered:!1}}),Il=function(e){var t=g.objectToId(e);return l.useRecoilState(Sl(t))},kl=l.atom({key:"selectedEntity",default:null}),_l=function(){return l.useRecoilState(kl)},Al=l.atom({key:"dragTarget",default:null}),Tl=l.atom({key:"hoveredEntity",default:null}),wl=function(e,t,n){var a=ya().useDocument,o=El(),l=r._slicedToArray(o,1)[0],i=g.objectToId(e),d=a(t,n,i),u=r._slicedToArray(d,2),s=u[0],f=u[1],p=ol(s),m=Wl(!1),v=c.getJSONSize(m(p));return[p,function(e){f({docId:t,mode:n},{type:g.ActionTypes.EDIT_ENTITY,featureIds:[i],names:[mo(p)]},(function(t){var n=uo(t,l);return e(n)}))},v]},Dl=function(e,t,n){var a,o,l=wl(e,t,n),i=r._slicedToArray(l,1)[0],d=Object.keys((null===i||void 0===i||null===(a=i.props)||void 0===a?void 0:a.variants)||{})[0];return d?null===i||void 0===i||null===(o=i.props)||void 0===o?void 0:o.variants[d]:void 0},jl=function(e,t,n){var a=ya(),o=a.useDocument,l=a.mode,i=ll(),d=o(t||sl(),n||l),u=r._slicedToArray(d,1)[0];return e.children?e.children.map((function(e){var t=i(u[g.objectToId(e)]);return t.props})):[]};function Rl(e,t){var n=ya(),a=n.useSetDocument,o=n.mode,l=t||o,i=a(e||sl(),l),d=El(),u=r._slicedToArray(d,1)[0];return function(e,t,n){return i(e,t,n,u)}}function Pl(){return(0,ya().usePublishDocument)(sl())}var Fl=function(){return(0,ya().usePush)(sl())},Nl=function(){return(0,ya().useChangeLog)(sl())},Ol=function(){var e=ya(),t=e.useDocumentJSONSize,n=e.mode;return t(sl(),n)},Ll=function(){return(0,ya().useHasUncommittedChanges)(sl())},Ml=function(){var e=ya(),t=e.useDocumentStatus,n=e.mode;return t(sl(),n)},zl=function(){var e=ya(),t=e.useLastCommit,n=e.mode;return t(sl(),n)||{user:"",timestamp:null}},Bl=function(){var e=ya(),t=e.useResetDocument,n=e.mode;return t(sl(),n)};function Hl(){var e=ya();return[e.mode,e.setMode]}function Ul(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=ya(),n=t.useDocument,a=t.mode,o=El(),l=r._slicedToArray(o,1),i=l[0],d=sl(),u=n(d,a,e),c=r._slicedToArray(u,3),s=c[0],f=c[1],p=c[2],m=function(e,t,n){return f(e,t,n,i)};return[s,m,p]}function Wl(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Ul(),n=r._slicedToArray(t,1),a=n[0];return go(a,e)}var Gl=function(){return l.useRecoilState(cl)},Vl=function(){return l.useSetRecoilState(cl)},ql=function(){var e=El(),t=r._slicedToArray(e,2),n=t[0],a=t[1];return n?Wt.default.createElement("div",{className:"bg-primary",style:Lo.experimentBanner},"You are currently editing the variant for experiment"," ",n,Wt.default.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),a(null)},className:"hover-underline",style:{display:"flex",marginLeft:4,color:"#FFF"}},"STOP EDITING ",Wt.default.createElement(br.default,{fontSize:"inherit",style:{marginLeft:"4px"}}))):null},Yl=function(){var e=ya().mode,t=al(e),n=El(),a=r._slicedToArray(n,2),o=a[0],i=a[1],d=l.useRecoilState(ml),u=r._slicedToArray(d,2),c=u[0],s=u[1],f=l.useRecoilState(vl),p=r._slicedToArray(f,2),m=p[0],v=p[1];return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(ql,null),Wt.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",height:"46px",boxSizing:"border-box",border:"1px solid ".concat("#d4d4d4")},className:"bg-primary-10","data-qa":"docPublishBar"},Wt.default.createElement("div",null,Wt.default.createElement(Gt.default,{"data-qa":"doc-show-helpers-btn",className:c?"color-primary":"color-default",style:{margin:"0 0 0 8px",textTransform:"none",height:30},onClick:function(){return s(!c)},startIcon:Wt.default.createElement(hr.default,{fontSize:"inherit"})},"Helpers"),Wt.default.createElement(Gt.default,{"data-qa":"doc-balance-rowspans-btn",style:{textTransform:"none",height:30},className:m?"color-primary":"color-default",onClick:function(){return v(!m)},startIcon:Wt.default.createElement(Vt.default,{fontSize:"inherit",style:{transform:"rotate(-45deg)"}})},"Balance"),t&&Wt.default.createElement(Gt.default,{"data-qa":"doc-balance-rowspans-btn",style:{textTransform:"none",height:30},className:o?"color-primary":"color-default",onClick:function(){return i(o?null:t)},startIcon:Wt.default.createElement(qt.default,{fontSize:"inherit"})},"Edit variant"))))},Jl={copy:In.default,board:$n.default,feature:kn.default,atm:_n.default,alert:An.default,code:Qn.default,header:Tn.default,chart:wn.default,youtube:Dn.default,newspaper:Gn.default,calendar:jn.default,menu:Rn.default,refresh:Pn.default,horizontalSplit:Fn.default,tv:On.default,unknown:Nn.default,link:Ln.default,linkOff:Mn.default,hide:zn.default,bold:Bn.default,italic:Hn.default,leftAlign:Un.default,centerAlign:Wn.default,bullet:Vn.default,addItems:qn.default,sideBySide:Yn.default,textType:Jn.default,textField:Xn.default,icon:Kn.default,arrowRight:Zn.default,image:tr.default,photoLibrary:nr.default,aspectRatio:rr.default,controlCamera:ar.default,settings:or.default,fullscreen:lr.default,fullscreenExit:ir.default,autoplay:dr.default,slideshow:ur.default,subtitles:cr.default},Ql=Wt.default.memo((function(e){var t=e.icon,n=e.styles,r=e.label,a=e.floatingMenu,o=Jl[t]||Jl.unknown;return a?Wt.default.createElement(er.default,{title:r||"","aria-label":t,placement:"bottom",arrow:!0},Wt.default.createElement(o,{style:n})):Wt.default.createElement(o,{style:n})})),Xl=function(e){var t=e.icon;return Wt.default.createElement(Ql,{icon:t,styles:{marginRight:"4px"}})},Kl=function(e){var t=e.icon,n=e.label;return Wt.default.createElement(Ql,{icon:t,styles:{fontSize:"inherit"},label:n,floatingMenu:!0})},Zl=function(e){var t=e.alertData,n=e.onSubmit,a=e.onCancel,l=e.currentEvent,i=t.fields,d=t.name,u=t.Component,s=to(i,{}),f=Object.entries(s).reduce((function(e,t){var n=r._slicedToArray(t,2),a=n[0],o=n[1].defaultValue;return o&&(e[a]=o),e}),{}),p=o.useState(r._objectSpread2(r._objectSpread2({},f),l.content)||{}),m=r._slicedToArray(p,2),v=m[0],g=m[1],h=no(s,{onFieldChange:function(e,t){g((function(n){return r._objectSpread2(r._objectSpread2({},n),{},r._defineProperty({},e,t))}))},fields:v});return Wt.default.createElement(Cr.default,{open:!0,style:{zIndex:1}},Wt.default.createElement("div",{style:{width:"50vw",maxHeight:"90%",resize:"horizontal",overflowX:"hidden",background:"#fff"},"data-qa":"alerts-modal"},Wt.default.createElement("div",{style:{position:"sticky",top:0,background:"#fff",zIndex:1}},Wt.default.createElement("h4",{style:{padding:"16px 24px",fontSize:16,marginTop:"16px"}},"Send Live Event: ",d),Wt.default.createElement(u,{customFields:v})),Wt.default.createElement(mn.default,null,c._toConsumableArray(Object.entries(h)).map((function(e){var t=r._slicedToArray(e,2),n=t[0],a=t[1],o=Ga(n);return"general"===n?Wt.default.createElement(Wt.default.Fragment,null,a):Wt.default.createElement(ao,{key:o,name:o},a)}))),Wt.default.createElement(Sr.default,{style:{margin:"0 24px 16px",position:"sticky",bottom:0,background:"#fff",zIndex:1}},Wt.default.createElement(Gt.default,{onClick:a,autoFocus:!0,className:"color-default",style:{textTransform:"none"}},"Close"),Wt.default.createElement(Gt.default,{className:"bg-primary",onClick:function(){return n(r._objectSpread2(r._objectSpread2({},l),{},{content:v}))},style:{textTransform:"none"}},"Publish"))))},$l=function(e){var t=e.alertsMap,n=xa(),a=o.useState(null),l=r._slicedToArray(a,2),i=l[0],d=l[1],u=(0,ya().useLiveEvents)(),c=function(e){return null===n||void 0===n?void 0:n.restClient.sendLiveEvent(e)};return Wt.default.createElement(Wt.default.Fragment,null,i&&Wt.default.createElement(Zl,{currentEvent:i,alertData:t[null===i||void 0===i?void 0:i.id],onSubmit:function(e){c(r._objectSpread2(r._objectSpread2({},i),e)),d(null)},onCancel:function(){return d(!1)}}),Wt.default.createElement("h3",{"data-qa":"alertsTitle",style:{fontWeight:400,margin:"16px 0 0 16px",fontSize:"1.1rem"}},"Live content"),Wt.default.createElement(yr.default,null,Object.entries(t).map((function(e){var t=r._slicedToArray(e,2),n=t[0],a=t[1],o=a.name,l=a.icon,i=u.find((function(e){return e.id===n})),s=!(null===i||void 0===i||!i.content);return o?Wt.default.createElement(Er.default,null,Wt.default.createElement(xr.default,null,Wt.default.createElement("div",{"data-qa":"alerts-item"},Wt.default.createElement("p",{style:{cursor:"pointer",display:"inline-flex",fontWeight:100}},Wt.default.createElement(Xl,{icon:l})," ",o),Wt.default.createElement("p",{style:{fontSize:14,display:"flex",marginLeft:30,marginTop:-6}},Wt.default.createElement("span",{onClick:function(){return d(i||{id:n})},style:{cursor:"pointer",color:"#196dfc"}},s?"Update":"Create"),Wt.default.createElement("span",{style:{marginLeft:8,cursor:s?"pointer":"default",color:s?"#196dfc":"#d4d4d4"},onClick:function(){c(r._objectSpread2(r._objectSpread2({},i),{},{id:n,content:null,url:null}))}},"Clear and Remove"))))):null}))))},ei=function(e,t){var n=e.stream,r=e.mimeType,a=t.log,o=t.isStopped,l=t.shouldStop;return new Promise((function(e,t){a.current=[];var i=console.log,d=console.warn,u=console.error,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info";return function(){for(var t="info"===e?i:"warn"===e?d:u,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];t.apply(void 0,r),a.current.push({logLevel:e,messages:r.map((function(e){return JSON.stringify(e)}))})}};console.log=c("info"),console.warn=c("warn"),console.error=c("error");var s=[];o.current=!1;var f=new MediaRecorder(n);f.ondataavailable=function(e){var t;(e.data.size>0&&s.push(e.data),!0===l.current&&!1===o.current)&&(n.getTracks().forEach((function(e){return e.stop()})),null===f||void 0===f||null===(t=f.stream)||void 0===t||t.getTracks().forEach((function(e){return e.stop()})),f.stop(),o.current=!0,console.log=i,console.warn=d,console.error=u)},f.onstop=function(){var t=new Blob(s,{type:r});s=[],e(t)},f.start(200)}))},ti=function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="video/webm",navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia){e.next=4;break}return window.alert("Screen Record not supported. Please use Chrome."),e.abrupt("return",Promise.resolve(null));case 4:return a=null,e.next=7,navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:{echoCancellation:!0}});case 7:return o=e.sent,t(!0),a=o,e.abrupt("return",ei({stream:a,mimeType:r},n));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ni={position:"absolute",left:0,top:"50px",background:"whitesmoke",padding:"12px",boxShadow:"0px 6px 4px -5px rgba(0,0,0,0.2), 0px 6px 5px 0px rgba(0,0,0,0.14)"},ri=vn.default((function(e){var t;return{root:(t={minWidth:0,minHeight:0,maxWidth:"38px",maxHeight:"38px",padding:"8px",fontSize:"20px",boxSizing:"border-box",margin:"2px 1px 1px 1px"},r._defineProperty(t,"minWidth",0),r._defineProperty(t,"transition",e.transitions.create("background",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})),r._defineProperty(t,"&:hover",{background:"#c1c1c1"}),t),selected:{background:"#c1c1c1"},disabled:{color:"#c1c1c1",cursor:"not-allowed"},noPointerEvents:{pointerEvents:"none",padding:"4px"}}})),ai=vn.default((function(){return{root:{height:"32px",margin:"0 8px 0 0",top:"2px","&:before":{border:"none !important"},"&:after":{border:"none !important"}},paddingLeft:{"& .MuiSelect-selectMenu":{paddingLeft:"32px"}},altRoot:{fontSize:"16px",fontWeight:200,"& svg":{display:"none"},"& > .MuiSelect-select":{padding:"4px"},"&:before":{display:"none"},"&:after":{display:"none"}}}})),oi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=r._objectSpread2({},e);return t.forEach((function(e){var t=r._slicedToArray(e,2),a=t[0],o=t[1];a&&(n=r._objectSpread2(r._objectSpread2({},n),o))})),n},li={width:"200px",textAlign:"center",letterSpacing:".04em",boxSizing:"border-box",height:"53px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,cursor:"pointer",borderBottomWidth:"3px",borderBottomStyle:"solid"},ii=function(e){var t=e.show,n=e.className;return t?Wt.default.createElement("div",{"data-qa":"doc-status-dot",className:n,style:{width:8,height:8,borderRadius:"50%",position:"absolute",top:"8px",left:"-16px"}}):null},di=function(e){var t=e.isActive,n=e.colorClass,a=e.handleClickTab,o=e.showDot,l=e.tabText,i=e.mode,d=t?"color-".concat(n," bc-").concat(n):"color-default",u=El(),c=r._slicedToArray(u,2),s=c[0],f=c[1],p=al(i),m=rl(),v=r._slicedToArray(m,1)[0],g=Object.keys(v).find((function(e){var t;return"Akamai"===(null===v||void 0===v||null===(t=v[e])||void 0===t?void 0:t.type)})),h=v&&g?v[g]:{},b=h.variant1Key,y=void 0===b?"":b,E=h.variant2Key,x=void 0===E?"":E,C=ai();return Wt.default.createElement("div",{style:oi(li,[[t,{opacity:1}],[!t,{borderColor:"transparent",opacity:.75}]]),className:d,onClick:a},Wt.default.createElement("span",{style:{position:"relative",display:"flex",alignItems:"center"}},Wt.default.createElement(ii,{show:o,className:"bg-".concat(n)}),l,p&&Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Zt.default,{className:"".concat(C.altRoot," hover-underline ").concat(t?"color-".concat(n):""),value:s?"variant":"control",onChange:function(e){f("control"===e.target.value?null:p)}},Wt.default.createElement(Kt.default,{value:"control"},"(A)"),Wt.default.createElement(Kt.default,{value:"variant"},"(B)"))),"remote"===i&&Wt.default.createElement(Ar.default,{fontSize:"inherit",style:{paddingLeft:4},onClick:function(){var e=new URL(window.location.href);window.open("".concat(e.origin).concat(e.pathname.replace("/admin/document","/render")).concat(p&&s?"?variant=".concat(x):y?"?variant=".concat(y):""),"_blank")}})))},ui=a.makeStyles({root:{padding:"0 9px 0 0",alignItems:"start","&:hover":{backgroundColor:"transparent"},"&.MuiCheckbox-colorSecondary":{color:"transparent",backgroundColor:"transparent","&:hover":{color:"transparent",backgroundColor:"transparent"}}},icon:{width:12,height:12,border:"1px solid ".concat("#d4d4d4"),borderRadius:3},checkedIcon:{background:"#196dfc",color:"#FFF",strokeWidth:3}}),ci=function(e){var t=ui();return Wt.default.createElement(an.default,b._extends({},e,{className:t.root,checkedIcon:Wt.default.createElement(br.default,{className:"".concat(t.icon," ").concat(t.checkedIcon)}),icon:Wt.default.createElement("span",{className:t.icon})}))},si=function(e){var t,n=e.type,a=e.position,o=e.onSelect,l=e.onDragStart,i=e.onDragEnd,d=e.draggable,u=e.toolbar,c=e.forkFeature,s=e.menus,f=e.openMobileCard,p=e.setOpenMobileCard,m=e.entityId,v=e.entitySize,g=e.backgroundColor,h=Wt.default.useContext(Ho).isParent,b=Wt.default.useState(null),y=r._slicedToArray(b,2),E=y[0],x=y[1],C=function(){x(null)},S={display:"inline-flex",justifyContent:"center",alignItems:"center",width:"30px",height:"30px",cursor:"pointer",fontWeight:"bold",color:"white"},I={color:"#FFF",fontSize:"14px",padding:"2px 4px",margin:"0 4px",border:"1px solid #fff",borderRadius:"2px"},k="chain"===n,_=k?"bg-black":"bg-primary";return g&&(_=/^bg-/.test(g)?g:"bg-".concat(g)),Wt.default.createElement("div",{"data-qa":"overlay-bar",className:_,style:(t={position:"absolute",padding:"2px 4px",top:k?-31:-34},r._defineProperty(t,"left"===a?"left":"right",-1),r._defineProperty(t,"zIndex",k?5:8),r._defineProperty(t,"fontSize","18px"),t)},Wt.default.createElement("div",{style:{textAlign:"right",display:"flex",alignItems:"center"}},"number"===typeof v&&Wt.default.createElement("span",{style:I},v||0," kb"),o&&h?Wt.default.createElement("a",{onClick:o,style:S,"data-qa":"overlay-edit-btn"},Wt.default.createElement(Pr.default,{titleAccess:"Edit feature",fontSize:"inherit",style:{fill:"#fff"}})):null,u&&Wt.default.createElement(Wt.default.Fragment,null,u.map((function(e){var t=null;return"button"===e.type?t=Wt.default.createElement(Wt.default.Fragment,{key:e.title},Wt.default.createElement("a",{"data-qa":e.dataQa,title:e.title,onClick:e.onClick,style:S},e.icon)):"msg"===e.type&&(t=Wt.default.createElement(Wt.default.Fragment,{key:e.title},Wt.default.createElement("span",{"data-qa":e.dataQa,style:I},e.title))),t}))),c?Wt.default.createElement("a",{onClick:c,style:S,"data-qa":"overlay-fork-btn"},Wt.default.createElement(Lr.default,{titleAccess:"Fork feature",fontSize:"inherit",style:{fill:"#fff"}})):null,l&&d&&Wt.default.createElement("a",{"data-qa":"overlay-drag-btn",onDragStart:l,onDragEnd:i,draggable:"true",style:r._objectSpread2(r._objectSpread2({},S),{},{cursor:"grab"})},Wt.default.createElement(Nr.default,{titleAccess:"Drag to move",fontSize:"inherit",style:{fill:"#fff"}})),s&&Wt.default.createElement(Wt.default.Fragment,null,s.map((function(e){var t=E&&E.id===e.name;return Wt.default.createElement(Wt.default.Fragment,{key:e.name},Wt.default.createElement("a",{"data-qa":"overlay-menu-btn",onClick:function(t){return x({id:e.name,anchor:t.currentTarget})},style:S},e.icon),t&&Wt.default.createElement(Fr.default,{onClose:C,anchorEl:E.anchor,open:Boolean(E)},(null===e||void 0===e?void 0:e.component)&&Wt.default.createElement(e.component,{onClose:C,items:e.items}),!(null!==e&&void 0!==e&&e.component)&&e.items&&e.items.map((function(e){return Wt.default.createElement(Kt.default,{"data-qa":e.dataQa,key:e.label,onClick:(t=e.callback,function(){t(),C()})},e.label);var t}))))}))),!k&&f===m&&Wt.default.createElement("a",{"data-qa":"overlay-exit-btn",onClick:function(){return p("")},style:r._objectSpread2(r._objectSpread2({},S),{},{backgroundColor:"#e9e9e9",margin:"-2px -4px 0 0",padding:"0 2px 4px"})},Wt.default.createElement(ir.default,{titleAccess:"Open mobile card",fontSize:"18px",style:{fill:"#000",position:"relative",top:"2px"}}))))},fi=function(e){var t=e.position,n=(0,e.addFeature)(t),a={top:{top:-10,left:"calc(50% - 10px)"},bottom:{bottom:-10,left:"calc(50% - 10px)"}}[t];return Wt.default.createElement(Or.default,{"data-qa":"add-feature-circle-btn",onClick:n,className:"color-primary",style:r._objectSpread2(r._objectSpread2({},a),{},{position:"absolute",cursor:"pointer",background:"#fff",borderRadius:"50%",zIndex:9})})},pi=function(e){var t=e.rowSpan,n=e.handleChangeRowspan,a=e.displayName,o=e.canChangeRowspan,l=function(e){return{href:"#",className:"bg-primary",onClick:function(r){r.preventDefault();var a=e?t+1:t-1;n&&n(Math.max(1,Math.min(Number(a),20)))},style:{borderRadius:"50%",color:"#fff",background:o?"#196dfc":"#3a3a3a",margin:"0 4px 0 ".concat(e?"4px":"12px"),height:"16px"}}};return Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},mi([0,0,0,0])),{},{background:o?"#f1f6ff":"#d4d4d4",opacity:.9,zIndex:3,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",cursor:"move",boxSizing:"border-box"})},Wt.default.createElement("span",null,a),Wt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},n&&Wt.default.createElement(Wt.default.Fragment,null,"Row Span:"," ",Wt.default.createElement("a",l(!1),Wt.default.createElement(Mr.default,{fontSize:"inherit"})),Wt.default.createElement(nn.default,null,Wt.default.createElement(Zt.default,{value:t,onChange:function(e){return n&&n(Number(e.target.value))}},Array(19).fill("").map((function(e,t){return Wt.default.createElement(Kt.default,{key:"".concat(e,"-").concat(t),value:t+1},t+1)})))),Wt.default.createElement("a",l(!0),Wt.default.createElement(mr.default,{fontSize:"inherit"})))),!o&&Wt.default.createElement("span",{style:{fontSize:12,marginTop:"4px"}},"*Row span has no effect on this feature"))},mi=function(e){var t=r._slicedToArray(e,4),n=t[0],a=t[1],o=t[2],l=t[3],i={position:"absolute"};return"undefined"!==typeof n&&(i.top=n),"undefined"!==typeof a&&(i.right=a),"undefined"!==typeof o&&(i.bottom=o),"undefined"!==typeof l&&(i.left=l),i},vi=function(e){var t=e.type,n=e.handleChangeRowspan,a=e.showMenu,o=e.borderColor,i=e.showOutline,d=e.rowSpan,u=e.overlayBar,c=e.displayName,s=e.canChangeRowspan,f=e.addFeature,p=l.useRecoilValue(vl),m="chain"===t?"black":"primary";return o&&(m=o),Wt.default.createElement(Wt.default.Fragment,null,i?Wt.default.createElement("div",{className:"b bc-".concat(m),style:r._objectSpread2(r._objectSpread2({},mi(["-8px","-8px","-8px","-8px"])),{},{top:"chain"===t?"-48px":"-8px"})},a&&Wt.default.createElement(Wt.default.Fragment,null,f&&Wt.default.createElement(fi,{position:"top",addFeature:f}),f&&Wt.default.createElement(fi,{position:"bottom",addFeature:f}),Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},mi("feature"===t?[0,0,void 0,0]:[-3,0,void 0,0])),{},{height:20,zIndex:"feature"===t?8:5})},u))):null,p&&d?Wt.default.createElement(pi,{handleChangeRowspan:n,rowSpan:d,canChangeRowspan:!!s,displayName:c}):null)},gi=function(e){p._inherits(n,e);var t=p._createSuper(n);function n(e){var r;return p._classCallCheck(this,n),(r=t.call(this,e)).state={error:null},r}return p._createClass(n,[{key:"componentDidCatch",value:function(e){console.log("ERROR",e),this.setState({error:e})}},{key:"render",value:function(){return this.state.error?Wt.default.createElement("div",null,"error in this component ",this.state.error.message):this.props.children}}]),n}(Wt.default.Component);ft.enablePatches();var hi=function(e){var t,n,r={padding:"8px 8px"},a={padding:"8px 8px",display:"block"},o={minWidth:"250px",maxWidth:"100%"},l={whiteSpace:"normal"},i=e.onClose,d=e.entity,u=e.presetOptions,c=e.setEntity,s={props:{customFields:{}}},f=yi(s,u.mobile),p=yi(s,u.presets),m=yi(s,u.mini),v={mobile:f,presets:p,mini:m},g=function(e){return function(t){var n,r=t.target.value;n=ft.applyPatches(JSON.parse(JSON.stringify(d)),v[e].find((function(e){return e.label===r})).patches),c((function(t){var a;null!==t&&void 0!==t&&null!==(a=t.props)&&void 0!==a&&a.customFields||(t.props.customFields={}),Object.keys(n.props.customFields).map((function(e){t.props.customFields[e]=n.props.customFields[e]})),"presets"===e?(t.props.customFields.lastPickedPreset=r,t.props.customFields.lastPickedMiniPreset=""):"mini"===e&&(t.props.customFields.lastPickedMiniPreset=r)}))}};return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(nn.default,{style:a},Wt.default.createElement(Hr.default,{style:r},"Preset:"),Wt.default.createElement(Zt.default,{style:o,onChange:g("presets"),value:null===(t=d.props.customFields)||void 0===t?void 0:t.lastPickedPreset},p&&p.map((function(e){return e.type="preset",Wt.default.createElement(Kt.default,{key:e.label,value:e.label,style:l},e.label)})))),Wt.default.createElement(nn.default,{style:a},Wt.default.createElement(Hr.default,{style:r},"Mini Preset:"),Wt.default.createElement(Zt.default,{style:o,onChange:g("mini"),value:null===(n=d.props.customFields)||void 0===n?void 0:n.lastPickedMiniPreset},m&&m.map((function(e){return e.type="mini",Wt.default.createElement(Kt.default,{key:e.label,value:e.label,style:l},e.label)})))),Wt.default.createElement(nn.default,{style:a},Wt.default.createElement(Hr.default,{style:r},"Mobile Preset:"),Wt.default.createElement(Zt.default,{style:o,onChange:g("mobile"),value:d.props.customFields.mobilePreset},f&&f.map((function(e){return e.type="mobile",Wt.default.createElement(Kt.default,{key:e.label,value:e.label,style:l},e.label)})))),Wt.default.createElement(Ur.default,{style:{justifyContent:"center"}},Wt.default.createElement(Gt.default,{variant:"contained",onClick:function(){i&&i()},className:"bg-primary",style:{textTransform:"none",color:"#fff",background:"#196dfc"}},"Close")))},bi=function(e,t){var n=r._slicedToArray(t,3);return{label:e,patches:n[1],inversePatches:n[2]}};function yi(e,t){return t.map((function(t){return"string"===typeof t?bi(t,ft.produceWithPatches(e,(function(e){e.props.customFields=r._objectSpread2(r._objectSpread2({},e.props.customFields),{mobilePreset:t})}))):bi(t.name,ft.produceWithPatches(e,(function(e){e.props.customFields=r._objectSpread2(r._objectSpread2({},e.props.customFields),t.values)})))}))}var Ei=["table1LeftIds","table2LeftIds","table1MainIds","table2MainIds","table1RightIds","table2RightIds","table9LeftIds","table9MainIds","table9RightIds","table3MainIds","table3LeftIds","table3RightIds"];var xi=function(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom},Ci=function(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom-t.height/2},Si=vn.default({root:{"& .Mui-focused":{color:"#196dfc"},"& .MuiInput-underline:after":{borderColor:"#196dfc"}}}),Ii={confirm:{style:{textTransform:"none",color:"#fff",margin:"0 4px"},className:"bg-primary"},cancel:{style:{textTransform:"none",color:"#fff",margin:"0 4px"},className:"bg-default"},close:{style:{textTransform:"none",background:"transparent",margin:"0 4px"},className:"color-default"}},ki=function(e){var t=e.open,n=e.close,a=e.text,o=e.secondaryText,l=e.actions,i=Si();return Wt.default.createElement(pn.default,{open:t,onClose:l.close.handler,className:i.root,"aria-labelledby":"form-dialog-title"},Wt.default.createElement("div",{style:{width:"500px"}},Wt.default.createElement(gn.default,{id:"form-dialog-title"},a),o,Wt.default.createElement("div",{style:{padding:"16px",float:"right"}},Object.keys(l).map((function(e){var t,a=l[e],o=a.text,i=a.handler,d=a.styles;return Wt.default.createElement(Gt.default,{key:o,onClick:(t=i,function(e){setTimeout((function(){return t(e)}),0),n()}),className:Ii[e].className,style:r._objectSpread2(r._objectSpread2({textTransform:"none",color:"#3a3a3a"},Ii[e].style||{}),d)},o)})))))},_i=function(e){var t=e.children,n=o.useState(null),a=r._slicedToArray(n,2),l=a[0],i=a[1];return Wt.default.createElement(Xo.Provider,{value:{setDialogProps:function(e){i(e)}}},t,l&&Wt.default.createElement(ki,b._extends({open:Boolean(l.text)&&Boolean(l.actions.close),close:function(){return i(null)}},l)))},Ai=function(e){var t=e.open,n=e.setOpenDialog,a=e.onSelectDocument,l=e.repo,i=o.useState(""),d=r._slicedToArray(i,2),u=d[0],s=d[1],f=o.useState(""),p=r._slicedToArray(f,2),m=p[0],v=p[1],g=Si(),h=function(){n(!1)},b=function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.addDocument({name:u,slug:m}),l.once("doc:add",(function(e){a(e.slug),h()}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Wt.default.createElement(pn.default,{open:t,onClose:h,className:g.root,"aria-labelledby":"form-dialog-title"},Wt.default.createElement("div",{style:{width:"400px"}},Wt.default.createElement(gn.default,{id:"form-dialog-title"},"Add New Document"),Wt.default.createElement(mn.default,null,Wt.default.createElement(rn.default,{autoFocus:!0,margin:"dense",id:"new-document-name",label:"Document Name (e.g. Homepage)",type:"string",fullWidth:!0,onChange:function(e){return s(e.target.value)},onBlur:function(){return v(u.toLowerCase().replace(/\s/g,"-"))}}),Wt.default.createElement(rn.default,{autoFocus:!0,margin:"dense",id:"new-document-slug",label:"Document Slug (e.g. homepage)",type:"string",fullWidth:!0,key:m,defaultValue:m,onChange:function(e){return v(e.target.value)},style:{margin:"20px 0"}})),Wt.default.createElement("div",{style:{padding:"16px",float:"right"}},Wt.default.createElement(Gt.default,{onClick:h,style:{textTransform:"none",color:"#3a3a3a"}},"Cancel"),Wt.default.createElement(Gt.default,{onClick:b,disabled:""===u.trim(),style:{textTransform:"none",color:"#fff"},className:"bg-primary"},"Add Document"))))};ft.enablePatches();var Ti=function(e){var t=e.getDragEntity,n=e.allowedTypes,r=e.entityId,a=e.ref,o=e.classNames,l=void 0===o?[]:o,i=e.callback;return function(e){var o;e.preventDefault();var d=t()||{},u=d.entity,s=d.id,f=n.includes(u.type);null!==a&&void 0!==a&&a.current&&f&&s!==r&&(e.stopPropagation(),(o=a.current.classList).add.apply(o,["dragging"].concat(c._toConsumableArray(l))),i&&i())}},wi=function(e){return function(t){if(t.preventDefault(),t.stopPropagation(),null!==e&&void 0!==e&&e.current&&e.current.classList.contains("dragging")){var n=Ci({x:t.clientX,y:t.clientY},e.current.getBoundingClientRect())?"dragging-top":"dragging-bottom";e.current.classList.contains(n)||(e.current.classList.remove("dragging-top","dragging-bottom"),e.current.classList.add(n))}}},Di=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return function(r){if(r.preventDefault(),r.stopPropagation(),null!==e&&void 0!==e&&e.current){var a,o={x:r.clientX,y:r.clientY};if(e.current.classList.contains("dragging")&&!xi(o,e.current.getBoundingClientRect()))(a=e.current.classList).remove.apply(a,["dragging","dragging-top","dragging-bottom"].concat(c._toConsumableArray(t))),n&&n()}}},ji=function(e,t){return{text:"Remove locked item(s) from clipboard after drag?",actions:{close:{text:"Cancel",handler:function(){},styles:Ii.close},confirm:{text:"Remove",handler:function(){e(),t()},styles:Ii.close},cancel:{text:"Keep",handler:function(){e()},styles:Ii.close}}}},Ri=function(e){var t,n,a=e.children,o=e.showMenu,l=e.showPresets,i=e.value,d=e.hoverable,u=e.selectable,c=e.draggable,s=e.parentId;e.chain;var f=e.canChangeRowSpan,p=e.suppressWarning,m=e.docId,v=e.mode,h=qo(),y=r._slicedToArray(h,2),E=y[0],x=y[1],C=Wl(),S=Rl(m,v),I=wl(i,m,v),k=r._slicedToArray(I,3),_=k[0],A=k[1],T=k[2],w=g.objectToId(_),D=Wt.default.useRef(),j=Wt.default.useContext(Wo)||Uo,R=j.getDragEntity,P=j.setDragEntity,F=j.handleDragStart,N=j.handleDragEnd,O=Ko().setDialogProps,L=b.useComponent(_.type).siblingFeatures,M=void 0===L?[]:L,z=b.useComponent("fronts/flex-feature"),B=z.siblingFeatures,H=void 0===B?[]:B,U=z.fields,W=ho(U),G=Wt.default.useContext(Ho).presetOptions,V=b.useComponentFields("fronts/flex-feature"),q=b.useComponentName("fronts/flex-feature"),Y=El(),J=r._slicedToArray(Y,1)[0],Q=Dl({id:s},m,v),X=b.useSpartanChain(),K=X.openMobileCard,Z=X.setOpenMobileCard,$=X.showMobileCard,ee=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=vo(_,!0);e&&(t.forkedOn=(new Date).getTime()),S({docId:m,mode:v},{type:g.ActionTypes.DUPLICATE_ENTITY,featureIds:[w],names:[mo(_)]},To({parentId:s,entity:t,siblingId:w,relativePosition:"bottom",tidyEntity:W}))},te=function(e){s&&S({docId:m,mode:v},{type:e?g.ActionTypes.CUT_TO_CLIPBOARD:g.ActionTypes.DELETE_ENTITY,featureIds:[w],names:[mo(_)]},(function(e,t){return e=po({entity:_,parentId:s})(e,t),e=xo({parentId:s,entity:_})(e,t)}))},ne=J?function(){O({text:"Fork this feature?",secondaryText:Wt.default.createElement("p",{className:"ml-md mr-md"},"Are you sure you want to unlink this feature from the parent page? If so, any future changes will not be inherited."),actions:{close:{text:"Cancel",handler:function(){}},confirm:{text:"Confirm",handler:function(){ee(!0),te(!1)}}}})}:void 0,re=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(s){var n=((null===Q||void 0===Q?void 0:Q.children)||[]).find((function(e){return e.id===w}));if(J||!Object.keys((null===_||void 0===_||null===(e=_.props)||void 0===e?void 0:e.variants)||{}).length&&!n)te(t);else{var r=n?"This feature's parent":"This feature";O({text:"".concat(t?"Cut":"Delete"," feature and variant?"),secondaryText:Wt.default.createElement("p",{className:"ml-md"},"".concat(r," may contain variant props necessary for an active A/B test. ").concat(t?"Cutting this to clipboard":"Deleting this feature"," will also remove it in the variant. Proceed?")),actions:{confirm:{text:"Confrim",handler:function(){return te(t)}},close:{text:"Cancel",handler:function(){}}}})}}},ae=o?[{label:"Cut to clipboard",callback:function(){E(vo(_,!0)),re(!0)},dataQa:"cb-cut-btn"},{label:"Copy to clipboard",callback:function(){return E(vo(_,!0))},dataQa:"cb-copy-btn"},{label:"Duplicate",callback:ee,dataQa:"duplicate-btn"},{label:"Remove",callback:re,dataQa:"remove-btn"},{label:"Debug",callback:function(){console.log("ENTITY --- ",JSON.parse(JSON.stringify(_))),console.log("PARENT ID --- ",s)},dataQa:"debug-btn"}]:[],oe=[];o&&oe.push({name:"Menu",icon:Wt.default.createElement(zr.default,{titleAccess:"Menu",fontSize:"inherit",style:{fill:"#fff"}}),items:ae||[]}),l&&oe.push({name:"Preset Menu",icon:Wt.default.createElement(Br.default,{titleAccess:"Presets",fontSize:"inherit",style:{fill:"#fff"}}),component:function(e){return Wt.default.createElement(hi,b._extends({},e,{entity:_,presetOptions:G,setEntity:A}))},presets:{mini:null,preset:null,mobile:null},items:[]});var le=Vl(),ie=Il(_),de=r._slicedToArray(ie,2),ue=de[0],ce=de[1],se=_l(),fe=r._slicedToArray(se,2),pe=fe[0],me=fe[1],ve=(null===pe||void 0===pe?void 0:pe.entityId)===w,ge=ue.hovered,he=null===_||void 0===_||null===(t=_.props)||void 0===t||null===(n=t.customFields)||void 0===n?void 0:n.rowSpan,be=Object.keys(b.useComponentFields(null===_||void 0===_?void 0:_.type)||{}).length&&u?function(e){e.stopPropagation(),me({entityId:w,docId:m,mode:v}),le(Cl(!0))}:null,ye=ge?"relative":null,Ee=r._objectSpread2(r._objectSpread2({},ue),{},{ChainColumnDropTarget:function(){return null},styles:r._objectSpread2(r._objectSpread2({},{transition:"all .25s",boxSizing:"border-box"}),{},{position:ye}),OverlayBar:si,overlay:u||d||c?Wt.default.createElement(vi,{showOutline:ge||ve,showMenu:ge||!o&&!!l&&!!ve,rowSpan:he,canChangeRowspan:f,handleChangeRowspan:function(e){return A((function(t){var n;null!==t&&void 0!==t&&null!==(n=t.props)&&void 0!==n&&n.customFields?t.props.customFields.rowSpan=e:t.props&&(t.props.customFields={rowSpan:he})}))},type:"feature",overlayBar:Wt.default.createElement(si,{menus:oe,type:"feature",onSelect:be,onDragEnd:N,onDragStart:F({id:w,entity:r._objectSpread2(r._objectSpread2({},_),{},{parentId:s,isClipboardItem:!1})},null===D||void 0===D?void 0:D.current),forkFeature:ne,entitySize:T,draggable:c,openMobileCard:K,setOpenMobileCard:Z,entityId:w}),addFeature:u&&function(e){return function(){var t=wo(V,"fronts/flex-feature",q),n=To({entity:t,parentId:s,siblingId:w,relativePosition:e,tidyEntity:W});S({docId:m,mode:v},{type:g.ActionTypes.ADD_ENTITY,featureIds:[g.objectToId(t)],names:[mo(t)]},n)}},displayName:mo(_)}):null}),xe={onMouseEnter:function(){d&&ce((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!0})}))},onMouseLeave:function(){d&&ce((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!1})}))},onDragEnter:Ti({getDragEntity:R,allowedTypes:M,entityId:w,ref:D}),onDragOver:wi(D),onDragLeave:Di(D),onDrop:function(e){if(e.preventDefault(),e.stopPropagation(),null!==D&&void 0!==D&&D.current){D.current.classList.remove("dragging","dragging-top","dragging-bottom");var t=R()||{},n=t.id,r=t.entity;if(r&&n&&M.includes(r.type)&&n!==w){var a=Ci({x:e.clientX,y:e.clientY},D.current.getBoundingClientRect())?"top":"bottom";if(r.isClipboardItem&&r.parentId!==s){var o=C(r);delete o.isClipboardItem,delete o.clonedBy;var l=function(){S({docId:m,mode:v},{type:g.ActionTypes.DRAG_FROM_CLIPBOARD,featureIds:[n],names:[mo(o)]},To({entity:o,parentId:s,siblingId:w,relativePosition:a,tidyEntity:W}))},i=function(){return x(r)};r.locked?(console.log("dragEntity id",g.objectToId(o)),O(ji(l,i))):(l(),i())}else"undefined"!==typeof window&&window.innerWidth<=768&&(H||[]).includes(r.type)?S({docId:m,mode:v},{type:g.ActionTypes.MOBILE_REORDER,featureIds:[n],names:[mo(r)]},function e(t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=t.id,o=t.siblingId,l=t.parentId,i=t.relativePosition,d=void 0===i?"before":i;Xt.default(!!o,"You must pass a siblingId to shiftFeature");var u=uo(n[l||"root"],r);Xt.default(null===u||void 0===u?void 0:u.children,"you are trying to swap a feature index but the parent does not have children");var c=ja.find((function(e){var t,n,r;return null===(t=u.props)||void 0===t||null===(n=t.customFields)||void 0===n||null===(r=n[Ra(e)])||void 0===r?void 0:r.find((function(e){return a===e}))})),s=ja.find((function(e){var t,n,r;return null===(t=u.props)||void 0===t||null===(n=t.customFields)||void 0===n||null===(r=n[Ra(e)])||void 0===r?void 0:r.find((function(e){return o===e}))}));if(!((null===s||void 0===s?void 0:s.substring(0,6))===(null===c||void 0===c?void 0:c.substring(0,6))))return Jt.default.error("Features can't be reordered outside of their desktop assigned tables. Turn on Helpers to see the tables' boundaries.","",{positionClass:"toast-mobile-error",showDuration:300,hideDuration:5e3,debug:!0}),n;var f=((null===u||void 0===u?void 0:u.children)||[]).findIndex((function(e){return g.objectToId(e)===o})),p=((null===u||void 0===u?void 0:u.children)||[]).findIndex((function(e){return g.objectToId(e)===a})),m=null===u||void 0===u?void 0:u.children[p],v="number"===typeof f;Xt.default(v,"sibling (target index) not found.  \n      shiftFeature() must receive a siblingId and \n      the sibling must exist in the parent renderable (usually a chain)\n       \n        ".concat(v,"\n\n        sourceIndex: ").concat(p,"\n        siblingIndex: ").concat(f,"\n        \n        id: ").concat(a,"\n        siblingId: ").concat(o,"\n        children: ").concat(u.children.length,"\n      \n      ")),Xt.default("number"===typeof p,'source index not found.  shiftFeature must receive an "id" \n      and the entity with that id must exist \n      in the parent renderable (usually a chain)\n\n        sourceIndex: '.concat(p,"\n        siblingIndex: ").concat(f,"\n\n        id: ").concat(a,"\n        siblingId: ").concat(o,"\n        children: ").concat(u.children.length,"\n      "));var h="before"===d?f:f+1;u.children.splice(p,1);var b={id:g.objectToId(m)};return console.log("rel position",d),console.log("source index",p),console.log("insert index",h),console.log("insertItem",b),h>-1&&u.children.splice(h,0,b),Pa(u),co(u)&&so(n,e(t)),n}}({parentId:s,siblingId:w,id:n,relativePosition:"top"===a?"before":"after"})):S({docId:m,mode:v},{type:g.ActionTypes.DRAG_AND_DROP_ENTITY,featureIds:[n],names:[mo(r)]},So({id:n,prevParentId:r.parentId,currentParentId:s,siblingId:w,relativePosition:a,isFlexFeatureSibling:(H||[]).includes(r.type)}));P(void 0)}}},onClick:function(e){return e.preventDefault()}};return Wt.default.createElement(b.FeatureContext.Provider,{value:{change:A,props:_.props,interactions:xe,selectors:Ee,selectEntity:be,suppressWarning:p,dataAttrs:{id:w},ref:D,openMobileCard:K,setOpenMobileCard:Z,showMobileCard:$}},a)},Pi=function(e){var t=e.children,n=b.useSpartanFeature(),a=n.selectors,o=a.styles,l=a.overlay,i=n.interactions,d=n.dataAttrs,u=n.ref;return Wt.default.createElement("div",b._extends({},d,{style:r._objectSpread2(r._objectSpread2({},o),{},{position:"relative"})},i,{ref:u}),l,t)},Fi=function(e){var t,n=e.parentId,a=e.props,o=e.context,i=e.setChain,d=e.chain,u=e.canChangeRowSpan,c=e.suppressWarning,s=e.docId,f=e.mode,p=wl(a,s,f),m=r._slicedToArray(p,1)[0],v=b.useComponent(null===(t=m.props)||void 0===t?void 0:t.type),g=v.Component,h=v.isGridItem,y=l.useRecoilValue(vl);return Wt.default.createElement(Ri,b._extends({resizing:y,canChangeRowSpan:u,showMenu:!0,showPresets:!0},a.settings,{parentId:n,chain:d,setChain:i,value:r._objectSpread2({},m),docId:s,mode:f,suppressWarning:Boolean(c)}),Wt.default.createElement(b.ComponentProvider,{value:m.props||m},Wt.default.createElement(gi,null,Wt.default.createElement(Wt.default.Fragment,null,h?Wt.default.createElement(g,b._extends({},m.props,{context:r._objectSpread2(r._objectSpread2({},o),{},{isAdmin:!0})})):Wt.default.createElement(Pi,null,Wt.default.createElement(g,b._extends({},m.props,{context:r._objectSpread2(r._objectSpread2({},o),{},{isAdmin:!0})})))))))},Ni=function(e){var t,n=e.colId,a=e.isEmpty,l=e.style,i=void 0===l?{}:l,d=b.useSpartanChain(),u=d.props,c=d.setFeaturesInChains,s=d.ref,f=Wt.default.useRef(r._objectSpread2({position:"absolute",left:0,right:0,top:0,height:"auto"},i)),p=o.useContext(Xo).setDialogProps,m=b.useComponentFields("fronts/flex-feature"),v=ho(m),h=sl(),y=ya().mode,E=Rl(),x=b.useComponentChildFeatures("top-table")||[],C=(b.useComponent("fronts/flex-feature")||[]).siblingFeatures,S=qo(),I=r._slicedToArray(S,2)[1],k=Wt.default.useRef(),_=Wt.default.useContext(Wo)||Uo,A=_.getDragEntity,T=_.setDragEntity,w={onDragEnter:Ti({getDragEntity:A,allowedTypes:x,entityId:null,ref:k,classNames:["dragging-center"],callback:function(){var e,t,n;k&&(null===k||void 0===k||null===(e=k.current)||void 0===e||null===(t=e.closest(".chain"))||void 0===t||null===(n=t.classList)||void 0===n||n.add("overflow-hidden"))}}),onDragLeave:Di(k,["dragging-center"],(function(){var e,t,n;k&&(null===k||void 0===k||null===(e=k.current)||void 0===e||null===(t=e.closest(".chain"))||void 0===t||null===(n=t.classList)||void 0===n||n.remove("overflow-hidden"))})),onDrop:function(e){var t,a,o;e.preventDefault(),e.stopPropagation();var l=A()||{},i=l.id,d=l.entity;if(null!==k&&void 0!==k&&k.current&&i&&d){if(k.current.classList.remove("dragging","dragging-center"),document&&(null===(t=document)||void 0===t||null===(a=t.querySelector(".chain.overflow-hidden"))||void 0===a||null===(o=a.classList)||void 0===o||o.remove("overflow-hidden")),d.isClipboardItem&&x.includes(d.type)){var s=vo(d);delete s.isClipboardItem,delete s.clonedBy;var f=function(){return E({docId:h,mode:y},{type:g.ActionTypes.DRAG_FROM_CLIPBOARD,featureIds:[i],names:[mo(d)]},To({entity:s,parentId:g.objectToId(u),insertColumn:n,relativePosition:"bottom",tidyEntity:v}))},m=function(){return I(d)};d.locked?p(ji(f,m)):(f(),m())}else c&&c(r._objectSpread2(r._objectSpread2({},d),{},{id:i,currentParentId:g.objectToId(u),relativePosition:"bottom",siblingId:void 0,prevParentId:d.parentId,colId:n,isFlexFeatureSibling:(C||[]).includes(d.type)}));T(void 0)}}};return o.useEffect((function(){var e;f.current=r._objectSpread2(r._objectSpread2({},f.current),{},{height:null===s||void 0===s||null===(e=s.current)||void 0===e?void 0:e.clientHeight})}),[null===s||void 0===s||null===(t=s.current)||void 0===t?void 0:t.clientHeight]),Wt.default.createElement("div",b._extends({ref:k,style:f.current},w),a&&"Drop Here")},Oi=function(e){var t,n,a=e.value,i=e.selectable,d=e.hoverable,u=e.children,c=e.parentId,s=e.removeSelf,f=e.docId,p=e.mode,m=wl(a,f,p),v=r._slicedToArray(m,3),h=v[0],y=v[1],E=v[2],x=g.objectToId(h),C=o.useContext(Xo).setDialogProps,S=Vo(),I=r._slicedToArray(S,3),k=I[1],_=I[2],A=Rl(f,p),T=Wl(),w=Wl(!1),D=Vl(),j=Il(h),R=r._slicedToArray(j,2),P=R[0],F=R[1],N=jl(h,f,p),O=Wt.default.useRef(),L=b.useComponentFields("fronts/flex-feature"),M=ho(L),z=Wt.default.useContext(Wo)||Uo,B=z.handleDragStart,H=z.handleDragEnd,U=z.getDragEntity,W=z.setDragEntity,G=_l(),V=r._slicedToArray(G,2),q=V[0],Y=V[1],J=l.useRecoilState(ml),Q=r._slicedToArray(J,1)[0],X=l.useRecoilState(vl),K=r._slicedToArray(X,1)[0],Z=(null===q||void 0===q?void 0:q.entityId)===x,$=P.hovered,ee=El(),te=r._slicedToArray(ee,1)[0],ne=Dl({id:c},f,p),re={transition:"all 0.25s",background:"#FFF"},ae=o.useState(""),oe=r._slicedToArray(ae,2),le=oe[0],ie=oe[1],de="undefined"!==typeof window&&window.innerWidth<768,ue=Q&&de,ce=function(){var e=T(h);return k(e)},se=te?function(){C({text:"Fork this chain?",secondaryText:Wt.default.createElement("p",{className:"ml-md mr-md"},"Are you sure you want to unlink this chain from the parent page? If so, any future changes will not be inherited."),actions:{close:{text:"Cancel",handler:function(){}},confirm:{text:"Confirm",handler:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=T(h);e&&(t.forkedOn=(new Date).getTime()),A({docId:f,mode:p},{type:g.ActionTypes.DUPLICATE_ENTITY,featureIds:[x],names:[mo(h)]},To({parentId:c,entity:t,siblingId:x,relativePosition:"bottom",tidyEntity:M}))}(!0),s(!1)}}}})}:void 0;$&&(re=r._objectSpread2({},re));var fe=b.useComponent(h.type).siblingFeatures,pe=void 0===fe?[]:fe,me=b.useComponent("fronts/flex-feature").siblingFeatures,ve=void 0===me?[]:me,ge=function(e,t,n){C({text:"".concat(e?"Cut":"Delete"," chain and variant?"),secondaryText:Wt.default.createElement("p",{className:"ml-md"},"".concat(n," may contain variant props necessary for an active A/B test. ").concat(e?"Cutting this to clipboard":"Deleting this chain"," will also remove it in the variant. Proceed?")),actions:{confirm:{text:"Confrim",handler:t},close:{text:"Cancel",handler:function(){}}}})},he=b.useComponentToolbarHelper(null===h||void 0===h||null===(t=h.props)||void 0===t?void 0:t.type),be=(null===he||void 0===he?void 0:he.getToolbarInfo({customFields:(null===h||void 0===h||null===(n=h.props)||void 0===n?void 0:n.customFields)||{},getIconComponent:function(e){var t;switch(e){case"apps":t=Qr.default;break;case"desktop":t=Gr.default;break;case"desktopOff":t=Vr.default;break;case"mobile":t=qr.default;break;case"mobileOff":t=Yr.default;break;case"web":t=Jr.default;break;case"visibilityOff":t=zn.default;break;default:t=Xr.default}return t},entity:h,setEntity:y}))||{},ye=be.warn,Ee=be.items,xe=ye?"red":"black",Ce=[{name:"Chain Menu",icon:Wt.default.createElement(zr.default,{titleAccess:"Menu"}),items:[{label:"Copy to Clipboard",callback:ce,dataQa:"cb-copy-btn"},{label:"Cut to Clipboard",callback:function(){var e,t=(N||[]).find((function(e){return Object.keys((null===e||void 0===e?void 0:e.variants)||{}).length})),n=((null===ne||void 0===ne?void 0:ne.children)||[]).find((function(e){return e.id===x})),r=function(){ce(),s(!0)};!te&&(n||t||Object.keys((null===h||void 0===h||null===(e=h.props)||void 0===e?void 0:e.variants)||{}).length)?ge(!0,r,n?"This chain's parent":t?"One of this chains children":"This chain"):r()},dataQa:"cb-cut-btn"},{label:"Copy Features to Clipboard",callback:function(){var e=T(h).children;null===e||void 0===e||e.forEach((function(e){return k(e)}))},dataQa:"cb-copy-features-btn"},{label:"Remove Features from Chain",callback:function(){var e=w(h).children;if(e){var t,n=(N||[]).find((function(e){return Object.keys((null===e||void 0===e?void 0:e.variants)||{}).length})),r=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.forEach((function(e){po({entity:e,parentId:x})(t,n),xo({entity:e,parentId:x})(t,n)}))},a=function(){return A({docId:f,mode:p},{type:g.ActionTypes.DELETE_ENTITIES,featureIds:e.map((function(e){return g.objectToId(e)})),names:e.map((function(e){return mo(e)||g.objectToId(e)}))},r)};n?(t=a,C({text:"Delete chain children including variants?",secondaryText:Wt.default.createElement("p",{className:"ml-md"},"Variant props were detected in one of the chain children that may be necessary for an active A/B test. Deleting the children will also remove the variant from the page. Proceed?"),actions:{confirm:{text:"Confrim",handler:t},close:{text:"Cancel",handler:function(){}}}})):a()}},dataQa:"remove-features-btn"},{label:"Remove",callback:function(){var e,t=(N||[]).find((function(e){return Object.keys((null===e||void 0===e?void 0:e.variants)||{}).length})),n=((null===ne||void 0===ne?void 0:ne.children)||[]).find((function(e){return e.id===x}));!te&&(n||t||Object.keys((null===h||void 0===h||null===(e=h.props)||void 0===e?void 0:e.variants)||{}).length)?ge(!1,(function(){return s(!1)}),n?"This chain's parent":t?"One of this chains children":"This chain"):s(!1)},dataQa:"remove-btn"},{label:"Debug",callback:function(){console.log("ENTITY --- ",JSON.parse(JSON.stringify(h))),console.log("PARENT ID --- ",c)},dataQa:"debug-btn"}]}],Se=$?"relative":null,Ie=r._objectSpread2(r._objectSpread2({ChainColumnDropTarget:Ni},P),{},{selected:Z,styles:r._objectSpread2(r._objectSpread2({},re),{},{position:Se}),overlay:Wt.default.createElement(vi,{showOutline:$||Z,showMenu:$,borderColor:xe,overlayBar:Wt.default.createElement(si,{type:"chain",onSelect:function(){Y({docId:f,mode:p,entityId:x}),F((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{selected:!0})}))},forkFeature:se,entitySize:E,draggable:!0,onDragEnd:H,onDragStart:B({id:x,entity:r._objectSpread2(r._objectSpread2({},h),{},{parentId:c,isClipboardItem:!1})},null===O||void 0===O?void 0:O.current),menus:Ce}),displayName:mo(h),type:"chain"}),overlayLeft:Ee?Wt.default.createElement(vi,{showOutline:$||Z,showMenu:$,borderColor:xe,overlayBar:Wt.default.createElement(si,{type:"chain",position:"left",toolbar:Ee,backgroundColor:xe}),displayName:mo(h),type:"chain"}):void 0,OverlayBar:si}),ke={onMouseEnter:function(){d&&F((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!0})}))},onMouseLeave:function(){d&&F((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!1})}))},onDragEnter:Ti({getDragEntity:U,allowedTypes:pe,entityId:x,ref:O}),onDragOver:wi(O),onDragLeave:Di(O),onDrop:function(e){e.preventDefault(),e.stopPropagation();var t=U()||{},n=t.id,r=t.entity;if(null!==O&&void 0!==O&&O.current&&n&&r){O.current.classList.remove("dragging","dragging-chain","dragging-top","dragging-bottom");var a=Ci({x:e.clientX,y:e.clientY},O.current.getBoundingClientRect())?"top":"bottom";if(r&&pe.includes(r.type)&&n!==g.objectToId(h)){if(r.isClipboardItem&&r.parentId!==c){var o=T(r);delete o.isClipboardItem,delete o.clonedBy;var l=function(){var e,t;e=a,t=o,A({docId:f,mode:p},{type:g.ActionTypes.DRAG_FROM_CLIPBOARD,featureIds:[g.objectToId(t)],names:[mo(t)]},To({entity:t,parentId:c,siblingId:x,relativePosition:e,tidyEntity:M}))},i=function(){return _(r)};r.locked?C(ji(l,i)):(l(),i())}else A({docId:f,mode:p},{type:g.ActionTypes.DRAG_AND_DROP_ENTITY,featureIds:[n],names:[mo(r)]},So({id:n,prevParentId:r.parentId,currentParentId:c,siblingId:g.objectToId(h),relativePosition:a,isFlexFeatureSibling:(ve||[]).includes(r.type)}));W(void 0)}}},onClick:function(){i&&(F((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{selected:!0})})),D(Cl(!0)))}};return Wt.default.createElement(b.ChainContext.Provider,{value:{ref:O,interactions:ke,selectors:Ie,setFeaturesInChains:function(e){A({docId:f,mode:p},{type:g.ActionTypes.DRAG_AND_DROP_ENTITY,featureIds:[g.objectToId(e)],names:[mo(e)]},So(e))},dataAttrs:{id:x},change:y,props:h.props,showHelpers:Q,showFeatureNames:Q&&!K,openMobileCard:le,setOpenMobileCard:ie,showMobileCard:ue}},u)},Li=function(e){var t,n=e.docId,a=e.mode,o=wl(e,n,a),l=r._slicedToArray(o,1)[0],i=l.props,d=l.children,u=void 0===d?[]:d,s=g.objectToId(e),f=b.useAppContext(),p=jl(l,n,a),m=b.useComponentMap(null===i||void 0===i?void 0:i.type),v=Pa(l,JSON.parse(JSON.stringify(null===i||void 0===i?void 0:i.customFields))),h=function(){var e;if("Full span"===(null===i||void 0===i||null===(e=i.customFields)||void 0===e?void 0:e.layout))return[];var t=Object.keys((null===i||void 0===i?void 0:i.customFields)||{}).reduce((function(e,t){if(Ei.includes(t)&&null!==i&&void 0!==i&&i.customFields[t].trim()){var n=t.match(/table\d/)[0];return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},n,[].concat(c._toConsumableArray(e[n]||[]),[t])))}return e}),{});return Object.values(t).flatMap((function(e){return e.length>1?e.flatMap((function(e){return null===i||void 0===i?void 0:i.customFields[e].split(",")})):[]}))}(),y=r._objectSpread2(r._objectSpread2({},e),{},{props:i,children:u.map((function(t,o){return Wt.default.createElement(Fi,{key:g.objectToId(t),chain:l,parentId:g.objectToId(l),canChangeRowSpan:h.includes(String(o+1)),docId:n,mode:a,props:r._objectSpread2(r._objectSpread2({},t),{},{settings:e.featureSettings||{}}),context:f})})),childProps:p,context:f}),E=e.settings,x=(E=void 0===E?{}:E).hoverable,C=E.selectable,S=y.children.map((function(e){var t=e.props;return g.objectToId(t)}));return S.push(s),Wt.default.createElement(Wr.default,{renderPlaceholder:function(e){return Wt.default.createElement("div",{"data-ids":S,style:{height:400},ref:e})}},Wt.default.createElement(Oi,{docId:n,mode:a,removeSelf:e.removeSelf,draggable:!0,parentId:e.parentId,hoverable:x,selectable:C,value:r._objectSpread2({},e),showMenu:!0},Wt.default.createElement(b.ComponentProvider,{value:i},Wt.default.createElement(m,b._extends({key:"".concat(s,"-").concat((null===y||void 0===y||null===(t=y.children)||void 0===t?void 0:t.length)||0)},y.props,{customFields:v,context:y.context,children:y.children,childProps:y.childProps})))))},Mi=a.withStyles({tooltip:{border:"2px solid ".concat("#d4d4d4"),background:"#FFF",padding:"4px",transform:"scale(.65) translate(5%, -25%) !important",color:"#3a3a3a",minWidth:"150px",maxWidth:"50vw",maxHeight:"60vh",overflow:"auto",boxShadow:"0px 5px 5px -3px rgb(0 0 0 / 20%), 0px 8px 10px 1px rgb(0 0 0 / 14%), 0px 3px 14px 2px rgb(0 0 0 / 12%)"}})(er.default),zi=function(e){var t=e.item,n=e.children,a=b.useFusionContext(),o=Ia();return Wt.default.createElement(Mi,{arrow:!0,placement:"right",interactive:!0,title:Wt.default.createElement("div",{style:{padding:10}},"features"===t.collection?Wt.default.createElement(Fi,{docId:o,mode:"remote",parentId:"",props:r._objectSpread2(r._objectSpread2({},t.props),{},{settings:{selectable:!1,draggable:!1,hoverable:!1}}),context:a,suppressWarning:!0}):Wt.default.createElement(Li,b._extends({docId:o,mode:"remote",parentId:"",settings:{},removeSelf:function(){}},t,{featureSettings:{draggable:!0,hoverable:!0,selectable:!1}})))},n)},Bi=function(e){var t,n,a,l,i=e.itemRef,d=e.removeItem,u=e.toggleLockItem,c=e.isChecked,s=e.setIsChecked,f=Wt.default.useRef(),p=Ia(),m=_l(),v=r._slicedToArray(m,2)[1],h=Yo(g.objectToId(i)),b=o.useState(!1),y=r._slicedToArray(b,2),E=y[0],x=y[1],C=vo(h),S=(null===h||void 0===h||null===(t=h.collection)||void 0===t?void 0:t.substr(0,(null===h||void 0===h||null===(n=h.collection)||void 0===n?void 0:n.length)-1))||"feature",I=function(e){e.stopPropagation(),u&&u(h)},k=(o.useContext(Wo)||Uo).handleDragStart,_=function(e){e.preventDefault(),e.stopPropagation(),d&&d(h)};return Wt.default.createElement(Er.default,null,Wt.default.createElement(xr.default,null,Wt.default.createElement("div",{"data-qa":"clipboard-item",style:Lo.roundedOutlineCard,onClick:function(){return s(!c)}},Wt.default.createElement(ci,{checked:Boolean(c),onChange:s,name:i.id}),Wt.default.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"}},Wt.default.createElement("div",{ref:f,onDragStart:k({id:g.objectToId(C),entity:r._objectSpread2(r._objectSpread2({},C),{},{locked:h.locked,isClipboardItem:!0,parentId:"clipboard"})},null===f||void 0===f?void 0:f.current),draggable:!0,style:{cursor:"move",fontSize:".9rem",fontFamily:"Franklin,Arial,Helvetica,sans-serif"}},Wt.default.createElement("p",{style:Lo.label},S),Wt.default.createElement("p",{style:Lo.bold,onClick:s},mo(h)),Wt.default.createElement("div",null,(null===C||void 0===C?void 0:C.clonedBy)&&Wt.default.createElement(Wt.default.Fragment,null,"Added by ",null===C||void 0===C?void 0:C.clonedBy,Wt.default.createElement("br",null)),function(e){var t=$t.default(e,"props.clonedOn",null);return new Date(t).toLocaleDateString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}(h),(null===h||void 0===h||null===(a=h.children)||void 0===a?void 0:a.length)>0?Wt.default.createElement("div",{style:{cursor:"default"}},Wt.default.createElement("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:function(e){e.stopPropagation(),x(!E)}},E?Wt.default.createElement(jr.default,{fontSize:"inherit"}):Wt.default.createElement(Rr.default,{fontSize:"inherit"}),"Features in ",S),E?Wt.default.createElement(Wt.default.Fragment,null,null===h||void 0===h||null===(l=h.children)||void 0===l?void 0:l.map((function(e){return Wt.default.createElement(zi,{item:e},Wt.default.createElement("p",{style:{marginLeft:12}},mo(e)))}))):null):null)),Wt.default.createElement("div",{"data-qa":"clipboard-action-items",style:Lo.flexColumn},Wt.default.createElement(zi,{item:C},Wt.default.createElement(Dr.default,{fontSize:"inherit",className:"hover-blue",style:{margin:"0 0 4px"}})),_&&Wt.default.createElement(vr.default,{fontSize:"inherit",onClick:_,className:"hover-blue",style:{margin:"2px 0"}}),Wt.default.createElement(gr.default,{fontSize:"inherit",onClick:function(e){e.preventDefault(),e.stopPropagation(),v({docId:p,mode:"remote",entityId:g.objectToId(i)})},className:"hover-blue",style:{margin:"2px 0"}}),null!==h&&void 0!==h&&h.locked?Wt.default.createElement(wr.default,{fontSize:"inherit",onClick:I,className:"hover-blue",style:{margin:"2px 0",color:"#196dfc"}}):Wt.default.createElement(Tr.default,{fontSize:"inherit",onClick:I,className:"hover-blue",style:{margin:"2px 0"}}))))))},Hi={remote:"#6814c9",draft:"#196dfc",recover:"#d9a129",default:"#000000de",loading:"#d4d4d4"},Ui=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{locked:{},active:{}},r={locked:{},active:{}};return null===e||void 0===e||null===(t=e.children)||void 0===t||t.forEach((function(e){var t=g.objectToId(e);e.locked?r.locked[t]=n.locked[t]||!1:r.active[t]=n.active[t]||!1})),r},Wi=a.makeStyles({root:{flexGrow:1,maxWidth:400}}),Gi=function(e){var t=Wt.default.useContext(Qo).setMenuProps,n=Pl(),r=t([{label:"Publish",onClick:function(){return n()}}]);return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(la.default,b._extends({onContextMenu:r},e)))},Vi=function(e){var t=e.docs,n=e.onSelect;return Wt.default.createElement(Wt.default.Fragment,null,t.map((function(e){return Wt.default.createElement("div",{className:"relative",key:e.slug},Wt.default.createElement(Gi,{onClick:function(){return n&&n(e.slug)},nodeId:e.docId,label:e.name}))})))},qi=a.styled(oa.default)({margin:"16px 0 0 16px"}),Yi=function(e){var t=e.onSelectDocument,n=Wi(),a=Sa();if(!a)return null;var l=xa(),i=o.useState(!1),d=r._slicedToArray(i,2),u=d[0],c=d[1],s=o.useContext(Qo).setMenuProps,f=[{label:"Add New Document",onClick:function(){return c(!0)}}];return Wt.default.createElement(qi,{className:n.root,defaultCollapseIcon:Wt.default.createElement(tn.default,null),defaultExpandIcon:Wt.default.createElement(Rr.default,null),onContextMenu:s(f,!0)},Wt.default.createElement(la.default,{nodeId:"main",label:"Documents"},Wt.default.createElement(Vi,{onSelect:t,docs:a.filter((function(e){return"Clipboard"!==e.name}))}),Wt.default.createElement(Ai,{open:u,setOpenDialog:c,repo:l,onSelectDocument:t})))},Ji=function(e){var t=e.entity,n=e.setEntity,a=e.parentId,l=e.className,i=e.icon,d=o.useState(!1),u=r._slicedToArray(d,2),s=u[0],f=u[1],p=g.objectToId(t),m=t.forkedOn,v=sl(),h=ya().mode,y=o.useContext(Xo).setDialogProps,E=Vo(),x=r._slicedToArray(E,3),C=x[1],S=x[2],I=Yo().children,k=b.useComponent(t.type),_=k.childFeatures,A=void 0===_?[]:_,T=k.siblingFeatures,w=void 0===T?[]:T,D=b.useComponent("fronts/flex-feature"),j=D.siblingFeatures,R=D.fields,P=ho(R),F=null!==I&&void 0!==I&&I.length?I.filter((function(e){return A.includes(e.type)})):[],N="undefined"!==typeof window&&window.hoverToScrollTime||2e3,O=Il(t),L=r._slicedToArray(O,2),M=L[0],z=M.selected,B=M.hovered,H=L[1],U=_l(),W=r._slicedToArray(U,2),G=W[0],V=W[1];Wt.default.useEffect((function(){z&&(null===G||void 0===G?void 0:G.entityId)!==p&&H((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{selected:!1})}))}),[z,null===G||void 0===G?void 0:G.entityId]);var q=Wt.default.useRef(null),Y=mo(t),J=function(e){var t,r,a=e&&(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)&&(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value.trim());a&&a!==Y&&n((function(e){return e.props.customFields.displayName=a})),f(!1)},Q=Rl(),X=Wl(),K=Wl(!1),Z=o.useContext(Qo).setMenuProps,$=o.useRef(null),ee=o.useContext(Wo)||Uo,te=ee.getDragEntity,ne=ee.handleDragStart,re={onDragEnter:Ti({getDragEntity:te,allowedTypes:[].concat(c._toConsumableArray(w),c._toConsumableArray(A)),entityId:null,ref:$}),onDragOver:function(e){if(e.preventDefault(),e.stopPropagation(),null!==$&&void 0!==$&&$.current&&$.current.classList.contains("dragging")){var n,r=(te()||{}).entity;if(!r)return;var a,o=Ci({x:e.clientX,y:e.clientY},$.current.getBoundingClientRect());w.includes(r.type)?a=o?"dragging-top":"dragging-bottom":o||!A.includes(r.type)||null!==(n=t.children)&&void 0!==n&&n.length||(a="dragging-bottom"),a&&!$.current.classList.contains(a)&&($.current.classList.remove("dragging-top","dragging-bottom"),$.current.classList.add(a,"dragging-small"))}},onDragLeave:Di($,["dragging-small"]),onDrop:function(e){if(e.preventDefault(),e.stopPropagation(),null!==$&&void 0!==$&&$.current){$.current.classList.remove("dragging","dragging-top","dragging-bottom","dragging-small");var t=te()||{},n=t.id,r=t.entity;if(n&&r&&n!==p&&(w.includes(r.type)||A.includes(r.type))){var o=Ci({x:e.clientX,y:e.clientY},$.current.getBoundingClientRect())?"top":"bottom",l={type:g.ActionTypes.DRAG_AND_DROP_ENTITY,featureIds:[n],names:[mo(r)]};Q({docId:v,mode:h},l,So("top"===o?{id:n,prevParentId:r.parentId,currentParentId:a,siblingId:p,relativePosition:"top",isFlexFeatureSibling:(j||[]).includes(r.type)}:{id:n,prevParentId:r.parentId,currentParentId:A.includes(r.type)?p:a,siblingId:A.includes(r.type)?void 0:p,relativePosition:"bottom",isFlexFeatureSibling:(j||[]).includes(r.type)}))}}}};return Wt.default.createElement("div",b._extends({ref:$,draggable:"true",onDragStart:ne({id:p,entity:r._objectSpread2(r._objectSpread2({},t),{},{parentId:a})},null===$||void 0===$?void 0:$.current),className:l,style:{position:"relative",cursor:"move"}},re,{"data-qa":"sidebarEntityName"}),i,s?Wt.default.createElement(En.default,{onClickAway:J},Wt.default.createElement(ia.default,{defaultValue:Y,onBlur:J,onKeyPress:function(e){return"Enter"===e.key&&J(e)}})):Wt.default.createElement("a",{onMouseEnter:function(){H((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!0})})),q.current=setTimeout((function(){var e=document.querySelector("#".concat(p)),t=document.querySelector("[data-ids*='".concat(p,"']"));(e||t)&&(Na(e||t),q.current=setTimeout((function(){Na(document.querySelector("#".concat(p)))}),500))}),N)},onMouseLeave:function(){H((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{hovered:!1})})),q.current&&clearTimeout(q.current)},onClick:function(){V({entityId:p,docId:v,mode:h}),H((function(e){return r._objectSpread2(r._objectSpread2({},e),{},{selected:!0})}))},onContextMenu:function(){var e=function(e){Q({docId:v,mode:h},{type:e?g.ActionTypes.CUT_TO_CLIPBOARD:g.ActionTypes.DELETE_ENTITY,featureIds:[p],names:[Y]},(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;po({entity:t,parentId:a})(e,n),xo({parentId:a,entity:t})(e,n)}))},n=function(){var e=X(t);return C(e)},r=function(e,n){return To({entity:e,parentId:g.objectToId(t),relativePosition:n,tidyEntity:P})},o=Fa(t),l=(A||[]).map((function(e){var t=b.useComponent(e);return{label:t.name,fields:t.fields,type:e,collection:t.collection}})),i=[{label:"Rename",onClick:function(){return f(!0)}},o?{label:"Add Feature",items:l.map((function(e){var t=e.label,n=e.fields,a=e.type,o=e.collection;return{label:t,onClick:function(){var e=wo(n,a,t,o);Q({docId:v,mode:h},{type:g.ActionTypes.ADD_ENTITY,featureIds:[g.objectToId(e)],names:[mo(e)]},r(e,"bottom"))}}}))}:null,{label:"Copy to Clipboard",onClick:n},{label:"Cut to Clipboard",onClick:function(){n(),e(!0)}}].concat(c._toConsumableArray(o?[{label:"Paste from Clipboard",disabled:!(null!==F&&void 0!==F&&F.length),items:null===F||void 0===F?void 0:F.map((function(e){return{label:mo(e),onClick:function(){var t=X(e),n=function(){Q({docId:v,mode:h},{type:g.ActionTypes.PASTE_FROM_CLIPBOARD,featureIds:[g.objectToId(t)],names:[mo(e)]},r(t,"bottom"))},a=function(){return S(e)};e.locked?y(ji(n,a)):(n(),a())}}}))},{label:"Copy Features to Clipboard",onClick:function(){var e=X(t).children;e&&C(e)}},{label:"Remove Features from Chain",onClick:function(){var e=K(t).children;if(e){Q({docId:v,mode:h},{type:g.ActionTypes.DELETE_ENTITIES,featureIds:e.map((function(e){return g.objectToId(e)})),names:e.map((function(e){return mo(e)||g.objectToId(e)}))},(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;po({entity:e,parentId:p})(t,n),xo({entity:e,parentId:p})(t,n)}))}}}]:[]),[{label:"Remove",onClick:e}]).filter((function(e){return null!==e}));return Z(i)}(),style:{cursor:"pointer",display:"inline-flex",fontWeight:100,color:B?"#196dfc":"#3a3a3a"}},Wt.default.createElement(Xl,{icon:b.useComponentIcon(t.type)})," ",m&&Wt.default.createElement(Lr.default,{style:{marginRight:4}})," ",Y))},Qi=function(e){var t=b.useComponent("fronts/flex-feature").siblingFeatures,n=e.isTopStrip,r=e.name,a=e.parentId,l=(o.useContext(Wo)||Uo).getDragEntity,i=sl(),d=ya().mode,u=Rl(),c=o.useRef(),s=n?{onDragEnter:Ti({getDragEntity:l,allowedTypes:["fronts/flex-feature"],entityId:null,ref:c}),onDragOver:function(e){if(e.preventDefault(),e.stopPropagation(),null!==c&&void 0!==c&&c.current&&c.current.classList.contains("dragging")){var t,n=(l()||{}).entity;if(!n)return;Ci({x:e.clientX,y:e.clientY},c.current.getBoundingClientRect())||"fronts/flex-feature"!==n.type||(t="dragging-bottom"),t&&!c.current.classList.contains(t)&&(c.current.classList.remove("dragging-top","dragging-bottom"),c.current.classList.add(t,"dragging-small"))}},onDragLeave:Di(c,["dragging-small"]),onDrop:function(e){if(e.preventDefault(),e.stopPropagation(),null!==c&&void 0!==c&&c.current){c.current.classList.remove("dragging","dragging-bottom","dragging-small");var n=l()||{},r=n.id,o=n.entity;if(r&&o&&"fronts/flex-feature"===o.type){var s={type:g.ActionTypes.DRAG_AND_DROP_ENTITY,featureIds:[r],names:[mo(o)]};u({docId:i,mode:d},s,So({id:r,prevParentId:o.parentId,currentParentId:a,relativePosition:"bottom",colId:"table0LeftIds",isFlexFeatureSibling:(t||[]).includes(o.type)}))}}}}:{};return Wt.default.createElement("span",b._extends({ref:c},s,{style:{margin:"16px 0 0  36px",display:"block",fontSize:".9rem",color:"gray",position:"relative"}}),r)},Xi=function e(t){var n,a=t.entityRef,o=t.isCollapsed,l=t.setIsCollapsed,i=t.parentId,d=ya().mode,u=wl(a,sl(),d),c=r._slicedToArray(u,2),s=c[0],f=c[1];if(!s||null===s||void 0===s||null===(n=s.props)||void 0===n||!n.type)return null;var p=Oa(),m=Fa(s)?za(JSON.stringify(s)):[],v=m.length>0,h=La(),b=v?h.entityWithChildren:h.entity,y=function(e){return function(){return l&&l(e)}},E=null!==m&&void 0!==m&&m.length?o?Wt.default.createElement(Rr.default,{style:{float:"left",cursor:"pointer",zIndex:7,marginRight:"4px",position:"relative"},onClick:y(!1)}):Wt.default.createElement(tn.default,{style:{float:"left",cursor:"pointer",zIndex:7,marginRight:"4px",position:"relative"},onClick:y(!0)}):null;return Wt.default.createElement(Ki,{entity:s,setEntity:f,listItemClassNames:b,icon:E,parentId:i},!o&&m.map((function(t){var n=r._slicedToArray(t,2),a=n[0],o=n[1];return Wt.default.createElement(Wt.default.Fragment,{key:"".concat(Ma[a]||a,"-").concat(g.objectToId(s))},Wt.default.createElement(Qi,{isTopStrip:"table0LeftIds"===a,name:Ma[a]||a,parentId:g.objectToId(s.props)}),Wt.default.createElement(yr.default,{className:p.nested1},o.map((function(t,n){return Wt.default.createElement(e,{key:"".concat(g.objectToId(t),"-").concat(n),entityRef:t,parentId:g.objectToId(s.props)})}))))})))},Ki=function(e){var t,n=e.entity,r=e.setEntity,a=e.listItemClassNames,o=e.parentId,l=e.icon,i=e.children;return n&&null!==n&&void 0!==n&&null!==(t=n.props)&&void 0!==t&&t.type?Wt.default.createElement(Er.default,{style:{padding:0}},Wt.default.createElement(xr.default,null,Wt.default.createElement(Ji,{entity:n,setEntity:r,parentId:o,className:a,icon:l}),i)):null},Zi=["featureProps","handleClose"],$i=function(e){p._inherits(n,e);var t=p._createSuper(n);function n(e){var r;return p._classCallCheck(this,n),(r=t.call(this,e)).state={error:!1},r}return p._createClass(n,[{key:"componentDidCatch",value:function(e){this.setState({error:!0}),this.props.onError&&this.props.onError(e)}},{key:"render",value:function(){var e=this.props.children;return this.state.error?"error":e}}]),n}(Wt.default.Component);function ed(e){var t,n,a,o,l,i=Ia(),d=e.onCancel,u=e.data,c=wl({id:null===u||void 0===u?void 0:u.entityId},null===u||void 0===u?void 0:u.docId,null===u||void 0===u?void 0:u.mode),s=r._slicedToArray(c,2),f=s[0],p=s[1],m=b.useComponentFields(null===f||void 0===f?void 0:f.type),v=b.useComponent(null===f||void 0===f?void 0:f.type).fieldComponents,g=Wt.default.useState((null===u||void 0===u?void 0:u.docId)===i),h=r._slicedToArray(g,2),y=h[0],E=h[1],x=null===(t=(null===f||void 0===f?void 0:f.props)||f)||void 0===t?void 0:t.customFields;if(!x)return d(),null;var C=function(){E((function(e){return!e}))};return Wt.default.createElement("div",{"data-qa":"featureEditor",style:{position:"fixed",background:"#fff",top:0,left:0,width:350,transition:"all .25s",bottom:0,boxSizing:"border-box",padding:"12px",overflow:"auto",zIndex:9e20}},Wt.default.createElement("div",{style:{display:"flex",width:"calc(100% - 24px)"}},Wt.default.createElement(da.default,{onClick:C,name:"previewFeatureIcon",style:{marginRight:"4px",position:"relative",top:"-2px"}}),Wt.default.createElement("div",null,f.props&&Wt.default.createElement("h4",{"data-qa":"featureId"},f.props.id),(null===(n=f.props)||void 0===n||null===(a=n.customFields)||void 0===a?void 0:a.displayName)&&Wt.default.createElement("h4",null,null===(o=f.props)||void 0===o||null===(l=o.customFields)||void 0===l?void 0:l.displayName))),Wt.default.createElement("div",{style:{width:"100%",margin:"0 auto"}},Wt.default.createElement($i,null,y?Wt.default.createElement(td,{featureProps:f,docId:u.docId,mode:u.mode,handleClose:C}):null,Wt.default.createElement("div",{style:{top:0,right:0,position:"absolute",fontSize:"22px",margin:"12px"}},Wt.default.createElement(pr.default,{style:{cursor:"pointer",fontSize:"inherit"},name:"closeFeatureEditorIcon",onClick:d})),Wt.default.createElement("div",{style:{padding:"48px 20px"}},Wt.default.createElement(ro,{propTypes:r._objectSpread2({},m),fields:x,setEntity:p,onFieldChange:function(e,t){!function(e,t){p((function(n){var r=n.props.customFields||{};n.props.customFields||(n.props.customFields=r);var a,o=e.split(".");for(a=0;a<o.length-1;a++)r=r[o[a]]||{};r[o[a]]=null===t||"undefined"===typeof t?"":t}))}(e,t)},overridesMap:v,feature:f})))))}function td(e){var t=e.featureProps,n=e.handleClose,a=p._objectWithoutProperties(e,Zi),o=b.useFusionContext();return Wt.default.createElement(Cr.default,{open:!0,onClick:function(e){var t,r;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&null!==(r=t.classList)&&void 0!==r&&r.contains("MuiBackdrop-root")&&n()},style:{left:350}},"features"===t.collection?Wt.default.createElement("div",{"data-qa":"featurePreview",style:{resize:"both",maxHeight:"100vh",transform:"scale(.75)",padding:"50px 20px 20px 20px",background:"white",overflow:"auto"}},Wt.default.createElement("div",{style:{position:"absolute",top:"12px",color:"#3a3a3a"}},mo(t)||"Feature"),Wt.default.createElement(Fi,b._extends({props:r._objectSpread2(r._objectSpread2({},t.props),{},{settings:{selectable:!1,draggable:!1,hoverable:!0,showMenu:!1,canChangeRowSpan:!1}})},a,{parentId:"",context:o,suppressWarning:!0}))):Wt.default.createElement($i,null,Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("div",{"data-qa":"featurePreview",style:{resize:"both",maxHeight:"100vh",transform:"scale(.75)",padding:40,background:"white",overflow:"auto"}},Wt.default.createElement(Li,b._extends({},t,a,{featureSettings:{draggable:!0,hoverable:!0,selectable:!1}}))))))}var nd={height:"100%",width:"100%",top:0,left:0,overflowX:"hidden",position:"absolute",zIndex:1e3},rd=function(e){var t=e.editor,n="remote"===ya().mode,a=!0===l.useRecoilValue(hl),o=l.useRecoilState(bl),i=r._slicedToArray(o,2)[1];return a&&n?Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},nd),{},{height:t?"100vh":"100%",position:t?"fixed":"absolute"}),onClick:function(){return i(!0)}}):null},ad=a.styled(Kr.default)({}),od=a.styled(Kr.default)({display:"flex",flexDirection:"column",paddingTop:15,position:"fixed",top:0,left:0,bottom:0,width:50,height:"100vh",borderRight:"1px solid ".concat("#d4d4d4"),borderLeft:"1px solid ".concat("#d4d4d4"),background:"#fff"}),ld=a.styled(Kr.default)({width:285,marginLeft:52}),id=["Top Furniture","Full Width Topper","Content","Full Width Footer","Footer Furniture"],dd=a.makeStyles((function(){return{drawerOpen:{width:350,flexShrink:0},drawerClosed:{width:50,flexShrink:0,overflowX:"hidden"}}})),ud={DevTools:function(){var e=Oa(),t=xa(),n=fl()||"homepage",a=pl()||"Homepage",l=o.useState(n),i=r._slicedToArray(l,2),d=i[0],u=i[1],s=b.useAllComponentFields(),f=bo(s),p=function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={sandbox:"https://assembler-sandbox-api.wpit.nile.works",prod:"https://assembler-api.wpit.nile.works"},e.next=3,fetch("".concat(r[n],"/published-document/").concat(t),{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(e){return function(){p(d,e).then((function(e){if(null!==e&&void 0!==e&&e.snapshot){var r=f(e.snapshot),o={name:a,slug:n,template:r};t.documentExists(n)?t.replaceDocument(o.slug,o.template):null===t||void 0===t||t.addDocument(o)}else alert("No published document found while seeding local environment")}))}},v=new FileReader;return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("h3",{"data-qa":"toolsTitle",style:{fontWeight:400,margin:"16px 0 0 16px",fontSize:"1.1rem"}},"Developer Tools"),Wt.default.createElement(yr.default,{className:e.root},Wt.default.createElement(Er.default,null,Wt.default.createElement(Va,null,Wt.default.createElement("span",null,"Replacement doc slug"),Wt.default.createElement("span",{style:{fontWeight:100,display:"block",marginTop:4}},"This will fetch the published document associated with that slug and replace the current doc with its contents."))),Wt.default.createElement(Er.default,null,Wt.default.createElement(rn.default,{defaultValue:n,variant:"outlined",style:{width:"100%"},onBlur:function(e){var t;u(((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||"").trim())}})),Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{onClick:m("prod"),style:{width:"100%",background:"#d20102",color:"#FFF",textTransform:"none"}},"Seed from prod")),Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{onClick:m("sandbox"),className:"bg-primary",style:{width:"100%",textTransform:"none"}},"Seed from sandbox")),Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{className:"bg-default",style:{width:"100%",color:"#FFF",textTransform:"none"},component:"label"},"Seed from upload",Wt.default.createElement("input",{type:"file",accept:"*.bin",onChange:function(e){if(e.target.files&&e.target.files[0]){var r=e.target.files[0];if(!/\.bin$/.test(r.name))throw new Error("File must be of type .bin");v.onload=function(){var e=new Uint8Array(v.result);t.replaceDocumentWithBinary(n,e)},v.readAsArrayBuffer(r)}},hidden:!0})))))},Clipboard:function(){var e,t,n=Oa(),a=Vo(),l=r._slicedToArray(a,3)[2],i=Yo(),d=Jo(),u=o.useContext(Qo).setMenuProps,c=o.useContext(Xo).setDialogProps,s=o.useState(!1),f=r._slicedToArray(s,2),p=f[0],m=f[1],v=o.useState(Ui(i)),h=r._slicedToArray(v,2),b=h[0],y=h[1],E=o.useState({locked:!1,active:!1}),x=r._slicedToArray(E,2),C=x[0],S=x[1],I=p?"locked":"active",k=Wt.default.useMemo((function(){return C[I]}),[C,I]);if(!i)return null;var _=function(e){return{text:"Remove locked item(s) from clipboard?",actions:{close:{text:"Cancel",handler:function(){}},confirm:{text:"Confirm",handler:function(){l(e),y(Ui(i))}}}}},A=function(e){e.locked?c(_(e)):(l(e),y(Ui(i)))},T=function(e){d((function(t){t[g.objectToId(e)].locked=!e.locked})),y(Ui(i))},w=function(){var e,t={locked:{},active:{}};null===i||void 0===i||null===(e=i.children)||void 0===e||e.forEach((function(e){var n=e.locked?"locked":"active",r=g.objectToId(e);t[n][r]=I===n?!k:b[n][r]})),y(t),S((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},I,!k))}))},D=Wt.default.useMemo((function(){var e;return null===i||void 0===i||null===(e=i.children)||void 0===e?void 0:e.filter((function(e){return p?e.locked:!e.locked}))}),[i,p]);return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("h3",{"data-qa":"clipboardTitle",style:{fontWeight:400,margin:"16px 0 0 16px",fontSize:"1.1rem"}},"Clipboard"),Wt.default.createElement("div",{style:{borderBottom:"1px solid ".concat("#d4d4d4"),display:"flex"},"aria-label":"documents"},Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},li),{},{width:"50%",color:p?Hi.default:Hi.draft,borderColor:p?"transparent":Hi.draft,opacity:p?.75:1}),onClick:function(){return m(!1)}},"Unlocked"),Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},li),{},{width:"50%",color:p?Hi.draft:Hi.default,borderColor:p?Hi.draft:"transparent",opacity:p?1:.75}),onClick:function(){return m(!0)}},"Locked")),Wt.default.createElement("div",{style:{padding:"12px 0 0 16px",fontSize:".9rem",fontFamily:"Franklin,Arial,Helvetica,sans-serif",display:"flex",justifyContent:"space-between"}},Wt.default.createElement("span",{onClick:w},Wt.default.createElement(ci,{onChange:w,checked:k,name:"selectAll"}),"Select all"),null!==(e=Object.values(b[I]).filter(Boolean))&&void 0!==e&&e.length?Wt.default.createElement("span",{style:{color:"#196dfc",display:"flex",alignItems:"center"}},null===(t=Object.values(b[I]).filter(Boolean))||void 0===t?void 0:t.length," selected",Wt.default.createElement(_r.default,{fontSize:"inherit",onClick:u([{label:"Delete",onClick:function(){var e=Object.keys(b[I]).filter((function(e){return b[I][e]})),t=null===i||void 0===i?void 0:i.children.filter((function(t){return e.includes(g.objectToId(t))}));p?c(_(t)):(l(t),S((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},I,!1))})),y(Ui(i)))}},{label:p?"Unlock":"Lock",onClick:function(){var e,t=Object.keys(b[I]).filter((function(e){return b[I][e]})),n=null===i||void 0===i||null===(e=i.children)||void 0===e?void 0:e.filter((function(e){return t.includes(g.objectToId(e))}));d((function(e){n.forEach((function(t){e[g.objectToId(t)].locked=!p}))})),S((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},I,!1))})),y(Ui(i))}}]),style:{fontSize:"2rem",cursor:"pointer",margin:"-10px 0 -8px 4px"}})):null),Wt.default.createElement(yr.default,{className:n.root},null===D||void 0===D?void 0:D.map((function(e,t){var n,a,o=e.locked?"locked":"active";return Wt.default.createElement(Bi,{itemRef:e,key:"".concat(e.id,"-").concat(t),removeItem:A,toggleLockItem:T,isChecked:b[o][g.objectToId(e)],setIsChecked:(n=g.objectToId(e),a=Boolean(e.locked),function(e){var t=a?"locked":"active";y((function(a){var o;return r._objectSpread2(r._objectSpread2({},a),r._defineProperty({},t,r._objectSpread2(r._objectSpread2({},a[t]),{},r._defineProperty({},n,"boolean"===typeof e?e:null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.checked))))}))})})}))))},DocumentView:function(e){var t,n,a=e.onSelectDocument,o=Ul("root"),l=r._slicedToArray(o,1)[0],i=sl(),d=ya().mode,u=wl({id:"root"},i,d),c=r._slicedToArray(u,2),s=c[0],f=c[1],p=Oa(),m=b.useComponentFields("root");return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Wt.default.Suspense,{fallback:Wt.default.createElement("div",null,"Loading...")},Wt.default.createElement(Yi,{onSelectDocument:a})),l&&Wt.default.createElement(yr.default,{className:p.root},((null===l||void 0===l?void 0:l.children)||[]).map((function(e){return Wt.default.createElement(pd,{key:g.objectToId(e),sectionRef:e})})),Wt.default.createElement("div",{style:{padding:"0 20px"}},Wt.default.createElement(ro,{propTypes:r._objectSpread2({},m),fields:null!==s&&void 0!==s&&null!==(t=s.props)&&void 0!==t&&t.customFields?null===s||void 0===s||null===(n=s.props)||void 0===n?void 0:n.customFields:function(){var e;return null!==s&&void 0!==s&&null!==(e=s.props)&&void 0!==e&&e.customFields||(null!==s&&void 0!==s&&s.props?s.props.customFields={}:s.props={customFields:{}}),s.props.customFields}(),setEntity:f,onFieldChange:function(e,t){!function(e,t){f((function(n){var r=n.props.customFields||{};n.props.customFields||(n.props.customFields=r),r[e]=t}))}(e,t)},overridesMap:void 0,feature:s}))))},Alerts:$l,Tools:function(){var e=Oa(),t=fl(),n=o.useContext(Xo).setDialogProps,a=Vo(!0),l=r._slicedToArray(a,1)[0],i=xa(),d=b.useAllComponentFields(),u=bo(d),c=function(e){return{text:e===t?"Reset document to published state?":"Squash global clipboard?",actions:{confirm:{text:"Confirm",handler:function(){s(e)}},close:{text:"Cancel",handler:function(){}}}}},s=function(e){var n;i&&i.restClient&&(0!==Object.keys(l).length?("clipboard"===e?Promise.resolve({snapshot:JSON.parse(JSON.stringify(l))}):null===i||void 0===i||null===(n=i.restClient)||void 0===n?void 0:n.getPublishedDocument(t)).then((function(t){if(null!==t&&void 0!==t&&t.snapshot){var n=u(t.snapshot);i.documentExists(e)?i.replaceDocument(e,n):null===i||void 0===i||i.addDocument({name:Ga(e).replace(/-/g," "),template:n,slug:e})}else alert("No published document found while seeding local environment")})):alert("No data to squash.  This means the Clipboard failed to sync on your machine. Or it is still pending.  Please try again in a moment or ask someone else to squash the clipboard"))};return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("h3",{"data-qa":"toolsTitle",style:{fontWeight:400,margin:"16px 0 0 16px",fontSize:"1.1rem"}},"Tools"),Wt.default.createElement(yr.default,{className:e.root},Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{onClick:function(){n(c(t))},style:{background:"#d20102",color:"#FFF",textTransform:"none",width:"100%"}},"Reset Doc to published state")),Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{onClick:function(){n(c("clipboard"))},style:{background:"#d20102",color:"#FFF",textTransform:"none",width:"100%"}},"Reset Clipboard")),Wt.default.createElement(Er.default,null,Wt.default.createElement(Gt.default,{onClick:function(){i.requestFullDoc(t)},style:{background:"#3a3a3a",color:"#FFF",textTransform:"none",width:"100%"}},"Download Binary Document"))))},BugCapture:function(){var e=xa(),t=(null===e||void 0===e?void 0:e.user)||"Unknown",n=fl(),a=l.useRecoilValue(dl),i=a.env,d=a.apiUrl,u=o.useState(""),s=r._slicedToArray(u,2),f=s[0],p=s[1],m=o.useState(!1),v=r._slicedToArray(m,2),g=v[0],h=v[1],b=o.useState(null),y=r._slicedToArray(b,2),E=y[0],x=y[1],C=o.useRef(!1),S=o.useRef(!1),I=o.useRef([]),k={log:I,shouldStop:C,isStopped:S},_=function(){var r=c._asyncToGenerator(regeneratorRuntime.mark((function r(){var a,o,l,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="".concat(d,"/debug/report/").concat(t.toLowerCase().replace(" ",""),"-").concat(i),r.next=3,e.requestFullDoc(n,!1);case 3:return o=r.sent,l=JSON.stringify({user:t,description:f}),u=[{doc:o},{report:l},{video:E},{logs:JSON.stringify(I.current)}].map(function(){var e=c._asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,o,l,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object.keys(t)[0],!(r=t[n])){e.next=12;break}return(o=new FormData).append(n,r),e.next=7,fetch(a,{method:"POST",body:o});case 7:return l=e.sent,e.next=10,l.json();case 10:return i=e.sent,e.abrupt("return",null===i||void 0===i?void 0:i.errors);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.next=8,Promise.all(u).then((function(e){var t=e.flatMap((function(e){return e}));t.length?(console.error(t),Jt.default.error("Could not submit report")):Jt.default.success("Successfully submitted bug report")}));case 8:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("h3",{"data-qa":"bugCapture",style:{fontWeight:400,margin:"16px 0 0 16px",fontSize:"1.1rem"}},"Record bug"),Wt.default.createElement("div",{style:{padding:"16px"}},Wt.default.createElement(Va,null,Wt.default.createElement("span",null,"Description of bug / issue(s)")),Wt.default.createElement(rn.default,{onBlur:function(e){p(e.target.value)},multiline:!0,variant:"outlined",placeholder:"e.g. reordering flex features on mobile changes desktop layout",style:{width:"100%",minHeight:60,marginBottom:"16px"}}),Wt.default.createElement(Va,null,Wt.default.createElement("span",null,"Capture video"),Wt.default.createElement("span",{style:{marginLeft:8,fontSize:12,fontWeight:500,cursor:"pointer"},className:"color-primary",onClick:function(){return x(null)}},"Clear")),Wt.default.createElement("div",{style:{position:"relative"}},Wt.default.createElement("video",{style:{maxWidth:"100%",minHeight:160,background:"#d4d4d4"},controls:!!E,src:E&&!g?URL.createObjectURL(E):""}),Wt.default.createElement("span",{style:{position:"absolute",top:"50%",width:"100%",textAlign:"center",left:0,transform:"translateY(-50%)",opacity:"0.5"}},E?null:g?"Recording...":"No video")),Wt.default.createElement("div",{className:"flex mt-sm mb-xs"},Wt.default.createElement(Gt.default,{onClick:function(){C.current=!1,ti(h,k).then((function(e){return x(e)}))},style:{width:"100%",color:"#d20102",borderColor:"#d20102",border:"2px solid",marginRight:4}},Wt.default.createElement(kr.default,{style:{marginRight:4}}),"Record"),Wt.default.createElement(Gt.default,{onClick:g?function(){C.current=!0,h(!1),e.requestFullDoc(n,!1)}:void 0,className:"b bc-default color-default",style:{width:"100%",borderWidth:"2px solid",marginLeft:4,cursor:g?"pointer":"not-allowed",opacity:g?1:"0.25"}},Wt.default.createElement(Ir.default,{style:{marginRight:4}}),"Stop")),Wt.default.createElement(Gt.default,{className:"bg-primary",style:{width:"100%",textTransform:"none",margin:"8px 0"},onClick:_},"Submit bug report")))},Testing:function(){var e,t=sl(),n=Hl(),a=r._slicedToArray(n,1)[0],l=Ul(),i=r._slicedToArray(l,2),d=i[0],u=i[1],c=Ko().setDialogProps,s=El(),f=r._slicedToArray(s,2),p=f[0],m=f[1],v=o.useState(null),h=r._slicedToArray(v,2),y=h[0],E=h[1],x=rl(),C=r._slicedToArray(x,4),S=C[0],I=C[1],k=C[2],_=C[3],A=Wt.default.useCallback((function(e,t,n){return{text:e,secondaryText:t,actions:{confirm:{text:"Confirm",handler:n},close:{text:"Cancel",handler:function(){}}}}}),[]),T=0===Object.keys(S).length,w=function(e){var n=Object.values(d).filter((function(t){var n,r,a;return null===t||void 0===t||null===(n=t.props)||void 0===n||null===(r=n.variants)||void 0===r||null===(a=r[e])||void 0===a?void 0:a.props})).map((function(e){return g.objectToId(e)}));u({docId:t,mode:a},{type:g.ActionTypes.EDIT_ENTITY,featureIds:n},(function(t){n.forEach((function(n){var r,a,o,l,i,d;e&&null!==(r=t[n])&&void 0!==r&&null!==(a=r.props)&&void 0!==a&&null!==(o=a.variants)&&void 0!==o&&o[e]&&(null===(l=t[n])||void 0===l||(null===(i=l.props)||void 0===i||(null===(d=i.variants)||void 0===d||delete d[e])))}))}))},D=function(e){return function(){c(A("Clear changes?",Wt.default.createElement("p",{className:"ml-md "},"Selecting confirm will erase all changes in the variant, making it identical to the control."),(function(){w(e),m(null)})))}},j=function(e){return function(){c(A("Delete test?",Wt.default.createElement("p",{className:"ml-md "},"Selecting confirm will conclude this test and erase all variant changes."),(function(){w(e),_(e),m(null)})))}},R={handleEditTest:function(e){E(e)}};return Wt.default.createElement(Wt.default.Fragment,null,y?Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement($o,{header:"Add test",buttonClassName:"bg-primary",buttonText:"",buttonIcon:pr.default,buttonStyles:{textTransform:"none",padding:0},buttonHandler:function(){return E(null)},buttonDisabled:!1}),Wt.default.createElement("div",{style:{padding:"16px"}},Wt.default.createElement(ro,{propTypes:r._objectSpread2({},Po),fields:r._objectSpread2(r._objectSpread2({},Ro),S[y]),setEntity:function(){},onFieldChange:k(y),overridesMap:{},feature:S}))):Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement($o,{header:"Testing",buttonClassName:T?"color-primary":"",buttonText:"Add Test",buttonIcon:mr.default,buttonStyles:{color:T?"":"#d4d4d4",textTransform:"none",padding:0},buttonHandler:function(){c(A("Create new test?",Wt.default.createElement("p",{className:"ml-md "},"All variant tests need to be coordinated via product and engineering. Please speak with those groups if you have not done so already."),I))},buttonDisabled:!T}),Wt.default.createElement("div",{style:{padding:16}},null!==(e=Object.keys(S))&&void 0!==e&&e.length?Object.keys(S).map((function(e){var t=S[e],n=e===p,a=r._objectSpread2(r._objectSpread2({},R),{},{clearChanges:D(e),handleDeleteTest:j(e),id:e,isEditing:n,experiment:t,handleEditVariant:function(){return m(n?null:e)}});return Wt.default.createElement(Bo,b._extends({key:e},a))})):Wt.default.createElement("span",{style:{fontStyle:"italic",fontSize:14,color:"#3a3a3a"}},"No tests running"))))}},cd=[{name:"DocumentView",icon:ta.default},{name:"Clipboard",icon:In.default},{name:"Alerts",icon:ea.default},{name:"Testing",icon:qt.default},{name:"Tools",icon:na.default},{name:"DevTools",icon:ra.default},{name:"BugCapture",icon:aa.default}],sd=function(e){var t,n,a=e.children,l=e.onSelectDocument,i=e.alerts,d=e.showDevTools,u=dd(),c=Gl(),s=r._slicedToArray(c,2),f=s[0],p=s[1],m=f.drawerOpen,v=Wt.default.useCallback((function(e){var t=e.drawerView;return("Alerts"===t?function(e){return Wt.default.createElement($l,b._extends({},e,{alertsMap:i}))}:null)||ud[t]||function(){return null}}),[]),g=_l(),h=r._slicedToArray(g,2),y=h[0],E=h[1],x=v(f);return o.useEffect((function(){var e=function(e){(e.metaKey||e.ctrlKey)&&"b"===e.key&&p(Cl())};return window.addEventListener("keypress",e),function(){return window.removeEventListener("keypress",e)}}),[]),Wt.default.createElement(Zr.default,{variant:"persistent",open:!0,onClose:function(){return p(Cl())},className:Sn.default("",(t={},r._defineProperty(t,u.drawerOpen,m),r._defineProperty(t,u.drawerClosed,!m),t)),classes:{paper:Sn.default((n={},r._defineProperty(n,u.drawerOpen,m),r._defineProperty(n,u.drawerClosed,!m),n))}},Wt.default.createElement(ad,null,Wt.default.createElement(od,null,cd.filter((function(e){return d||"DevTools"!==e.name})).map((function(e){var t,n=e.name,a=e.icon;return Wt.default.createElement($r.default,{key:n,style:{height:"40px",boxSizing:"border-box",margin:"8px"},onClick:function(){var e=!f.drawerOpen||f.drawerView!==n;p((function(t){return r._objectSpread2(r._objectSpread2({},t),{},{drawerView:n,drawerOpen:e})}))}},Wt.default.createElement(a,{name:"".concat(n,"Icon"),className:(t=n,f.drawerView===t&&f.drawerOpen?"color-primary":"color-default")}))}))),Wt.default.createElement(ld,{style:{position:"relative"}},Wt.default.createElement(Wt.default.Suspense,{fallback:Wt.default.createElement("div",null,"loading")},y?Wt.default.createElement(ed,{key:null===y||void 0===y?void 0:y.entityId,data:y,onCancel:function(){return E(null)}}):Wt.default.createElement(gi,null,Wt.default.createElement(x,{onSelectDocument:l}))),Wt.default.createElement(rd,null)),a))},fd=Wt.default.memo((function(e){var t=e.name,n=e.sectionObjectId,r=e.classNames,a=e.onContextMenu,o=e.setIsChildCollapsed,l=e.handleCollapseSection,i=e.handleCollapseAll,d=e.handleExpandAll,u=e.isSectionCollapsed,c=e.showCollapseAll,s=e.childEntities,f=e.childCollapsedMap;return Wt.default.createElement(Er.default,{className:r},Wt.default.createElement(xr.default,null,Wt.default.createElement("h3",{"data-qa":"sectionTitle",onContextMenu:a,onClick:l,style:{cursor:"pointer",display:"flex",alignItems:"center"}},u?Wt.default.createElement(Rr.default,{name:"Expand"}):Wt.default.createElement(tn.default,{name:"Collapse"}),t)),!u&&Wt.default.createElement(Wt.default.Fragment,null,c&&Wt.default.createElement("div",{style:{textAlign:"right",padding:"4px 8px 0"}},Wt.default.createElement("a",{href:"#",onClick:i,className:"color-primary",style:{margin:"0 4px",textDecoration:"underline"}},"Collapse all"),Wt.default.createElement("a",{href:"#",onClick:d,className:"color-primary",style:{margin:"0 4px",textDecoration:"underline"}},"Expand all")),Wt.default.createElement(yr.default,null,(s||[]).map((function(e){var t=g.objectToId(e);return Wt.default.createElement(Xi,{key:t,entityRef:e,parentId:n,isCollapsed:f[t],setIsCollapsed:o(t)})})))))})),pd=function(e){var t=e.sectionRef,n=ya().mode,a=Vo(),i=r._slicedToArray(a,3)[2],d=Yo().children,u=Wl(),c=Wl(!1),s=wl(t,sl(),n),f=r._slicedToArray(s,1)[0],p=b.useComponentFields("fronts/flex-feature"),m=ho(p),v=f.children,h=f.props,y=t.id,E=l.useRecoilState(xl),x=r._slicedToArray(E,2),C=x[0],S=x[1],I=o.useContext(Qo).setMenuProps,k=Oa(),_=o.useContext(Xo).setDialogProps,A=Rl(),T=sl(),w=b.useComponentChildFeatures("section")||[],D=null!==d&&void 0!==d&&d.length?d.filter((function(e){return w.includes(e.type)})):[];Wt.default.useEffect((function(){S((function(e){return(v||[]).reduce((function(t,n){return n.id.includes("chain")?r._objectSpread2(r._objectSpread2({},t),{},r._defineProperty({},n.id,e[n.id]||!1)):t}),e)}))}),[]);var j=function(e,t){return To({entity:e,parentId:g.objectToId(f),relativePosition:t,tidyEntity:m})},R="Content"===id[h.id],P=w.map((function(e){var t=b.useComponent(e);return{label:t.name,fields:t.fields,type:e,collection:t.collection}})),F=[{label:"Add Feature/Chain",items:P.map((function(e){var t=e.label,r=e.fields,a=e.type,o=e.collection;return{label:t,onClick:function(){var e=wo(r,a,t,o);A({docId:T,mode:n},{type:g.ActionTypes.ADD_ENTITY,featureIds:[g.objectToId(e)],names:[mo(e)]},j(e,"bottom"))}}}))},{label:"Paste from Clipboard",disabled:!(null!==D&&void 0!==D&&D.length),items:null===D||void 0===D?void 0:D.map((function(e){return{label:mo(e),onClick:function(){var t=u(e),r=function(){A({docId:T,mode:n},{type:g.ActionTypes.PASTE_FROM_CLIPBOARD,featureIds:[g.objectToId(t)],names:[mo(e)]},j(t,"bottom"))},a=function(){return i(e)};e.locked?_(ji(r,a)):(r(),a())}}}))},{label:"Delete child features",disabled:!(null!==v&&void 0!==v&&v.length),onClick:function(){A({docId:T,mode:n},{type:g.ActionTypes.DELETE_ENTITIES,featureIds:P.map((function(e){return g.objectToId(e)})),names:P.map((function(e){return mo(e)||g.objectToId(e)}))},(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=c(f),r=n.children;xo({entity:r,parentId:y})(e,t)}))}},{label:"Debug",onClick:function(){console.log("ENTITY --- ",JSON.parse(JSON.stringify(f)))}}],N=function(e,t){return Object.keys(e).reduce((function(e,n){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},n,n.includes("section")?e[n]:t))}),r._objectSpread2({},e))};return Wt.default.createElement(fd,{name:id[h.id],sectionObjectId:g.objectToId(f),classNames:k.root,onContextMenu:I(F),isSectionCollapsed:C[y],handleCollapseSection:function(){return S((function(e){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},y,!e[y]))}))},showCollapseAll:R,handleCollapseAll:function(e){e.preventDefault(),S((function(e){return N(e,!0)}))},handleExpandAll:function(e){e.preventDefault(),S((function(e){return N(e,!1)}))},setIsChildCollapsed:function(e){return function(t){return S((function(n){return r._objectSpread2(r._objectSpread2({},n),{},r._defineProperty({},e,t))}))}},childEntities:v||[],childCollapsedMap:C})},md=function(){return Wt.default.createElement("div",{style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"}},Wt.default.createElement("div",{style:{border:"2px solid ".concat("#d4d4d4"),borderTop:"2px solid #7f7f7f",borderRadius:"50%",width:"80px",height:"80px",animation:"loading 1s linear infinite"}}))},vd=function(e){var t=e.docId,n=e.width,a=e.url,i=e.isReadOnly,d=xa(),u=o.useState(!0),c=r._slicedToArray(u,2),s=c[0],f=c[1],p=o.useState(!1),m=r._slicedToArray(p,2),v=m[0],g=m[1],h=o.useState(!1),b=r._slicedToArray(h,2),y=b[0],E=b[1],x=o.useState(!1),C=r._slicedToArray(x,2),S=C[0],I=C[1],k=l.useRecoilState(gl),_=r._slicedToArray(k,2),A=_[0],T=_[1],w=ya().mode,D=o.useContext(Xo).setDialogProps;o.useEffect((function(){s||f(!0)}),[n]),o.useEffect((function(){window.setChildRepo=function(e,n){e(d),n(t),setTimeout((function(){return I(!0)}),100)},E(!0)}),[]);var j=function(e){return function(t){t.stopPropagation(),g(!1),T(e)}},R=i||"draft"===w;return Wt.default.createElement(Wt.default.Fragment,null,s&&R&&Wt.default.createElement("div",{style:{position:"absolute",left:0,right:0,top:100,bottom:0,background:"rgba(0,0,0, .5)",zIndex:9}}),Wt.default.createElement("div",{style:{position:"absolute",zIndex:10,right:s?0:-n,top:100,width:n,bottom:0,background:"#fff",borderLeftWidth:"2px",borderTopWidth:"2px",borderLeftStyle:"solid",borderTopStyle:"solid",display:R?"block":"none",borderColor:"#196dfc"},onClick:i?function(){return D({text:"Editing not permitted on this page",secondaryText:Wt.default.createElement("p",{style:{margin:"20px"}},"To edit document, go to"," ",Wt.default.createElement("a",{href:"".concat(window.location.href.includes("assembler")?"/assembler":"","/admin/document/").concat(t),target:"_blank"},"admin page")),actions:{close:{text:"Close",handler:function(){}}}})}:void 0},Wt.default.createElement(Gt.default,{style:{width:55,height:55,minWidth:0,position:"absolute",top:-2,left:-55,color:"#fff",borderRadius:"3px 0 0 3px",fontSize:"1.25rem",opacity:s?1:.75,background:"#196dfc"},className:"hover-opacity-full",onClick:function(e){e.stopPropagation(),f(!s)},title:"Show / Hide Window"},s?Wt.default.createElement(sr.default,{fontSize:"inherit"}):Wt.default.createElement(sr.default,{style:{transform:"rotate(180deg)"},fontSize:"inherit"})),Wt.default.createElement(Gt.default,{style:{width:55,height:55,minWidth:0,position:"absolute",top:58,left:-55,color:"#fff",borderRadius:"3px 0 0 3px",fontSize:"1.25rem",opacity:s?1:.75,background:"#196dfc"},className:"hover-opacity-full",onClick:function(e){e.stopPropagation(),g(!0),f(!0)},title:"Change Window Width"},Wt.default.createElement(fr.default,{fontSize:"inherit"}),v&&Wt.default.createElement(En.default,{onClickAway:function(){return g(!1)}},Wt.default.createElement("div",{style:{position:"absolute",zIndex:1,borderRadius:"4px",padding:"8px 0",background:"#fff",boxShadow:"0px 5px 5px -3px rgb(0 0 0 / 20%), 0px 8px 10px 1px rgb(0 0 0 / 14%), 0px 3px 14px 2px rgb(0 0 0 / 12%)"}},Object.keys(jo).map((function(e){var t=jo[e].icon;return Wt.default.createElement(Kt.default,{key:e,value:e,style:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:".875rem",display:"flex",textTransform:"none"},className:e===A?"color-primary":"color-default",onClick:j(e)},Wt.default.createElement(t,{style:jo[e].style}),jo[e].name)}))))),Wt.default.createElement(Gt.default,{style:{width:55,height:55,minWidth:0,position:"absolute",top:116,left:-55,color:"#fff",borderRadius:"3px 0 0 3px",fontSize:"1.25rem",opacity:s?1:.75,background:"#196dfc"},className:"hover-opacity-full",onClick:function(e){e.stopPropagation(),T(Do)},title:"Close Device Window"},Wt.default.createElement(pr.default,{fontSize:"inherit"})),!S&&Wt.default.createElement(md,null),y?Wt.default.createElement("iframe",{style:{width:"100%",height:"100%",border:"none",pointerEvents:i?"none":"auto"},src:a}):null))},gd=function(e){var t=e.children,n=e.value,a=Wt.default.useRef();return Wt.default.createElement(b.FeatureContext.Provider,{value:r._objectSpread2({interactions:{},selectors:{interactiveState:{},styles:{},OverlayBar:function(){return null},overlay:null,overlayLeft:null},ref:a},n)},t)},hd=function(e){var t=e.children;return Wt.default.createElement(b.ChainContext.Provider,{value:{interactions:{},selectors:{interactiveState:{},styles:{},OverlayBar:function(){return null},overlay:null,overlayLeft:null,ChainColumnDropTarget:function(){return null}},showHelpers:!1,dataAttrs:{}}},t)},bd=Wt.default.memo((function(e){var t=e.props,n=e.context,r=b.useComponentMap(null===t||void 0===t?void 0:t.type);return Wt.default.createElement(gd,{value:t},Wt.default.createElement(b.ComponentProvider,{value:t.props},Wt.default.createElement(r,b._extends({},t.props,{context:n}))))})),yd=Wt.default.memo((function(e){var t=ll(),n=e.props,a=e.children,o=void 0===a?[]:a,l=b.useAppContext(),i=Wt.default.useMemo((function(){return r._objectSpread2(r._objectSpread2({},e),{},{children:o.map((function(e){return Wt.default.createElement(bd,{context:l,key:g.objectToId(e),props:e})})),childProps:o.map((function(e){var n;return null===(n=t(e))||void 0===n?void 0:n.props})),context:l})}),[e,l,o]),d=b.useComponentMap(null===e||void 0===e?void 0:e.type);return Wt.default.createElement(hd,null,Wt.default.createElement(b.ComponentProvider,{value:n},Wt.default.createElement(d,b._extends({},i.props,{context:i.context,children:i.children,childProps:i.childProps}))))})),Ed=Wt.default.memo((function(e){var t=e.children,n=b.useAppContext();return t.map((function(e){var t=e.collection,r=e.props;return"chains"===t?Wt.default.createElement(yd,b._extends({key:g.objectToId(r)},e)):"features"===t?Wt.default.createElement(bd,{key:g.objectToId(r),props:e,context:n}):null}))})),xd=function(e){var t=sl(),n=ya().mode,a=wl(e,t,n),o=r._slicedToArray(a,1)[0],l=b.useAppContext(),i=Rl(),d=o.collection;o.type;var u={hoverable:!0,selectable:!0,draggable:!0,showMenu:!0},c=o.props;return c.settings=u,"chains"===d?Wt.default.createElement(Li,b._extends({parentId:e.sectionId,removeSelf:function(r){return a=o,void i({docId:t,mode:n},{type:r?g.ActionTypes.CUT_TO_CLIPBOARD:g.ActionTypes.DELETE_ENTITY,featureIds:[g.objectToId(a)],names:[mo(a)]},xo({entity:a,parentId:e.sectionId}));var a},settings:{hoverable:!0,selectable:!0,draggable:!0},featureSettings:u},o,{docId:t,mode:n})):"features"===d?Wt.default.createElement(Fi,{props:c,context:l,parentId:e.sectionId,docId:t,mode:n}):null},Cd=function(e){var t=wl(e,sl(),ya().mode),n=r._slicedToArray(t,1)[0];if(!n)return null;var a=n.children.map((function(e,t){return Wt.default.createElement(xd,b._extends({key:"adminRenderable-".concat(g.objectToId(e),"-").concat(t)},e,{sectionId:g.objectToId(n)}))}));return Wt.default.createElement(Wt.default.Fragment,null,a)},Sd=function(e){var t=e.tree,n=b.useComponentMap("wrapper"),r=b.useComponentMap(null===t||void 0===t?void 0:t.type),a=null===t||void 0===t?void 0:t.children.map((function(e){return Wt.default.createElement(n,b._extends({key:e.id},e))}));return Wt.default.createElement(r,null,a)},Id=yn.default("span")({display:"flex",fontSize:"1rem",width:"100%",justifyContent:"space-between",alignItems:"center"}),kd=function(e){var t=e.text,n=e.children,a=o.useState(),l=r._slicedToArray(a,2),i=l[0],d=l[1];return Wt.default.createElement("div",{onMouseEnter:function(e){return d((null===e||void 0===e?void 0:e.currentTarget)||(null===e||void 0===e?void 0:e.target))},onMouseLeave:function(){d(void 0)}},Wt.default.createElement(Kt.default,null,Wt.default.createElement(Id,null,Wt.default.createElement("span",null,t)," ",Wt.default.createElement(ua.default,{fontSize:"inherit",className:"mr-xxs"}))),Wt.default.createElement(Fr.default,{style:{pointerEvents:"none"},open:Boolean(i),anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null},Wt.default.createElement("div",{style:{pointerEvents:"auto"}},n)))},_d=function(e){var t=e.anchorEl,n=e.anchorPosition,r=e.anchorReference,a=e.handleClose,o=e.items,l=function(e){return function(t){e&&e(t),a(t)}};return Wt.default.createElement(En.default,{onClickAway:a},Wt.default.createElement(Fr.default,{open:Boolean(t),anchorEl:t,anchorReference:r,anchorPosition:n,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},getContentAnchorEl:null,keepMounted:!0},null===o||void 0===o?void 0:o.map((function(e,t){var n=e.label,r=e.onClick,a=e.items,o=e.disabled;return null!==a&&void 0!==a&&a.length?Wt.default.createElement(kd,{text:n,key:"".concat(n,"-").concat(t)},a.map((function(e,t){return Wt.default.createElement(Kt.default,{onClick:l(null===e||void 0===e?void 0:e.onClick),key:"".concat(e.label,"-").concat(t)},e.label)}))):Wt.default.createElement("div",{style:{color:o?"gray":"inherit",pointerEvents:o?"none":"inherit"}},Wt.default.createElement(Kt.default,{onClick:l(r),key:"".concat(n,"-").concat(t)},n))}))))},Ad=function(e){var t=e.children,n=o.useState(),a=r._slicedToArray(n,2),l=a[0],i=a[1],d=o.useState(),u=r._slicedToArray(d,2),c=u[0],s=u[1],f=o.useState(),p=r._slicedToArray(f,2),m=p[0],v=p[1];return Wt.default.createElement(Qo.Provider,{value:{setMenuProps:function(e,t){return function(n){n.preventDefault(),v(e),console.log("setMenuProps",(null===n||void 0===n?void 0:n.currentTarget)||(null===n||void 0===n?void 0:n.target)),i((null===n||void 0===n?void 0:n.currentTarget)||(null===n||void 0===n?void 0:n.target)),t&&s({top:null===n||void 0===n?void 0:n.clientY,left:null===n||void 0===n?void 0:n.clientX})}}}},t,Wt.default.createElement(_d,{anchorEl:l,anchorPosition:c,anchorReference:c?"anchorPosition":"anchorEl",items:m,handleClose:function(e){var t;(null===e||void 0===e?void 0:e.target)!==l&&(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.parentElement)!==l&&(i(void 0),s(void 0),v(void 0))}}))},Td=yn.default(bn.default)({zIndex:1200}),wd=function(e){var t=e.items,n=e.anchorEl,a=e.handleClose,l=e.imageConfig,i=o.useContext(Zo),d=ri(),u=ai(),c=o.useState(),s=r._slicedToArray(c,2),f=s[0],p=s[1];return Wt.default.createElement("div",{ref:i},Wt.default.createElement(En.default,{onClickAway:a},Wt.default.createElement(Td,{open:!!n,anchorEl:n,transition:!0,placement:"top",modifiers:{preventOverflow:{enabled:!0,boundariesElement:"viewport"}}},Wt.default.createElement(xn.default,{position:"static",color:"default"},Wt.default.createElement("div",{className:"relative"},null===t||void 0===t?void 0:t.map((function(e){var t=e.type,n=e.props,a=e.initialVals,o=e.handlers;if("button"===t){var i,c=n.iconName,s=n.label,m=a||{},v=m.selected,g=m.disabled,h=o.onClick;return Wt.default.createElement(Cn.default,{key:c,className:Sn.default(d.root,(i={},r._defineProperty(i,d.selected,v),r._defineProperty(i,d.disabled,g),i)),icon:Wt.default.createElement(Kl,{icon:c,label:s}),onClick:g?void 0:h})}if("textInput"===t||"textArea"===t){var y=n.iconName,E=n.label,x=(a||{}).defaultValue,C=o.onBlur,S=void 0!==("undefined"===typeof window?"undefined":b._typeof(window))&&window.innerWidth;return E&&Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Cn.default,{className:Sn.default(d.root,r._defineProperty({},d.selected,f===E)),icon:Wt.default.createElement(Kl,{icon:y,label:E}),onClick:function(e){e.preventDefault(),e.stopPropagation(),p(f===E?void 0:E)}}),f===E&&Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},ni),{},{width:"350px",left:S<=900?"":0,right:S<=900?"-30px":""})},Wt.default.createElement(nn.default,{className:"w-100 bg-white ".concat(l?"paste-html":"")},Wt.default.createElement(rn.default,{multiline:!0,type:"text",defaultValue:x,onBlur:C,label:E,variant:"outlined",onFocus:function(e){"textInput"===t&&e.target.select()},onClick:function(e){e.preventDefault(),e.stopPropagation()},rows:l?"textArea"===t?9:3:void 0,rowsMax:"textArea"===t?9:3}))))}if("select"===t){var I,k=n.labelIcon,_=a.defaultValue,A=o.onChange;return Wt.default.createElement("div",{key:n.labelIcon,className:"dib bg-white",style:{border:"1px solid #c1c1c1",borderRadius:"2px",marginRight:"4px"}},Wt.default.createElement(Cn.default,{className:"".concat(d.noPointerEvents," ").concat(d.root),icon:Wt.default.createElement(Kl,{icon:k})}),Wt.default.createElement(Zt.default,{className:u.root,defaultValue:_,onChange:A},null===n||void 0===n||null===(I=n.items)||void 0===I?void 0:I.map((function(e){var t=r._slicedToArray(e,2),n=t[0],a=t[1];return Wt.default.createElement(Kt.default,{key:n,value:n},a)}))))}if("numberSelect"===t){var T=n.label,w=n.iconName,D=a.defaultValue,j=o.onChange;return Wt.default.createElement(Wt.default.Fragment,{key:w},Wt.default.createElement(Cn.default,{className:d.root,icon:Wt.default.createElement(Kl,{icon:w,label:T}),onClick:function(){return p(f===T?void 0:T)}}),f===T&&Wt.default.createElement("div",{style:r._objectSpread2(r._objectSpread2({},ni),{},{width:"115px"})},Wt.default.createElement(rn.default,{label:T,type:"number",variant:"outlined",defaultValue:D,onChange:j,onFocus:function(e){e.target.select()}})))}return null})))))))},Dd=function(e){var t=e.children,n=o.useRef(null);return Wt.default.createElement(Zo.Provider,{value:{menuRef:n}},t)},jd=function(e){var t=l.useRecoilState(ul),n=r._slicedToArray(t,2),a=n[0],o=n[1];return Wt.default.useEffect((function(){e&&o((function(){return e}))}),[e]),a},Rd=function(e){var t=e.user,n=e.changeData,a=e.isShown,o=e.setIsShown;return Wt.default.createElement("div",{style:{margin:"0 18px 0 0",padding:"12px 0px 12px 18px",borderBottom:"1px solid ".concat("#d4d4d4")}},Wt.default.createElement("p",{style:{textShadow:"0 0 black",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},"data-qa":"changelog-change-group",onClick:function(){return o(!a)}},Wt.default.createElement("span",null,t,Wt.default.createElement("br",null),Oo(n.timestamp)),a?Wt.default.createElement(en.default,null):Wt.default.createElement(tn.default,null)),a&&Object.entries(n.features).map((function(e,t){var a=r._slicedToArray(e,2),o=a[0],l=a[1];return Wt.default.createElement("div",{key:o,style:{borderBottom:t<Object.entries(n.features).length-1?"1px solid ".concat("#d4d4d4"):""}},l.map((function(e){var t=e.name,n=e.type,r=e.fieldsChanged,a=function(e){var t=No["".concat(e)]||"DEFAULT";return Fo[t]}(n);return Wt.default.createElement("p",{key:"".concat(t,"-").concat(r),"data-qa":"changelog-change-details",style:{borderLeft:"2px solid ".concat(a[0]),margin:"8px 0",padding:"0 8px",opacity:.8}},t,": ",r?"".concat(r," "):"",a[1])})))})))},Pd=function(e){var t=e.changes,n=e.date,a=e.user,l=o.useState(null),i=r._slicedToArray(l,2),d=i[0],u=i[1],s=function(e){if(!e)return{changesByUser:{},totalLength:0};var t=0,n=e.reduce((function(e,n){var a=n.featureIds,o=n.type,l=n.user,i=n.name,d=n.names,u=n.timestamp,s=n.fieldsChanged;if("PUSH"===o&&(e[l]=r._objectSpread2(r._objectSpread2({},e[l]),{},{timestamp:u})),!a)return e;var f=e[l]||(e[l]={}&&{}),p=f.timestamp||0;e[l].timestamp=u>p?u:p;var m=f.features||{},v=(a||[]).reduce((function(e,n,r){var a=m[n]||[];return a.find((function(e){return e.type===o&&e.fieldsChanged===s}))||(++t,e[n]=[].concat(c._toConsumableArray(a),[{type:o,name:(null===d||void 0===d?void 0:d[r])||i||n,timestamp:u,featureId:n,fieldsChanged:s}])),e}),{});return e[l].features=r._objectSpread2(r._objectSpread2({},m),v),e}),{});return{totalLength:t,changesByUser:n}}(t),f=s.changesByUser,p=s.totalLength,m=1===t.length,v=Object.keys(f||{}).reduce((function(e,t){return e[t]=!1,e}),{}),g=o.useState(v),h=r._slicedToArray(g,2),b=h[0],y=h[1];return a&&n?Wt.default.createElement("div",{style:{position:"relative"}},Wt.default.createElement("span",{style:{cursor:"pointer",margin:"0 4px",display:"flex",alignItems:"center"},"data-qa":"changelog",onClick:function(e){e.stopPropagation();var t=null===e||void 0===e?void 0:e.target;u((function(e){return e?null:t}))}}," ",p||"No"," staged change",m?"":"s"," ",d?Wt.default.createElement(sa.default,{fontSize:"inherit"}):Wt.default.createElement(fa.default,{fontSize:"inherit"})),d?Wt.default.createElement(pa.default,{anchorEl:d,open:!!d,onClose:function(){return u(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"}},Wt.default.createElement("div",{style:{width:"275px",maxHeight:"350px",boxSizing:"border-box",fontSize:"14px",overflow:"auto"},"data-qa":"changelog-dropdown"},Wt.default.createElement("p",{style:{fontWeight:700,margin:"0 0 4px",fontSize:"16px",padding:"18px 18px 0"}},"Shared Homepage Change Log"),Wt.default.createElement("p",{style:{opacity:.8,margin:"8px 0 8px",padding:"0 18px"}},"Last published ",n," by ",a),p?Wt.default.createElement("p",{style:{fontWeight:700,margin:"8px 0 0",padding:"0 18px"}},"Staged changes"):null,Object.entries(f).sort((function(e,t){return e[1].timestamp>t[1].timestamp?-1:1})).map((function(e){var t=r._slicedToArray(e,2),n=t[0],a=t[1];return Wt.default.createElement(Rd,{user:n,changeData:a,isShown:b[n],setIsShown:function(e){return y(r._objectSpread2(r._objectSpread2({},b),{},r._defineProperty({},n,e)))}})})))):null):null},Fd=function(e){var t=e.toggleDeviceIframe,n=e.deviceIframe,r=ai(),a=jo[n].icon;return Wt.default.createElement("span",{style:{position:"relative"}},Wt.default.createElement(a,{className:"MuiButton-iconSizeMedium ".concat("desktop_mx"!==n?"color-primary":"color-default"),style:{position:"absolute",fontSize:"1.25rem",top:"0",left:"8px"}}),Wt.default.createElement(Zt.default,{className:"".concat(r.root," ").concat(r.paddingLeft," ").concat("desktop_mx"!==n?"color-primary":"color-default"),value:n,onChange:function(e){t(e.target.value)},style:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:".875rem",top:"1px"}},Object.keys(jo).map((function(e){return Wt.default.createElement(Kt.default,{key:e,value:e,className:"color-default",style:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:".875rem"}},jo[e].name)}))))},Nd=function(e){var t=e.id,n=e.className,r=e.toggleDeviceIframe,a=jo[t].icon;return Wt.default.createElement(Gt.default,{style:{textTransform:"none",height:30,minWidth:0},className:n,onClick:r},Wt.default.createElement(a,{style:jo[t].style}),jo[t].name)},Od=function(e){var t=e.activeColorClass,n=Wt.default.useState(!1),a=r._slicedToArray(n,2),o=a[0],i=a[1],d=l.useRecoilState(gl),u=r._slicedToArray(d,2),c=u[0],s=u[1],f=Ba((function(){i(window.innerWidth<=1250)})).callback;return Wt.default.useEffect((function(){return window.addEventListener("resize",f),function(){window.removeEventListener("resize",f)}}),[]),o?Wt.default.createElement(Fd,{deviceIframe:c,toggleDeviceIframe:function(e){return s(e)}}):Wt.default.createElement("span",{style:{position:"relative"}},Object.keys(jo).reverse().map((function(e){return Wt.default.createElement(Nd,{key:e,id:e,className:c===e?t:"color-default",toggleDeviceIframe:(n=e,function(){s(c===n?Do:n)})});var n})))},Ld=function(e){var t,n=e.docSize,o=e.colorClasses,i=e.description,d=e.revert,u=e.revertEnabled,c=e.date,s=e.user,f=e.changes,p=e.buttonText,m=e.buttonHandler,v=e.disabled,g=e.mode,h=l.useRecoilState(ml),b=r._slicedToArray(h,2),y=b[0],E=b[1],x=l.useRecoilState(vl),C=r._slicedToArray(x,2),S=C[0],I=C[1],k=l.useRecoilState(hl),_=r._slicedToArray(k,2),A=_[0],T=_[1],w=l.useRecoilState(bl),D=r._slicedToArray(w,2),j=D[0],R=D[1],P="remote"===g,F=a.useTheme(),N=vn.default({root:(t={},r._defineProperty(t,F.breakpoints.down("sm"),{display:"none"}),r._defineProperty(t,"display","block"),t)})();return Wt.default.createElement("div",{className:"".concat(o.background,"-10"),style:{display:"flex",justifyContent:"space-between",padding:"8px",height:"46px",boxSizing:"border-box"},"data-qa":"docPublishBar"},Wt.default.createElement("div",null,P&&Wt.default.createElement(Gt.default,{"data-qa":"doc-lock-btn",className:A?o.text:"color-default",style:{animation:j&&A?"pulse 2s":"",textTransform:"none",height:30},onClick:function(){return T(!A)},startIcon:A?Wt.default.createElement(ma.default,{fontSize:"inherit"}):Wt.default.createElement(va.default,{fontSize:"inherit"}),onAnimationEnd:function(){return R(!1)}},Wt.default.createElement("span",null,A?"Locked":"Unlocked")),d&&Wt.default.createElement(Gt.default,{"data-qa":"doc-revert-btn",style:{textTransform:"none",margin:"0 -8px 0 8px",height:30},onClick:d,disabled:!u,startIcon:Wt.default.createElement(ca.default,{fontSize:"inherit",style:{transform:"rotate(-45deg)",marginRight:"-4px"}})},"Revert"),Wt.default.createElement(Gt.default,{"data-qa":"doc-show-helpers-btn",className:y?o.text:"color-default",style:{margin:"0 0 0 8px",textTransform:"none",height:30},onClick:function(){return E(!y)},startIcon:Wt.default.createElement(hr.default,{fontSize:"inherit"})},"Helpers"),Wt.default.createElement(Gt.default,{"data-qa":"doc-balance-rowspans-btn",className:S?o.text:"color-default",style:{textTransform:"none",height:30},onClick:function(){return I(!S)},startIcon:Wt.default.createElement(Vt.default,{fontSize:"inherit",style:{transform:"rotate(-45deg)"}})},"Balance"),!P&&Wt.default.createElement(Od,{activeColorClass:o.text})),Wt.default.createElement("div",{style:{display:"flex",alignItems:"center"}},i&&Wt.default.createElement("span",{className:"".concat(N.root," color-default"),style:{fontWeight:100,padding:"2px 8px 0",opacity:.8}},i),c&&f&&Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("span",{className:"color-default",style:{opacity:.8,margin:"0 4px"}},"|"),Wt.default.createElement(Pd,{changes:f,date:c,user:s})),Wt.default.createElement("span",{className:"".concat(o.text," b ").concat(o.border),style:{margin:"0 8px",borderWidth:"2px",borderRadius:"4px",padding:"2px 8px"}},n||0," kb"),m&&Wt.default.createElement(Gt.default,{"data-qa":"doc-push-btn",className:"".concat(o.background),style:{textTransform:"none",margin:"0 8px",color:"#fff",padding:"6px 20px",height:30},disabled:v,onClick:function(){m(),P&&!A&&T(!0)},variant:"contained"},p)))},Md=function(){var e=Wt.default.useState(""),t=r._slicedToArray(e,2),n=t[0],a=t[1],o=Wt.default.useState("#1f8925"),l=r._slicedToArray(o,2),i=l[0],d=l[1],u=function(){if("undefined"!==typeof window){var e=window.innerWidth;e>=1400?(a("Desktop - MX"),d("#1f8925")):e>=1150&&e<1400?(a("Desktop - LG"),d("#1f8925")):e>=900&&e<1150?(a("Desktop - MD"),d("#1f8925")):e>=768&&e<900?(a("Tablet - SM"),d("#ecaf2d")):(a("Mobile - XS"),d("#196dfc"))}},c=Ba(u,100);return Wt.default.useEffect((function(){return u(),window.addEventListener("resize",c.callback),function(){return window.removeEventListener("resize",c.callback)}}),[]),Wt.default.createElement("div",{style:{display:"flex",background:i,justifyContent:"space-between",padding:"8px",height:"28px",fontSize:"12px",color:"#f1f6ff",boxSizing:"border-box"},"data-qa":"docWindowResizeBar"},Wt.default.createElement("strong",null,n))},zd=Wt.default.memo(Md),Bd={remote:"Publish",draft:"Push",recover:"Close",default:"",loading:"Loading..."},Hd={remote:"Last published",draft:"Last pushed",recover:"",default:""},Ud=function(e){var t=e.handleClose,n=e.handleSubmit;return Wt.default.createElement(pn.default,{open:!0,onClose:t},Wt.default.createElement("div",{style:{maxWidth:500}},Wt.default.createElement("h4",{style:{padding:"16px 24px",fontSize:16,marginTop:"16px"}},"Are you sure you want to revert?"),Wt.default.createElement(mn.default,null,Wt.default.createElement("div",{style:{color:"#3a3a3a"}},Wt.default.createElement("p",{style:{marginBottom:"8px",fontSize:16}},"If you revert, the Shared Draft will be replaced by the most recently published homepage. Any recent changes will be lost."),Wt.default.createElement("p",null,"Tip: Use the clipboard to preserve staged changes before you revert."))),Wt.default.createElement(Sr.default,{style:{margin:"0 24px 16px"}},Wt.default.createElement(Gt.default,{onClick:t,autoFocus:!0,style:{textTransform:"none",color:"#3a3a3a"}},"Cancel"),Wt.default.createElement(Gt.default,{onClick:n,style:{background:"#d20102",color:"#FFF",textTransform:"none"}},"Revert"))))},Wd=function(e){var t,n=e.docId,a=Hl(),i=r._slicedToArray(a,2),d=i[0],u=i[1],c=o.useState(!1),s=r._slicedToArray(c,2),f=s[0],p=s[1],m=Fl(),v=Pl(),g=Sa().find((function(e){return e.docId===n})),h=Ol(),b=El(),y=r._slicedToArray(b,2)[1],E=o.useState(!1),x=r._slicedToArray(E,2),C=x[0],S=x[1],I=Ll(),k=Nl(),_=zl(),A=_.timestamp,T=_.user,w=Bl(),D=Wt.default.useCallback((function(){return S(!1)}),[]),j="draft"===d,R="remote"===d,P=Bd[d],F=Wt.default.useMemo((function(){return Oo}),[]),N=A?F(A):null,O=N?"".concat(Hd[d],": ").concat(N):"",L=j?function(){y(null),w()}:null,M=function(e){return function(t){t.preventDefault(),t.stopPropagation(),u(e)}},z=!0===l.useRecoilValue(hl),B=R&&z?(t={position:"-webkit-sticky"},r._defineProperty(t,"position","sticky"),r._defineProperty(t,"top",0),r._defineProperty(t,"zIndex",1001),r._defineProperty(t,"backgroundColor","white"),t):{};return Wt.default.createElement("div",{style:r._objectSpread2({borderBottom:"1px solid ".concat("#d4d4d4")},B),"data-qa":"docUtilityBar"},Wt.default.createElement("div",{style:{borderBottom:"1px solid ".concat("#d4d4d4"),display:"flex"},"aria-label":"documents"},["remote","draft"].map((function(e){var t="remote"===e,n=t&&R||!t&&j;return Wt.default.createElement(di,{key:e,isActive:n,colorClass:t?"alternate":"primary",handleClickTab:M(e),showDot:t&&(null===k||void 0===k?void 0:k.length)>0||!t&&I,tabText:t?g.name:"My Draft",mode:e})}))),Wt.default.createElement(ql,null),Wt.default.createElement(Ld,{colorClasses:{background:j?"bg-primary":"bg-alternate",text:j?"color-primary":"color-alternate",border:j?"bc-primary":"bc-alternate"},revert:L,revertEnabled:"remote"===d?k.length>0:I,description:O,date:N,user:T,changes:"remote"===d?k:void 0,disabled:!!f,buttonHandler:function(){p(!0);var e=function(){p(!1)};return(j?m:v)(e).catch((function(t){Jt.default.error(t.message),e()}))},buttonText:f?Bd.loading:P,mode:d,docSize:h}),C&&Wt.default.createElement(Ud,{handleClose:D,handleSubmit:function(){w(),D()}}),Wt.default.createElement(zd,null))},Gd=function(e){var t=e.children,n=Wt.default.useRef(),r=function(){document.querySelectorAll("[class*=dragging]").forEach((function(e){return e.classList.remove("dragging","dragging-top","dragging-bottom","dragging-small","dragging-center","overflow-hidden")}))},a=function(e){n.current=e,e||r()},o=r;return Wt.default.createElement(Wo.Provider,{value:{setDragEntity:a,getDragEntity:function(){return n.current},handleDragStart:function(e,t){return function(n){t&&null!==n&&void 0!==n&&n.dataTransfer&&n.dataTransfer.setDragImage(t,0,0),a(e)}},handleDragEnd:o}},t)},Vd=function(){return Wt.default.createElement("style",{dangerouslySetInnerHTML:{__html:":root{--light-gray:#d4d4d4;--dark-gray:#3a3a3a;--bright-blue:#196dfc;--purple:#6814c9;--green:#1f8925;--yellow:#ecaf2d;--red:#d20102;--warning-yellow:#d9a129;--light-bright-blue:#196dfc10;--light-purple:#6814c910;--light-warning-yellow:#d9a12910;--default-color:var(--dark-gray);--primary-color:var(--bright-blue);--alternate-color:var(--purple);--success-color:var(--green);--error-color:var(--red);--warning-color:var(--warning-yellow);--primary-color-light:var(--light-bright-blue);--alternate-color-light:var(--light-purple);--warning-color-light:var(--light-warning-yellow);--drop-zone-placeholder-height:60px;--drop-zone-small-placeholder-height:4px;--drop-zone-margin:20px;--drop-zone-small-margin:2px;--drop-zone-height:80px;--drop-zone-small-height:6px;--drop-zone-background:var(--light-gray)}.toast-title{font-weight:700}.toast-message{-ms-word-wrap:break-word;word-wrap:break-word}.toast-message a,.toast-message label{color:#fff}.toast-message a:hover{color:#ccc;text-decoration:none}.toast-close-button{position:relative;right:-.3em;top:-.3em;float:right;font-size:20px;font-weight:700;color:#fff;-webkit-text-shadow:0 1px 0 #fff;text-shadow:0 1px 0 #fff;opacity:.8;line-height:1}.toast-close-button:focus,.toast-close-button:hover{color:#000;text-decoration:none;cursor:pointer;opacity:.4}.rtl .toast-close-button{left:-.3em;float:left;right:.3em}button.toast-close-button{padding:0;cursor:pointer;background:0 0;border:0;-webkit-appearance:none}.toast-top-center{top:0;right:0;width:100%}.toast-bottom-center{bottom:0;right:0;width:100%}.toast-top-full-width{top:0;right:0;width:100%}.toast-bottom-full-width{bottom:0;right:0;width:100%}.toast-top-left{top:12px;left:12px}.toast-top-right{top:12px;right:12px}.toast-bottom-right{right:12px;bottom:12px}.toast-bottom-left{bottom:12px;left:12px}#toast-container{position:fixed;z-index:999999;pointer-events:none}#toast-container *{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#toast-container>div{position:relative;pointer-events:auto;overflow:hidden;margin:0 0 6px;padding:16px;width:350px;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-position:15px center;background-repeat:no-repeat;-moz-box-shadow:0 0 12px #999;-webkit-box-shadow:0 0 12px #999;box-shadow:0 0 12px #999;color:#fff;opacity:1}#toast-container>div.rtl{direction:rtl;padding:15px 50px 15px 15px;background-position:right 15px center}#toast-container>div:hover{-moz-box-shadow:0 0 12px #000;-webkit-box-shadow:0 0 12px #000;box-shadow:0 0 12px #000;opacity:1;cursor:pointer}#toast-container>.toast-info{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGwSURBVEhLtZa9SgNBEMc9sUxxRcoUKSzSWIhXpFMhhYWFhaBg4yPYiWCXZxBLERsLRS3EQkEfwCKdjWJAwSKCgoKCcudv4O5YLrt7EzgXhiU3/4+b2ckmwVjJSpKkQ6wAi4gwhT+z3wRBcEz0yjSseUTrcRyfsHsXmD0AmbHOC9Ii8VImnuXBPglHpQ5wwSVM7sNnTG7Za4JwDdCjxyAiH3nyA2mtaTJufiDZ5dCaqlItILh1NHatfN5skvjx9Z38m69CgzuXmZgVrPIGE763Jx9qKsRozWYw6xOHdER+nn2KkO+Bb+UV5CBN6WC6QtBgbRVozrahAbmm6HtUsgtPC19tFdxXZYBOfkbmFJ1VaHA1VAHjd0pp70oTZzvR+EVrx2Ygfdsq6eu55BHYR8hlcki+n+kERUFG8BrA0BwjeAv2M8WLQBtcy+SD6fNsmnB3AlBLrgTtVW1c2QN4bVWLATaIS60J2Du5y1TiJgjSBvFVZgTmwCU+dAZFoPxGEEs8nyHC9Bwe2GvEJv2WXZb0vjdyFT4Cxk3e/kIqlOGoVLwwPevpYHT+00T+hWwXDf4AJAOUqWcDhbwAAAAASUVORK5CYII=)!important}#toast-container>.toast-error{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHOSURBVEhLrZa/SgNBEMZzh0WKCClSCKaIYOED+AAKeQQLG8HWztLCImBrYadgIdY+gIKNYkBFSwu7CAoqCgkkoGBI/E28PdbLZmeDLgzZzcx83/zZ2SSXC1j9fr+I1Hq93g2yxH4iwM1vkoBWAdxCmpzTxfkN2RcyZNaHFIkSo10+8kgxkXIURV5HGxTmFuc75B2RfQkpxHG8aAgaAFa0tAHqYFfQ7Iwe2yhODk8+J4C7yAoRTWI3w/4klGRgR4lO7Rpn9+gvMyWp+uxFh8+H+ARlgN1nJuJuQAYvNkEnwGFck18Er4q3egEc/oO+mhLdKgRyhdNFiacC0rlOCbhNVz4H9FnAYgDBvU3QIioZlJFLJtsoHYRDfiZoUyIxqCtRpVlANq0EU4dApjrtgezPFad5S19Wgjkc0hNVnuF4HjVA6C7QrSIbylB+oZe3aHgBsqlNqKYH48jXyJKMuAbiyVJ8KzaB3eRc0pg9VwQ4niFryI68qiOi3AbjwdsfnAtk0bCjTLJKr6mrD9g8iq/S/B81hguOMlQTnVyG40wAcjnmgsCNESDrjme7wfftP4P7SP4N3CJZdvzoNyGq2c/HWOXJGsvVg+RA/k2MC/wN6I2YA2Pt8GkAAAAASUVORK5CYII=)!important}#toast-container>.toast-success{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADsSURBVEhLY2AYBfQMgf///3P8+/evAIgvA/FsIF+BavYDDWMBGroaSMMBiE8VC7AZDrIFaMFnii3AZTjUgsUUWUDA8OdAH6iQbQEhw4HyGsPEcKBXBIC4ARhex4G4BsjmweU1soIFaGg/WtoFZRIZdEvIMhxkCCjXIVsATV6gFGACs4Rsw0EGgIIH3QJYJgHSARQZDrWAB+jawzgs+Q2UO49D7jnRSRGoEFRILcdmEMWGI0cm0JJ2QpYA1RDvcmzJEWhABhD/pqrL0S0CWuABKgnRki9lLseS7g2AlqwHWQSKH4oKLrILpRGhEQCw2LiRUIa4lwAAAABJRU5ErkJggg==)!important}#toast-container>.toast-warning{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGYSURBVEhL5ZSvTsNQFMbXZGICMYGYmJhAQIJAICYQPAACiSDB8AiICQQJT4CqQEwgJvYASAQCiZiYmJhAIBATCARJy+9rTsldd8sKu1M0+dLb057v6/lbq/2rK0mS/TRNj9cWNAKPYIJII7gIxCcQ51cvqID+GIEX8ASG4B1bK5gIZFeQfoJdEXOfgX4QAQg7kH2A65yQ87lyxb27sggkAzAuFhbbg1K2kgCkB1bVwyIR9m2L7PRPIhDUIXgGtyKw575yz3lTNs6X4JXnjV+LKM/m3MydnTbtOKIjtz6VhCBq4vSm3ncdrD2lk0VgUXSVKjVDJXJzijW1RQdsU7F77He8u68koNZTz8Oz5yGa6J3H3lZ0xYgXBK2QymlWWA+RWnYhskLBv2vmE+hBMCtbA7KX5drWyRT/2JsqZ2IvfB9Y4bWDNMFbJRFmC9E74SoS0CqulwjkC0+5bpcV1CZ8NMej4pjy0U+doDQsGyo1hzVJttIjhQ7GnBtRFN1UarUlH8F3xict+HY07rEzoUGPlWcjRFRr4/gChZgc3ZL2d8oAAAAASUVORK5CYII=)!important}#toast-container.toast-bottom-center>div,#toast-container.toast-top-center>div{width:300px;margin-left:auto;margin-right:auto}#toast-container.toast-bottom-full-width>div,#toast-container.toast-top-full-width>div{width:96%;margin-left:auto;margin-right:auto}.toast{background-color:var(--primary-color)}.toast-success{background-color:var(--success-color)}.toast-error{background-color:var(--error-color)}.toast-info{background-color:#2f96b4}.toast-warning{background-color:#f89406}.toast-progress{position:absolute;left:0;bottom:0;height:4px;background-color:#000;opacity:.4}@media all and (max-width:240px){#toast-container>div{padding:8px 8px 8px 50px;width:11em}#toast-container>div.rtl{padding:8px 50px 8px 8px}#toast-container .toast-close-button{right:-.2em;top:-.2em}#toast-container .rtl .toast-close-button{left:-.2em;right:.2em}}@media all and (min-width:241px) and (max-width:480px){#toast-container>div{padding:8px 8px 8px 50px;width:18em}#toast-container>div.rtl{padding:8px 50px 8px 8px}#toast-container .toast-close-button{right:-.2em;top:-.2em}#toast-container .rtl .toast-close-button{left:-.2em;right:.2em}}@media all and (min-width:481px) and (max-width:768px){#toast-container>div{padding:15px 15px 15px 50px;width:25em}#toast-container>div.rtl{padding:15px 50px 15px 15px}}#toast-container>.toast{background-image:none!important}.toast-mobile-error{top:50%;right:25px;opacity:1}.dragging *{pointer-events:none}.dragging.dragging-top{padding-top:var(--drop-zone-height)!important}.dragging.dragging-top:before{content:'';position:absolute;top:0!important;left:0;right:0!important;height:var(--drop-zone-height)!important;background:var(--drop-zone-background);border-radius:4px;z-index:1}.dragging.dragging-bottom{padding-bottom:var(--drop-zone-height)}.dragging.dragging-bottom:before{content:'';position:absolute;top:auto!important;bottom:0;left:0;right:0!important;height:var(--drop-zone-placeholder-height)!important;background:var(--drop-zone-background);border-radius:4px;z-index:1}.dragging.dragging-top.dragging-small{padding-top:var(--drop-zone-small-height)!important}.dragging.dragging-bottom.dragging-small{padding-bottom:var(--drop-zone-small-height)}.dragging.dragging-bottom.dragging-small:before,.dragging.dragging-top.dragging-small:before{height:var(--drop-zone-small-placeholder-height)!important}.dragging.dragging-center:before{content:'';position:absolute;top:0!important;left:0;right:0!important;bottom:0;background:var(--drop-zone-background);border-radius:4px;color:transparent}.hover-opacity-full:hover{opacity:1!important}@keyframes loading{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.hover-blue:hover{color:--var(--primary-color)}@keyframes pulse{0%{box-shadow:0 0 0 0 #6814c9}100%{box-shadow:0 0 0 20px transparent}}.bg-primary{background:var(--primary-color);color:#fff}.bg-default{background:var(--default-color)}.bg-alternate{background:var(--alternate-color);color:#fff}.bg-variant{background:var(--warning-color);color:#fff}.bg-primary-10{background:var(--primary-color-light)}.bg-alternate-10{background:var(--alternate-color-light)}.b{border-width:1px;border-style:solid}.bc-primary{border-color:var(--primary-color)}.bc-alternate{border-color:var(--alternate-color)}.bc-default{border-color:var(--default-color)}.bc-black{border-color:#000}.bc-variant{border-color:var(--warning-color)}.color-primary{color:var(--primary-color)}.color-alternate{color:var(--alternate-color)}.color-default{color:var(--default-color)}.color-variant{color:var(--warning-color)}.is-editing-variant .bg-alternate,.is-editing-variant .bg-black:not(#sc-primary-nav),.is-editing-variant .bg-primary{background:var(--warning-color)}.is-editing-variant .bg-alternate-10,.is-editing-variant .bg-black-10,.is-editing-variant .bg-primary-10{background:var(--warning-color-light)}.is-editing-variant .bc-alternate,.is-editing-variant .bc-black,.is-editing-variant .bc-primary{border-color:var(--warning-color)}.is-editing-variant .color-alternate,.is-editing-variant .color-black,.is-editing-variant .color-primary{color:var(--warning-color)}"}})},qd=a.createTheme({breakpoints:{values:{xs:0,sm:768,md:900,lg:1150,xl:1400}}}),Yd=function(){return Wt.default.createElement("div",{style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"}},Wt.default.createElement("div",{style:{border:"2px solid ".concat("#d4d4d4"),borderTop:"2px solid #7f7f7f",borderRadius:"50%",width:"80px",height:"80px",animation:"loading 1s linear infinite"}}))},Jd=function(e){var t=e.isParent,n=e.children,a=e.onDocLoaded,o=Ul("root"),i=r._slicedToArray(o,1)[0],d=Ml(),u="remote"===ya().mode,c=!0===l.useRecoilValue(hl),s=u&&c,f=!i||"write"!==d;return Wt.default.useEffect((function(){var e=Date.now();return function(){a&&(console.log("on doc loaded"),a()),console.log("render-perf:pending-duration",Date.now()-e)}}),[f]),Wt.default.createElement("div",{style:{padding:"8px",height:s?"100%":"calc(100vh - ".concat(t?"160px":"90px",")"),overflow:s?"":"auto",position:s?"relative":void 0}},Wt.default.createElement(rd,{editor:!0}),i&&n({Section:Ed,tree:i,isAdmin:!0}),f&&Wt.default.createElement(Yd,null))},Qd=function(e){var t,n=e.children,o=e.docId,i=e.onSelectDocument,d=e.apiUrl,u=e.alerts,c=e.presetOptions,s=e.role,f=e.linkedChildPageUrl,p=e.showDevTools,m=e.onDocLoaded,v=e.env,g=e.requestUri;jd(o);var h=l.useRecoilState(dl),b=r._slicedToArray(h,2)[1],y=sl(),E=fl(),x=l.useRecoilState(gl),C=r._slicedToArray(x,1)[0],S=El(),I=r._slicedToArray(S,1)[0],k=rl(),_=r._slicedToArray(k,1)[0],A="parent"===s;Wt.default.useEffect((function(){b((function(){return{apiUrl:d,env:v}}))}),[]),Wt.default.useEffect((function(){var e=function(e){if(!e.target.closest(".paste-html")){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}},t=function(e){var t;"main-content"===e.target.getAttribute("id")&&"true"===(null===(t=document.activeElement)||void 0===t?void 0:t.getAttribute("contenteditable"))&&document.activeElement.blur()};return document.addEventListener("paste",e),document.addEventListener("click",t),function(){document.removeEventListener("paste",e),document.removeEventListener("click",t)}}),[]);var T=!0===l.useRecoilValue(hl);if(!y)return null;var w=null===(t=jo[C])||void 0===t?void 0:t.width;return Wt.default.createElement(Ho.Provider,{value:{apiUrl:d,presetOptions:c,isParent:A}},Wt.default.createElement(a.ThemeProvider,{theme:qd},Wt.default.createElement(Ad,null,Wt.default.createElement(_i,null,Wt.default.createElement(Dd,null,Wt.default.createElement(Gd,null,Wt.default.createElement(He.ExperimentsProvider,{requestUri:g,testConfig:_,overrideTestData:I?r._defineProperty({},I,1):{}},Wt.default.createElement(Vd,null),Wt.default.createElement("div",{className:I?"is-editing-variant":"",style:{height:"100%",display:A?"flex":"block"}},A&&Wt.default.createElement(sd,{showDevTools:p,onSelectDocument:i,alerts:u}),y?Wt.default.createElement("div",{style:{flexGrow:1,overflow:T?"visible":"hidden"}},A?Wt.default.createElement(Wd,{docId:y}):Wt.default.createElement(Yl,null),Wt.default.createElement(Jd,{onDocLoaded:m,onSelectDocument:i,isParent:A},n)):Wt.default.createElement("div",null,"This document does not exist"),A&&C!==Do&&Wt.default.createElement(vd,{docId:E||y,width:w,url:f,isReadOnly:!1})))))))))},Xd=a.makeStyles({root:{padding:"8px 0","&:hover":{borderColor:"".concat("#196dfc"," !important"),color:"#196dfc"},"&.checked":{borderColor:"".concat("#196dfc"," !important"),backgroundColor:"#196dfc",color:"#FFF"}}});function Kd(e){return Wt.default.createElement(sn.default,b._extends({disableRipple:!0,color:"default",checkedIcon:Wt.default.createElement("span",null),icon:Wt.default.createElement("span",null)},e))}var Zd={undefined:"No doc selected",loading:"Loading...",pending:"Pending...",write:"Ready"},$d=function(e){var t=e.apiUrl,n=e.docId,a=e.name,l=e.slug,i=e.close,d=e.children,u=xa(),c=ya(),s=c.useDocument,f=c.useDocumentStatus,p=c.useLastCommit,m=s(n,"remote"),v=r._slicedToArray(m,1)[0],g=f(n,"remote"),h=p(n,"remote"),b=o.useState(!1),y=r._slicedToArray(b,2),E=y[0],x=y[1];o.useEffect((function(){fetch("".concat(t,"/published-snapshot/").concat(l)).then((function(e){return e.json()})).then((function(e){x(!(null===e||void 0===e||!e.children))}))}),[n,null===h||void 0===h?void 0:h.timestamp,t]);var C=function(e){var t=e.text,n=e.subtext,r=e.isReset;return{text:"".concat(t," ").concat(a,"? "),secondaryText:n,actions:{close:{text:"Cancel",handler:function(){}},confirm:{text:"Reset",handler:function(){!function(e){var t;u&&u.restClient&&(e?null===u||void 0===u||null===(t=u.restClient)||void 0===t?void 0:t.getPublishedDocument(l):Promise.resolve({snapshot:JSON.parse(JSON.stringify(v))})).then((function(e){null!==e&&void 0!==e&&e.snapshot?u.documentExists(l)?u.replaceDocument(l,e.snapshot):null===u||void 0===u||u.addDocument({name:Ga(l).replace(/-/g," "),template:e.snapshot,slug:l}):alert("No published document found while seeding local environment")}))}(r),i()}}}}},S=o.useContext(Xo).setDialogProps;return d({doc:v,status:g||"loading",lastCommit:h,canResetToPublishedState:E,onClickReset:function(){S(C({text:"Reset",subtext:Wt.default.createElement("div",{style:{margin:"10px 20px"}},Wt.default.createElement("p",null,"This action will reset the document for all users to the version last published at ",Oo(null===h||void 0===h?void 0:h.timestamp)," by"," ",null===h||void 0===h?void 0:h.user,"."),Wt.default.createElement("br",null),Wt.default.createElement("p",null,"Changes in local drafts of this document will be erased.")),isReset:!0}))},onClickSquash:function(){S(C({text:"Squash",subtext:Wt.default.createElement("div",{style:{margin:"10px 20px"}},Wt.default.createElement("p",null,Wt.default.createElement("strong",null,"If your shared draft is severely out of date and is not getting updates, do not select this option.")),Wt.default.createElement("br",null),Wt.default.createElement("p",null,"This action will replace the document with a compressed version of its current shared draft."),Wt.default.createElement("br",null),Wt.default.createElement("p",null,"It is ideal for squashing documents like clipboard that are never published. Changes in local drafts of this document will be erased.")),isReset:!1}))}})},eu=function(e){return e.children({})},tu={pointerEvents:"auto",display:"block",margin:"20px 0",width:350,textTransform:"none"},nu=function(e){return r._objectSpread2(r._objectSpread2({},tu),{},{cursor:e?"pointer":"not-allowed"})},ru=function(e){return e?"bg-primary":"bg-default"},au=function(e){return r._objectSpread2(r._objectSpread2({},tu),{},{cursor:e?"pointer":"not-allowed"})},ou=function(e){return e?"color-primary b bc-primary":"color-default b bc-default"},lu=function(e){var t,n=e.linkedChildPageUrl,a=e.apiUrl,i=l.useRecoilState(ul),d=r._slicedToArray(i,2)[1],u=o.useState(new c.DexieAdapter),s=r._slicedToArray(u,1)[0],f=Sa(),p=l.useRecoilState(gl),m=r._slicedToArray(p,2),v=m[0],g=m[1],h=o.useState({}),b=r._slicedToArray(h,2),y=b[0],E=b[1],x=Xd(),C=y.docId?$d:eu;return Wt.default.createElement("div",{style:{padding:40}},Wt.default.createElement("h1",{style:{marginBottom:20}},"Help"),Wt.default.createElement("p",null,"See Instructions here:"," ",Wt.default.createElement("a",{href:"https://arcpublishing.atlassian.net/wiki/spaces/HOM/pages/2634973372/Assembler2+troubleshooting+tips"})),Wt.default.createElement("br",null),Wt.default.createElement("br",null),Wt.default.createElement("p",null,"Click the button below to clear your DB."),Wt.default.createElement("p",null,"Also double check that there is ",Wt.default.createElement("strong",null,"no")," shared worker active by going to this link: ",Wt.default.createElement("code",null,"chrome://inspect/#workers")),Wt.default.createElement(Gt.default,{style:{background:"#196dfc",color:"#FFF",display:"block",margin:"20px 0",textTransform:"none",width:350},onClick:function(){return s.deleteAll().then((function(){alert("Success. Click ok to be routed back to the Homepage admin."),window.location.href="".concat(window.location.href.includes("/assembler")?"/assembler":"","/admin/document/homepage")}))}},"Clear DB"),Wt.default.createElement("div",{style:{display:"flex"}},Wt.default.createElement("div",{style:{minWidth:600}},Wt.default.createElement("h2",{style:{margin:"20px 0"}},"Select Document"),Wt.default.createElement(fn.default,{name:"document",value:y.docId||null,onChange:function(e){var t,n=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value,r=f.find((function(e){return e.docId===n}));E(r),(null===r||void 0===r?void 0:r.slug)&&d(r.slug)}},0===f.length?null:f.map((function(e){var t=e.docId,n=e.name;return t&&Wt.default.createElement(on.default,{className:"".concat(x.root," b bc-default ").concat(t===y.docId?"checked":""),style:{maxWidth:"400px",margin:"8px 0"},key:t,value:t,control:Wt.default.createElement(Kd,null),label:n})})))),Wt.default.createElement("div",{style:{minWidth:600}},Wt.default.createElement(C,{apiUrl:a,docId:y.docId,name:y.name,slug:y.slug,close:function(){E({}),d("document-list")}},(function(e){var t=e.doc,n=e.canResetToPublishedState,r=e.lastCommit,a=e.status,o=e.onClickReset,l=e.onClickSquash,i=Object.entries(t||{}).length>0&&"write"===a;return Wt.default.createElement("div",null,Wt.default.createElement("h2",{style:{margin:"20px 0"}},"Status: ",Zd[a]),Wt.default.createElement("p",null,null!==r&&void 0!==r&&r.timestamp?"Last published ".concat(Oo(null===r||void 0===r?void 0:r.timestamp)," by ").concat(null===r||void 0===r?void 0:r.user):"write"!==a?"No publish data":"Never published"),Wt.default.createElement(Gt.default,{style:au(n),className:ou(n),disabled:!n,onClick:n?function(){return window.open("".concat(window.location.href.includes("/assembler")?"/assembler":"","/render/").concat(y.slug),"_blank")}:function(){}},"View Last Published Doc"),Wt.default.createElement(Gt.default,{style:au(i),className:ou(i),disabled:!i,onClick:i?function(){return g("".concat(1150))}:function(){}},"View Current Draft"),Wt.default.createElement(Gt.default,{style:au(i),className:ou(i),disabled:!i,onClick:i?function(){return window.open("".concat(window.location.href.includes("/assembler")?"/assembler":"","/admin/document/").concat(y.slug),"_blank")}:function(){}},"Open Draft in Admin"),Wt.default.createElement(Gt.default,{style:nu(n),className:ru(n),disabled:!n,onClick:n?o:function(){}},"Reset to Published State"),Wt.default.createElement(Gt.default,{style:nu(i),className:ru(i),disabled:!i,onClick:i?l:function(){}},"Squash Document from Latest Draft"))})),v!==Do&&Wt.default.createElement(vd,{docId:y.slug,width:null===(t=jo[v])||void 0===t?void 0:t.width,url:n,isReadOnly:!0}))))},iu=["handlers"],du=vn.default((function(){return{root:{"&:hover":{outline:"-webkit-focus-ring-color dashed 1px"},"&:focus":{outline:"-webkit-focus-ring-color solid 1px !important"}}}})),uu=["handlers"],cu=vn.default((function(){return{root:{"&:hover":{outline:"-webkit-focus-ring-color dashed 1px",opacity:"0.9","& $testIcon":{visibility:"visible",cursor:"pointer"}},"&:focus":{outline:"-webkit-focus-ring-color solid 1px !important"}},testIcon:{visibility:"hidden",position:"absolute",right:"5px",top:"5px",zIndex:"1200",height:"50px",paddingLeft:"25px"}}})),su=function(){var e=Sa();return Wt.default.createElement("div",null,JSON.stringify(e))};t.DexieAdapter=c.DexieAdapter,t.LocalMemoryAdapter=c.LocalMemoryAdapter,t.NetworkClient=c.NetworkClient,t.Queue=c.Queue,t.Repo=c.Repo,t.RepoBackend=c.RepoBackend,t.RestClient=c.RestClient,Object.defineProperty(t,"ActionTypes",{enumerable:!0,get:function(){return g.ActionTypes}}),Object.defineProperty(t,"Callbacks",{enumerable:!0,get:function(){return g.Callbacks}}),Object.defineProperty(t,"Events",{enumerable:!0,get:function(){return g.Events}}),t.UpdateTypes=g.UpdateTypes,t.ChainContext=b.ChainContext,t.ComponentMapContext=b.ComponentMapContext,t.ComponentProvider=b.ComponentProvider,t.Consumer=b.Consumer,t.ContentRoot=b.ContentRoot,t.FeatureContext=b.FeatureContext,t.RedirectError=b.RedirectError,t.UpstreamError=b.UpstreamError,t.createContentCache=b.createContentCache,t.fetchContent=b._fetchContent,t.getDataFromTree=b.getDataFromTree,t.useAllComponentFields=b.useAllComponentFields,t.useAppContext=b.useAppContext,t.useCache=b.useCache,t.useComponent=b.useComponent,t.useComponentChildFeatures=b.useComponentChildFeatures,t.useComponentContext=b.useComponentContext,t.useComponentFields=b.useComponentFields,t.useComponentIcon=b.useComponentIcon,t.useComponentMap=b.useComponentMap,t.useComponentName=b.useComponentName,t.useComponentToolbarHelper=b.useComponentToolbarHelper,t.useContent=b.useContent,t.useContentWithEdits=b.useContentWithEdits,t.useEditableContent=b.useEditableContent,t.useFusionContext=b.useFusionContext,t.useSpartanChain=b.useSpartanChain,t.useSpartanFeature=b.useSpartanFeature,t.AppContext=Ho,t.AsmblrIcon=Ql,t.AssemblerRoot=function(e){var t=e.onSelectDocument,n=e.docId,a=e.components,o=e.alerts,l=e.FeatureWrapper,i=void 0===l?Cd:l,d=e.contentCache,u=e.documentRepo,c=e.additionalContext,s=void 0===c?{}:c,f=e.apiUrl,p=e.requestUri,m=e.presetOptions,v=e.linkedChildPageUrl,g=e.role,h=e.showDevTools,y=void 0!==h&&h,E=e.env,x=e.onDocLoaded,C=Wt.default.useState(null),S=r._slicedToArray(C,2),I=S[0],k=S[1],_=Wt.default.useState(n),A=r._slicedToArray(_,2),T=A[0],w=A[1];Wt.default.useEffect((function(){"child"===g&&window.parent&&window.parent.setChildRepo&&window.parent.setChildRepo(k,w)}),[]);var D="parent"===g?u:I;return D&&T?Wt.default.createElement(b.ContentRoot,{cache:d,additionalContext:s},Wt.default.createElement(b.ComponentMapContext.Provider,{value:r._objectSpread2(r._objectSpread2({},a),{},{wrapper:{Component:i,fields:null}})},Wt.default.createElement(ka,{repo:D},Wt.default.createElement(Qd,{onDocLoaded:x,env:E,showDevTools:y,apiUrl:f,requestUri:p,docId:T,onSelectDocument:t,presetOptions:m,alerts:o,role:g,linkedChildPageUrl:v},(function(e){var t=e.tree,n=e.isAdmin;return Wt.default.createElement(Sd,{tree:t,isAdmin:n})}))))):null},t.ConfirmationDialogContext=Xo,t.Dashboard=function(e){var t=e.repo;return Wt.default.createElement(ka,{repo:t},Wt.default.createElement(su,null))},t.DocumentContext=Go,t.DocumentHandle=wa,t.DocumentManager=Da,t.DocumentRepo=_a,t.DocumentRoot=ka,t.DraggableContext=Wo,t.EditableArt=function(e){var t,n=e.menuItems,a=e.children,l=b.useSpartanFeature(),i=b.useSpartanChain();t=l.change||i.change;var d=Wt.default.useState(),u=r._slicedToArray(d,2),c=u[0],s=u[1],f=o.useCallback((function(e){return function(n){var r;n.preventDefault(),n.stopPropagation(),e({setEntity:t,value:null===n||void 0===n||null===(r=n.target)||void 0===r?void 0:r.value})}}),[]),m=null===n||void 0===n?void 0:n.map((function(e){var t=e.handlers,n=p._objectWithoutProperties(e,uu);return r._objectSpread2(r._objectSpread2({},n),{},{handlers:t&&Object.keys(t).reduce((function(e,n){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},n,f(t[n])))}),{})})})),v=cu().root,g=cu().testIcon;return Wt.default.createElement("div",{onClick:function(e){var t;e.preventDefault(),e.stopPropagation();var n=(null===(t=e.target)||void 0===t?void 0:t.parentElement)||e.target;s(n)},className:"".concat(v),style:{position:"relative"}},Wt.default.createElement("div",{className:"".concat(g),onClick:function(e){var t,n=(null===(t=e.target)||void 0===t?void 0:t.parentElement)||e.target;s(n)}},Wt.default.createElement(Ql,{icon:"settings",styles:{color:"#196dfc",stroke:"white",strokeWidth:"1"}})),a,c&&Wt.default.createElement(wd,{anchorEl:c,items:m,handleClose:function(e){"BODY"!==e.target.tagName&&"LI"!==e.target.tagName&&s(void 0)},imageConfig:!0}))},t.EditableProperty=function(e){var t,n,a=e.path,l=e.value,i=e.className,d=e.tag,u=e.menuItems,c=e.style,s=e.getIsEditable,f=b.useSpartanFeature(),m=b.useSpartanChain(),v=b.useFusionContext().isAdmin;n=f.props||m.props;var g=!s||s(n),h=o.useState(void 0),y=r._slicedToArray(h,2),E=y[0],x=y[1],C=$t.default(null===(t=n)||void 0===t?void 0:t.customFields,a)||l,S=o.useRef(),I=o.useRef();o.useEffect((function(){S.current=C}),[C]),o.useEffect((function(){I.current=f.change||m.change}),[f.change||m.change]);var k=o.useCallback((function(e){return function(t){var n;t.preventDefault(),t.stopPropagation(),e({setEntity:I.current,value:null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.value})}}),[]),_=null===u||void 0===u?void 0:u.map((function(e){var t=e.handlers,n=p._objectWithoutProperties(e,iu);return r._objectSpread2(r._objectSpread2({},n),{},{handlers:Object.keys(t).reduce((function(e,n){return r._objectSpread2(r._objectSpread2({},e),{},r._defineProperty({},n,k(t[n])))}),{})})})),A=du().root;return v&&g?Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(hn.default,{onClick:function(e){var t;e.preventDefault();var n=(null===(t=e.target)||void 0===t?void 0:t.parentElement)||e.target;x(n)},html:S.current||C,className:"".concat(i," ").concat(A),tagName:d,onBlur:function(){var e=z.decode(S.current).trim();S.current=e,function(e){e!==C&&I.current((function(t){a&&(t.props.customFields||(t.props.customFields={}),t.props.customFields[a]=e)}))}(e)},onChange:function(e){var t=e.target.value;S.current=t},style:r._objectSpread2(r._objectSpread2({},c||{}),{},{cursor:"text",position:"relative"})}),E&&Wt.default.createElement(wd,{anchorEl:E,items:_,handleClose:function(e){"BODY"!==e.target.tagName&&"LI"!==e.target.tagName&&x(void 0)}})):Wt.default.createElement(d||"span",{className:i,dangerouslySetInnerHTML:{__html:S.current},style:c})},t.FloatingMenuContext=Zo,t.HelpRoot=function(e){var t=e.documentRepo,n=e.linkedChildPageUrl,r=e.apiUrl;return t?Wt.default.createElement(ka,{repo:t},Wt.default.createElement(Vd,null),Wt.default.createElement(_i,null,Wt.default.createElement(lu,{linkedChildPageUrl:n,apiUrl:r}))):null},t.MenuContext=Qo,t.activeExperimentEditingId=yl,t.collapsedItems=xl,t.constants=dl,t.currentDocId=ul,t.debounce=ga,t.defaultDraggableContext=Uo,t.editorState=cl,t.iframeMode=gl,t.isAnimated=bl,t.isBalancingRowspans=vl,t.isLocked=hl,t.objectToId=function(e){return e.id},t.selectObject=function(e){return function(t){return r._objectSpread2(r._objectSpread2({},t),{},{data:e,drawerOpen:!0})}},t.showHelpers=ml,t.toggleDrawer=Cl,t.useActiveExperimentEditingId=El,t.useAddToClipBoard=qo,t.useChainChildProps=jl,t.useChangeLogForActiveDocument=Nl,t.useClipboard=Vo,t.useClipboardAndChildren=Yo,t.useClipboardDocId=Ia,t.useCloneNodeAndChildren=Wl,t.useConfirmationDialogContext=Ko,t.useCurrentActiveDocument=Ul,t.useCurrentDocId=sl,t.useCurrentDocName=pl,t.useCurrentSlug=fl,t.useDocSizeForActiveDocument=Ol,t.useDocsContext=ya,t.useDocumentList=Sa,t.useDragTarget=function(){return l.useRecoilState(Al)},t.useEditMode=Hl,t.useEditorState=Gl,t.useEditorValue=function(){return l.useRecoilValue(cl)},t.useEntityInDocument=wl,t.useEntityInteractiveState=Il,t.useForceRefresh=function(){var e=l.useSetRecoilState(il);return function(){return e((function(e){return e+1}))}},t.useHasChangesForActiveDocument=Ll,t.useHoveredEntity=function(){return l.useRecoilState(Tl)},t.useLastCommitForActiveDocument=zl,t.usePublishCurrentDocument=Pl,t.usePushCurrentActiveDocument=Fl,t.useRepo=xa,t.useResetForActiveDocument=Bl,t.useSelectedEntity=_l,t.useSetClipboard=Jo,t.useSetCurrentActiveDocument=Rl,t.useSetEditor=Vl,t.useStatusForActiveDocument=Ml,t.useVariant=Dl}}]);
//# sourceMappingURL=b6d982c0.34ab6f53a05bf71ab5d9.js.map